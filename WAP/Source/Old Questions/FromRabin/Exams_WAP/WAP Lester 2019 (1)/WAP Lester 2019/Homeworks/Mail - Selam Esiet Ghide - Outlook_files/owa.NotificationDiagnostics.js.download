self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.NotificationDiagnostics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[372],{1881:function(t,n,e){"use strict";var i=e(52),r=e(0),a=e(4),o=function(t,n,e){var i=null;return{init:function(o){var c;if(null!==i)throw new Error("Diagnostics store "+t+" was initialized multiple times");return i=Object(a.createStore)(t,n),e(i()),Object(r.__assign)(Object(r.__assign)({},o),((c={})[t]=i,c))},getIfInitialized:function(){return i?i():null}}};e.d(n,"b",function(){return s}),e.d(n,"f",function(){return u}),e.d(n,"e",function(){return d}),e.d(n,"g",function(){return f}),e.d(n,"a",function(){return l}),e.d(n,"c",function(){return b}),e.d(n,"d",function(){return o});var c=new i.c(function(){return Promise.all([e.e(0),e.e(1),e.e(2),e.e(5),e.e(211)]).then(e.bind(null,14094))}),s=Object(i.d)(c,function(t){return t.DiagnosticsPanel}),u=new i.a(c,function(t){return t.registerDiagnostics}),d=(new i.b(c,function(t){return t.setSelectedPivot}),new i.b(c,function(t){return t.getDiagnosticsLogState})),f=new i.b(c,function(t){return t.initializeDefaultDiagnostics}),l=Object(i.d)(c,function(t){return t.DiagnosticsHost}),b=(Object(i.d)(c,function(t){return t.DiagnosticsInspector}),Object(i.d)(c,function(t){return t.TwoColumnInspector}))},9297:function(t,n,e){"use strict";e.r(n);var i=e(0),r=e(909),a=e(65);function o(){return new Date(Date.now()).toLocaleTimeString()}function c(t,n,e){t.push(n),t.length>e&&t.splice(0,1)}var s,u=e(69),d=Object(u.action)("addChannelDatapoint")(function(t,n){c(n.datapoints,{message:t,timestamp:o()},1e3)}),f=e(1881),l="Channel",b=!1;function p(t){!function(){Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,e;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return b?[3,3]:(b=!0,s={name:l,datapoints:[]},[4,f.e.import()]);case 1:return t=i.sent(),[4,f.f.import()];case 2:n=i.sent(),e=t(),n(s,e),s=e.loggers.get(l),i.label=3;case 3:return[2]}})})}(),d(t,s)}var v=e(732);function g(t){var n="";if(t){var e=v.p.folderTable.get(t);e&&(n=e.DisplayName)}return n}function m(t){var n="";return t.Conversation?n=t.Conversation.ConversationTopic:t.Item&&(n=t.Item.Subject),n}var w,h=Object(u.action)("addNotificationDatapoint")(function(t,n){var e=t,i=t;c(n.datapoints,{id:t.id,type:t.EventType,folder:g(e.FolderId||i.folderId),subject:m(e),timestamp:o()},1e3)}),j="Notifications",O=!1;function D(t){!function(){Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,e;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return O?[3,3]:(O=!0,w={name:j,datapoints:[]},[4,f.e.import()]);case 1:return t=i.sent(),[4,f.f.import()];case 2:n=i.sent(),e=t(),n(w,e),w=e.loggers.get(j),i.label=3;case 3:return[2]}})})}(),h(t,w)}var _,S=Object(u.action)("addSubscriptionDatapoint")(function(t,n){var e;n.datapoints.push({id:t.subscriptionId,type:(null===(e=t.subscriptionParameters)||void 0===e?void 0:e.NotificationType)?t.subscriptionParameters.NotificationType:"",folder:t.subscriptionParameters?g(t.subscriptionParameters.FolderId):"",status:"Uninitialized",handlers:1,retries:0,error:""})}),I=Object(u.action)("removeSubscriptionDatapoint")(function(t,n){for(var e=n.datapoints,i=0;i<e.length;i++)if(e[i].id===t){e.splice(i,1);break}}),T=Object(u.action)("setSubscriptionDatapointStatus")(function(t,n,e,i,r,a){for(var o=a.datapoints,c=0;c<o.length;c++)if(o[c].id===t)switch(o[c].handlers=e,o[c].retries=i,r&&(o[c].error=r),n){case 0:o[c].status="Uninitialized";break;case 3:o[c].status="Connected";break;case 2:o[c].status="Pending";break;case 1:o[c].status="Disconnected"}}),C="Subscriptions",P=!1;function N(){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,e;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return P?[3,3]:(P=!0,_={name:C,datapoints:[]},[4,f.e.import()]);case 1:return t=i.sent(),[4,f.f.import()];case 2:n=i.sent(),e=t(),n(_,e),_=e.loggers.get(C),i.label=3;case 3:return[2]}})})}function y(t){N(),S(t,_)}function z(t,n,e){N(),T(t.subscriptionId,n.status,n.refs.length,n.retries,e,_)}function k(t){N(),I(t.subscriptionId,_)}var E=e(62);function U(t){E.d.warn(t)}function F(t){E.d.error(t)}function L(){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(i.__generator)(this,function(e){switch(e.label){case 0:return Object(a.f)("fwk-devTools")?[4,r.d.import()]:[3,2];case 1:t=e.sent(),(n=t()).on(r.a.ChannelData,p),n.on(r.a.NotificationData,D),n.on(r.a.SubscriptionAdded,y),n.on(r.a.SubscriptionRemoved,k),n.on(r.a.SubscriptionUpdated,z),n.on(r.a.TraceWarn,U),n.on(r.a.TraceError,F),e.label=2;case 2:return[2]}})})}e.d(n,"initializeNotificationDiagnostics",function(){return L})}},0,[0,1,2,578,189,5,211,609,370]]);
//# sourceMappingURL=owa.NotificationDiagnostics.js.map
self.scriptsLoaded['owa.NotificationDiagnostics.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.NotificationDiagnostics.js'] = (new Date()).getTime();