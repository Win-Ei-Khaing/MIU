self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailSmartPill.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[357],{1048:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(2392),a="fileType-icon";function i(e){return n[function(e){return a+"-"+e}(e)]}},1136:function(e,t,r){"use strict";var n=r(65),a=r(71),i=r(797);function o(){return(!Object(i.u)()||!window.opener)&&(Object(n.f)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}var c=r(4),u=Object(c.action)("openTimePanel",function(e){return{source:e}}),l=Object(c.action)("popView");r.d(t,"a",function(){return o}),r.d(t,"b",function(){return u}),r.d(t,"c",function(){return l})},1166:function(e,t,r){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},1246:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n,a=r(951),i=r(1256);function o(e,t,r,o,c){if(r)return n=n||{extraSmall:Object(a.b)("generic").extraSmall,small:Object(a.b)("generic").small,medium:Object(a.b)("blockedfile").medium,large:Object(a.b)("generic").large,cdn:Object(i.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":case"IPM.Schedule.Meeting.Request":case"IPM.Schedule.Meeting.Canceled":return Object(a.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(a.b)("calendar")}return o?Object(a.b)("sharedfolder"):Object(a.a)(e,!1,t)||Object(a.b)("generic")}},1256:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=1;function a(e){return"https://r"+(n++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},1292:function(e,t,r){"use strict";var n=r(4),a=r(21),i=r(1603),o={providers:new a.ObservableMap,loadState:i.a.NotLoaded,removalPending:new a.ObservableMap},c=Object(n.createStore)("fileProviderStoreV2",o);t.a=c},12987:function(e){e.exports={a:"uvc",b:"vvc"}},12988:function(e){e.exports={a:"svc",b:"tvc"}},12989:function(e,t,r){(t=e.exports=r(43)(!1)).push([e.i,'._3Jtu3QV20_qLz8g_h0KpQb{position:relative;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:inherit;width:100%;height:48px;line-height:32px;display:block;cursor:pointer;outline:transparent}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb{background-color:transparent;padding-top:0;padding-bottom:0;border-width:initial;border-style:none;border-color:initial;-o-border-image:initial;border-image:initial}html[dir=ltr] ._3Jtu3QV20_qLz8g_h0KpQb{padding-right:12px;padding-left:12px;text-align:left}html[dir=rtl] ._3Jtu3QV20_qLz8g_h0KpQb{padding-left:12px;padding-right:12px;text-align:right}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb:active{background-color:"[theme:neutralLight, default:#eaeaea]"}._1v60Zw1heoE7AYHV2rZARo{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}.Nf0DroQfbZfcaaSjQ53MC{display:inline-block;color:"[theme:themePrimary, default:#0078D4]";height:32px;width:32px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}html[dir=ltr] .Nf0DroQfbZfcaaSjQ53MC{margin-right:8px}html[dir=rtl] .Nf0DroQfbZfcaaSjQ53MC{margin-left:8px}._1V-pZ1TukzFi3FL2_U4Y5X{max-width:216px;width:100%;height:100%}._3TAbxFid2sTMSQ8v8sIeQH{font-size:14px;color:"[theme:neutralPrimary, default:#333333]";line-height:19px;max-width:100%}._3TAbxFid2sTMSQ8v8sIeQH,._1XRoVhbyaxndQhy7cIo11E{font-weight:400;display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}._1XRoVhbyaxndQhy7cIo11E{font-size:11px;color:"[theme:neutralSecondary, default:#666666]";line-height:15px;width:216px}html[dir] ._1XRoVhbyaxndQhy7cIo11E{padding-top:1px}._2PBoIqeXeRKbQpPjYUXOH_{width:280px}._3EISB-6HOl0a6XteBa9K8u{font-size:12px;font-weight:400;font-weight:600;color:"[theme:themePrimary, default:#0078D4]";max-width:280px}html[dir=ltr] ._3EISB-6HOl0a6XteBa9K8u{margin-left:1px}html[dir=rtl] ._3EISB-6HOl0a6XteBa9K8u{margin-right:1px}._1LIdXVeATDTlAL3Wafn6_V{position:absolute;top:20px}html[dir=ltr] ._1LIdXVeATDTlAL3Wafn6_V{left:24px}html[dir=rtl] ._1LIdXVeATDTlAL3Wafn6_V{right:24px}html[dir] ._16x5oaOekVnuCtNTMKxz1I{margin:0}',""]),t.locals={attachmentSuggestionButton:"_3Jtu3QV20_qLz8g_h0KpQb",attachmentSuggestionButtonContent:"_1v60Zw1heoE7AYHV2rZARo",attachmentSuggestionButtonImageContainer:"Nf0DroQfbZfcaaSjQ53MC",attachmentSuggestionButtonTextContainer:"_1V-pZ1TukzFi3FL2_U4Y5X",attachmentSuggestionPrimaryText:"_3TAbxFid2sTMSQ8v8sIeQH",attachmentSuggestionSecondaryText:"_1XRoVhbyaxndQhy7cIo11E",attachmentSuggestionButtonRoot:"_2PBoIqeXeRKbQpPjYUXOH_",replyWithHeaderForBottomBar:"_3EISB-6HOl0a6XteBa9K8u",fileIcon:"_1LIdXVeATDTlAL3Wafn6_V",cloudyIcon:"_16x5oaOekVnuCtNTMKxz1I"}},12990:function(e){e.exports={a:"Cvc"}},12991:function(e){e.exports={l:"gvc",f:"hvc",a:"ivc",b:"jvc",c:"kvc",d:"lvc",e:"mvc",g:"nvc",h:"ovc",i:"pvc",j:"qvc",k:"rvc"}},12992:function(e,t,r){var n=r(12993),a=r(44);"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)a.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},12993:function(e,t,r){(t=e.exports=r(43)(!1)).push([e.i,"html[dir] ._1BIi6rH1j5rnLh1OlF1NvI{padding-top:10px}html[dir=ltr] ._1BIi6rH1j5rnLh1OlF1NvI{margin-left:52px}html[dir=rtl] ._1BIi6rH1j5rnLh1OlF1NvI{margin-right:52px}",""]),t.locals={bar:"_1BIi6rH1j5rnLh1OlF1NvI"}},1327:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return a}),r.d(t,"c",function(){return o});var n=r(4),a=Object(n.action)("FILE_PROVIDER_ADDED",function(e){return{providerViewState:e}}),i=Object(n.action)("FILE_PROVIDER_REMOVED",function(e){return{providerType:e}}),o=Object(n.action)("PROVIDERS_LOADED",function(e){return{providers:e}})},1388:function(e,t,r){"use strict";var n=r(0),a=r(2650),i=r.n(a),o=r(1995),c=r.n(o);function u(e){var t=c()({ProviderType:e});return i()(t)}var l=r(2651),s=r.n(l),d=r(1996),m=r.n(d);function f(e){var t=m()({ProviderType:e});return s()(t)}var p=r(2520),g=r(65);r.d(t,"a",function(){return P}),r.d(t,"b",function(){return T});var v="code",b="token",h=3e3,S=3;function y(e){return{state:e}}function O(e){return e.state}function x(e){return e.code}function P(e,t,r,a,i){var o={providerType:e,getAuthUrlInfo:null,getCSRFToken:O,getOAuthCode:x};return function e(t,r,a,i,o,c,l){return Object(n.__awaiter)(this,void 0,void 0,function(){var s,d;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),s=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,f(t)];case 1:return d=n.sent(),s=d.AttachmentDataProviderCreator.ProviderAppKey,a=d.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,u(t)];case 3:d=n.sent(),s=d.ProviderAppKey,n.label=4;case 4:return r.getAuthUrlInfo=Object(p.d)(t,a,i,s,o,c),[3,6];case 5:return n.sent(),l>0&&setTimeout(function(){return e(t,r,a,i,o,c,--l)},h),[3,6];case 6:return[2]}})})}(e,o,t,r,a,i,S),o}var j=null;function I(){if(!j){(j={})[3]=P(3,"https://app.box.com/api/oauth2/authorize",Object(p.c)(3),v,y),j[2]=P(2,"https://www.dropbox.com/oauth2/authorize",Object(p.b)(2),v,y);var e=P(6,"https://www.facebook.com/dialog/oauth",Object(p.b)(6),b,function(e){return{state:e,scope:"user_photos,email"}});e.getCSRFToken=O,e.getOAuthCode=function(e){return e.access_token},j[6]=e;var t=P(5,"https://accounts.google.com/o/oauth2/auth",p.a+"/ADPRedirect.aspx",v,function(e){var t={state:e,provider:5..toString(),url:Object(p.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=function(e){return JSON.parse(e.state).state},j[5]=t,j[1]=P(1,"https://login.live.com/oauth20_authorize.srf",Object(p.c)(1),v,function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}),Object(g.f)("doc-fileProvider-wopiClient")&&(j[7]=P(7,"",Object(p.c)(7),v,y),j[8]=P(8,"",Object(p.c)(8),v,y),j[9]=P(9,"",Object(p.c)(9),v,y))}return j}function T(e){var t=I();return e in t?t[e]:null}},14042:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(4),i=Object(a.action)("setSmartPillBlockVisibility",function(e,t){return{viewState:e,smartPillBlockVisible:t}}),o=Object(a.action)("setSmartPillFeedbackSubmitted",function(e,t){return{item:e,smartPillFeedbackSubmitted:t}}),c=r(65),u=r(62),l=r(1136);function s(e){var t=e.featureName;if("SmartReply"===t)return Object(c.f)("mc-smartReply");if("SmartTime"===t)return Object(c.f)("mc-smartReplyWithCustomMeeting");if("SmartDoc"===t)return Object(c.f)("mc-smartReplyWithDoc");if("SmartTodo"===t||"SmartReminder"===t){var r=Object(l.a)();return r||u.d.info("[isPillTypeEnabled] Disable Smart Todo - Time Panel is unavailable."),Object(c.f)("mc-smartTask")&&r}return u.d.info("[isPillTypeEnabled] Unknown pill type: "+t),!1}function d(e){if(e){if("SmartDoc"===e.featureName)return!0;null==e.confidenceScore&&u.d.info("[isConfidenceScoreAcceptable] confidence score is null. Feature: "+e.featureName+" EntityId: "+e.logData.mainPayload.EID);var t=e.confidenceScore;if(t>0){if(Object(c.f)("mc-smartPillConfidenceLevel_LOW"))return!0;if(Object(c.f)("mc-smartPillConfidenceLevel_MID"))switch(e.featureName){case"SmartTime":case"SmartTask":return t>=70;default:return!0}else switch(e.featureName){case"SmartTime":case"SmartTask":return t>=90;default:return!0}}}return!1}var m=1,f=2,p=3;function g(){var e=Object(c.f)("mc-smartReplyWithTextPositionThird");return[{aggregation:{SmartReply:2,SmartTime:1},arrangement:e?["SmartTime","SmartReply"]:["SmartReply","SmartTime"]},{aggregation:{SmartTime:1},arrangement:["SmartTime"]},{aggregation:{SmartReply:2,SmartDoc:1},arrangement:e?["SmartDoc","SmartReply"]:["SmartReply","SmartDoc"]},{aggregation:{SmartDoc:1},arrangement:["SmartDoc"]},{aggregation:{SmartReply:1,SmartTodo:1,SmartReminder:1},arrangement:e?["SmartTodo","SmartReminder","SmartReply"]:["SmartReply","SmartTodo","SmartReminder"]},{aggregation:{SmartTodo:1,SmartReminder:1},arrangement:["SmartTodo","SmartReminder"]},{aggregation:{SmartReply:2,SmartTodo:1},arrangement:e?["SmartTodo","SmartReply"]:["SmartReply","SmartTodo"]},{aggregation:{SmartTodo:1},arrangement:["SmartTodo"]},{aggregation:{SmartReply:3},arrangement:["SmartReply"]}]}function v(e){if(e)for(var t=function(e){var t,r,a={};try{for(var i=Object(n.__values)(e),o=i.next();!o.done;o=i.next()){var c=o.value;a[c.featureName]=void 0===a[c.featureName]?1:a[c.featureName]+1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return a}(e),r=g(),a=0;a<r.length;a++){for(var i=!0,o=r[a],c=0;c<o.arrangement.length;c++){if(o.aggregation[o.arrangement[c]]>(void 0===t[o.arrangement[c]]?0:t[o.arrangement[c]])){i=!1;break}}if(i)return o}return null}var b={selectPills:function(e){return function(e,t){var r=[];return t&&e.length>0&&t.arrangement.forEach(function(a){r.push.apply(r,Object(n.__spread)(function(e,t,r){return e.filter(function(e){return e.featureName===t}).slice(0,r)}(e,a,t.aggregation[a])))}),r}(e,v(e))}};function h(e,t,r,n){var a=[];return e.forEach(function(e){r(e)?a.push(e):(e.logData.mainPayload.renderStory|=n,t.push(e))}),a}var S={arbitratePills:function(e){var t=[],r=[];if(e){var a=h(e,r,s,1),i=h(a,r,d,4);if(i.length>0){if(Object(c.f)("mc-smartPillsRenderingStrategiesV2")){var o=b;t.push.apply(t,Object(n.__spread)(o.selectPills(i)))}else{var u=function(e){if(e){var t=e.some(function(e){return"SmartTime"===e.featureName}),r=e.some(function(e){return"SmartReply"===e.featureName}),n=e.some(function(e){return"SmartDoc"===e.featureName}),a=e.some(function(e){return"SmartTodo"===e.featureName}),i=e.some(function(e){return"SmartReminder"===e.featureName});if(t)return r?{smartReply:{numOfPills:f},smartTime:{numOfPills:m}}:{smartTime:{numOfPills:m}};if(n)return r?{smartReply:{numOfPills:f},smartDoc:{numOfPills:m}}:{smartDoc:{numOfPills:m}};if(a&&i)return r?{smartTodo:{numOfPills:m},smartReminder:{numOfPills:m},smartReply:{numOfPills:m}}:{smartTodo:{numOfPills:m},smartReminder:{numOfPills:m}};if(a)return r?{smartTodo:{numOfPills:m},smartReply:{numOfPills:f}}:{smartTodo:{numOfPills:m}};if(r)return{smartReply:{numOfPills:p}}}return null}(i);if(u)new Map([["SmartReply",u.smartReply],["SmartDoc",u.smartDoc],["SmartTime",u.smartTime],["SmartTodo",u.smartTodo],["SmartReminder",u.smartReminder]]).forEach(function(e,r){var a,o;e&&t.push.apply(t,Object(n.__spread)((a=r,o=e,i.filter(function(e){return e.featureName===a}).slice(0,o.numOfPills))))})}for(var l=function(e){var n=i[e];t.some(function(e){return e===n})||(n.logData.mainPayload.renderStory|=2,r.push(n))},g=0;g<i.length;g++)l(g)}}return{pillsToShow:t,pillsToHide:r,arbitratorId:"complexArbitrator"}}};var y="EntityExtraction/SendContentRequestV21.0",O=3;var x=r(12987),P=Object(a.action)("createMessageWithAttachmentAction",function(e,t){return{item:e,attachment:t}}),j=r(189),I=r(7),T=r(1414),_=r(5),w=r(3164),D=r(1),R=r(12988),E="...",k=30,A=r(8932);function N(e){var t,r,n,a=e.item,i=e.suggestion,o=e.smartPillLogData,c=e.onAttachmentClicked,l=e.dismissMenu,s=D.useCallback(function(){o.mainPayload.timeClicked=(new Date).toISOString(),Object(w.c)(o),Object(w.d)(o.mainPayload.EID,o.mainPayload.position,o.mainPayload.loggableText,"SmartDoc",o.mainPayload.language,o.mainPayload.locale,o.cosmosOnlyData),c(a,i),l()},[a,i,l]);try{t=function(e){var t=Object(I.Pb)("UTC",e.DateModified),r=Object(_.b)(Object(_.a)(R.b),Object(I.Y)(t));return[e.FileName,C(e),r].join("\n")}(i),r=C(i),n=function(e){if(e.length<=k)return e;var t=k-E.length,r=Math.ceil(t/2),n=Math.floor(t/2),a=e.substr(0,r),i=e.substr(e.length-n);return""+a+E+i}(function(e){var t="."+e.FileExtension;return e.FileName.indexOf(t)>=0?e.FileName.replace(t,""):e.FileName}(i)+F(i))}catch(e){throw u.d.warn("[AttachmentSuggestionButton_render] Error: "+e.message),e.knownError=!0,e}return D.createElement("button",{className:A.attachmentSuggestionButton,title:t,name:i.FileName,"aria-label":Object(_.b)(Object(_.a)(R.a),i.FileName),"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:s,tabIndex:0},D.createElement("div",{className:A.attachmentSuggestionButtonContent},D.createElement("div",{className:A.attachmentSuggestionButtonImageContainer,role:"presentation","aria-hidden":"true"},function(e){var t=e.FileName+F(e);return D.createElement(T.a,{fileName:t,contentType:null,isBlocked:!1,isFolder:!1,embeddedItemClass:null,cloudyIconStyle:A.cloudyIcon,fileIconStyle:A.fileIcon})}(i)),D.createElement("div",null,D.createElement("div",{className:A.attachmentSuggestionButtonTextContainer},D.createElement("div",{className:A.attachmentSuggestionPrimaryText},n)),D.createElement("div",{className:A.attachmentSuggestionSecondaryText},r))))}function C(e){var t=null,r=document.createElement("a");r.href=e.Url,t=decodeURIComponent(r.hostname);for(var n=Object(j.a)(),a=decodeURIComponent(r.pathname).split("/"),i=1;i<a.length-1;i++)n?t=a[i]+" < "+t:t+=" > "+a[i];return t}function F(e){return"."+e.FileExtension}var L=Object(a.action)("cacheSmartDocDataAction",function(e,t,r){return{item:e,validPropertyExists:t,entityId:r}}),M="@EntityId";function B(e,t){var r=!1;if(e){if(t)try{r=function(e,t){var r=!1,n=t[M];if(!n){u.d.info("[extractAndCacheSmartDocDataFromProperty] Cannot parse entity ID. Aborting...");var a=new Error("NoEntityIdOnProperty");throw a}L(e,r=!0,n);return r}(e,JSON.parse(t.Value)[0])}catch(e){throw u.d.warn("[parseSmartDocProperty] Malformed property, cannot parse. Error: "+e.message),e.knownError=!0,e}else u.d.info("[parseSmartDocProperty] No property found.");r||L(e,r)}else u.d.info("[parseSmartDocProperty] No item.")}function V(e){return e.Source.LastModifiedBy?e.Source.LastModifiedBy.DisplayName:e.Source.LastShared.SharedBy.DisplayName}var z=r(1052),U=r(467),Q="application/json;charset=utf-8",H="/search/api/v1/recommendations",q="suggestedattachments";function G(e){return Object(n.__awaiter)(this,void 0,void 0,function(){var t,r,a,i,o,c,l,s;return Object(n.__generator)(this,function(n){switch(n.label){case 0:t=null,r="",n.label=1;case 1:return n.trys.push([1,7,8,9]),[4,J()];case 2:return a=n.sent(),i=function(e,t){var r={};r.headers=new Headers,r.headers.set("Authorization","Bearer "+e),r.headers.set("Content-Type",Q),r.method="POST";var n=Object(z.c)();n&&r.headers.append("X-AnchorMailbox",n);r.headers.set("X-Client-LocalTime",(new Date).toISOString());var a=[];t&&a.push(q);a.length&&r.headers.set("X-Client-Flights",a.join(","));var i={EntityRequests:[t?{Context:{EntityId:t}}:{}],Scenario:{Name:"AttachFile"}};return r.body=JSON.stringify(i),r}(a,e),[4,fetch(H,i)];case 3:return(o=n.sent())&&200==o.status?[4,o.text()]:[3,5];case 4:return c=n.sent(),l=JSON.parse(c),t=function(e,t){try{var r=e.EntitySets[0].ResultSets[0].Results;return r.map(function(e){return function(e,t){var r;try{var n=!!e.Source.LastShared&&!e.Source.WebUrl,a=e.Source.Author?e.Source.Author.DisplayName:"";return{Author:a,CreatedBy:a,DateAccessed:e.Source.LastAccessDateTime||(null===(r=e.Source.UserRelationship)||void 0===r?void 0:r.LastAccessDateTime),DateCreated:null,DateModified:e.Source.LastModifiedDateTime,Endpoint:t?3:n?2:1,FileExtension:e.Source.FileExtension,FileName:e.Source.FileName,FileSize:e.Source.FileSize,FileSourceType:e.ContentSource||e.Provenance,Id:n?e.Source.LastShared.AttachmentId:e.Id,ModifiedBy:V(e),ReferenceId:e.ReferenceId,SourceTitle:e.Source.SiteTitle||e.Source.LastShared.SharingSubject,Text:e.Source.Title,Title:e.Source.Title,Url:e.Source.Url}}catch(e){return u.d.info("[convertMRUAttachmentToReplyWithAttachmentSuggestion] Error accessing MRUAttachment properties: "+e.message),null}}(e,t)})}catch(e){return u.d.info("[fetchMRUSuggestions_getAttachmentsFromResponse] Error: "+e.message),[]}}(l,!!e),[3,6];case 5:r=o?o.status+"-"+o.statusText:"No response",n.label=6;case 6:return[3,9];case 7:return s=n.sent(),r=s.message,[3,9];case 8:return r&&u.d.info("getMRUSuggestions: Error "+r),[2,t];case 9:return[2]}})})}function J(){return Object(n.__awaiter)(this,void 0,void 0,function(){var e,t,r;return Object(n.__generator)(this,function(a){switch(a.label){case 0:return e=Object(n.__read)(Object(U.getAccessTokenforResourceAsLazy)(window.location.origin),2),t=e[0],r=e[1],t?[3,2]:[4,r];case 1:t=a.sent(),a.label=2;case 2:return[2,t]}})})}var X=r(3144),W=r(3305),K=r(128),Z=r(8932);function Y(e){var t;return Object(n.__awaiter)(this,void 0,void 0,function(){var r,a,i;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return e.SmartDocData&&!e.SmartDocData.EntityId?[2,[]]:e.SmartDocData?[3,3]:[4,X.c.import()];case 1:return[4,n.sent()(e.ItemId.Id,W.a.SmartDoc)];case 2:(r=n.sent())&&(a=function(e,t){var r=e.ExtendedProperty;if(r)for(var n=r.length,a=0;a<n;a++){var i=r[a];if(i.ExtendedFieldURI.PropertyName===t)return i}return null}(r,y),B(r,a)),n.label=3;case 3:return(null===(t=e.SmartDocData)||void 0===t?void 0:t.EntityId)?[4,G(e.ItemId.Id)]:[3,5];case 4:return(i=n.sent())&&i.length>0?[2,[$(function(e,t){void 0===t&&(t=O);var r=[],n=null;if(e)for(var a=0;a<e.length&&r.length<t;a++)(n=e[a])?r.push(n):u.d.info("[extractAttachmentSuggestions] mru suggestion is null");return r}(i),e)]]:[2,[]];case 5:return[2,[]];case 6:return[2]}})})}function $(e,t){var r=Object(w.b)("SmartDoc","suggestions");r.mainPayload.suggestionsInMenu=e.length,r.mainPayload.EID=t.SmartDocData.EntityId;var n={items:[{key:"replyWithHeader",name:Object(_.a)(x.b),title:Object(_.a)(x.b),itemType:K.a.Header,iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:Z.replyWithHeaderForBottomBar}].concat(e.map(function(e,n){return function(e,t,r,n){return{key:"suggestion"+t,className:Z.attachmentSuggestionButtonRoot,onRender:function(t,a){return D.createElement(N,{item:r,suggestion:e,smartPillLogData:n,onAttachmentClicked:P,dismissMenu:a})}}}(e,n,t,r)}))};return{ariaLabel:Object(_.a)(x.a),featureName:"SmartDoc",icon:{iconName:"Attach"},logData:r,onClick:null,index:0,text:Object(_.a)(x.a),menuProps:n}}var ee=r(919),te=r(1552);function re(e,t){return Object(n.__awaiter)(this,void 0,void 0,function(){var r;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return r=null,Object(te.i)()!==te.c.NotLoaded?[3,2]:[4,te.k.import()];case 1:return n.sent()(function(n){r=ne(Object(te.g)(),e),t(r)}),[3,3];case 2:r=ne(Object(te.g)(),e),t(r),n.label=3;case 3:return[2]}})})}function ne(e,t){var r=function(e){for(var t=0;t<e.length;t++)if(0===e[t].type)return e[t].model.Id;return u.d.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:ee.a.CloudSuggestion,name:t.FileName,size:null,providerId:r,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}var ae=r(972);Object(a.orchestrator)(P,function(e){return Object(n.__awaiter)(this,void 0,void 0,function(){var t,r,a,i=this;return Object(n.__generator)(this,function(o){switch(o.label){case 0:t=e.item,r=e.attachment,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,re(r,function(e){return Object(n.__awaiter)(i,void 0,void 0,function(){return Object(n.__generator)(this,function(r){return function(e,t){Object(n.__awaiter)(this,void 0,void 0,function(){var r,a,i;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return t?[4,ae.v.import()]:[3,5];case 1:return r=n.sent(),[4,ae.i.import()];case 2:return a=n.sent(),(i=Object(ae.c)(e.ConversationId.Id))?[3,4]:[4,r({referenceItemOrId:e,isReplyAll:!0,useFullCompose:!1,actionSource:null,instrumentationContexts:null,conversationId:e.ConversationId.Id,body:null})];case 3:i=n.sent(),n.label=4;case 4:a([t],i,{isInline:!1,isHiddenInline:!1,shouldShare:!0},null,null,null,null),n.label=5;case 5:return[2]}})})}(t,e),[2]})})})];case 2:return o.sent(),[3,4];case 3:return a=o.sent(),u.d.error("[createMessageWithAttachmentOrchestrator] Error when creating cloud file: "+a.message),[3,4];case 4:return[2]}})})});Object(a.mutator)(L,function(e){var t={EntityId:void 0},r=e.item,n=e.validPropertyExists,a=e.entityId;n&&(t.EntityId=a),r.SmartDocData=t});var ie="EntityExtraction/SmartReplyForEmail",oe=r(12990),ce=Object(a.action)("updateSIGSDataOnClickAction",function(e,t,r){return{composeViewState:e,timeClicked:t,clickIndex:r}}),ue=r(2588);var le=Object(a.action)("cacheSmartReplyDataAction",function(e,t,r,n,a){return{item:e,validPropertyExists:t,smartReplies:r,loggableSmartReplies:n,smartReplyExtractionID:a}}),se="2018-06-20T00:00:00.0000000Z",de="@extractionTimeUtc",me="@EntityId",fe=3;function pe(e,t){var r=!1;if(e){if(t)try{var n=JSON.parse(t.Value)[0],a=n[de];if(!a){u.d.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Time stamp not found on property, aborting smart reply parsing.");var i=new Error("NoTimeStamp");throw i.knownError=!0,i}Date.parse(a)>=Date.parse(se)&&(r=function(e,t){for(var r=t[me],n=[],a=[],i=!1,o=t.entities.length,c=0;c<o;c++)n.push(t.entities[c].value),a.push(t.entities[c].valueRaw||t.entities[c].value);if(!r||n.length!=fe){u.d.info("[getSmartRepliesForItem_extractAndCacheSmartRepliesFromProperty] Unexpected number of smart replies on item. Expected "+fe+" but found "+n.length);var l=new Error("NumberOfSmartRepliesIs"+n.length);throw l.knownError=!0,l}le(e,i=!0,n,a,r);return i}(e,n))}catch(e){throw u.d.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Malformed property, cannot parse. Error: "+e.message),e.knownError=!0,e}else u.d.info("[getSmartRepliesForItem_parseSmartReplyProperty] No property found.");r||le(e,r)}else u.d.info("[getSmartRepliesForItem_parseSmartReplyProperty] No item.")}function ge(e){var t;return Object(n.__awaiter)(this,void 0,void 0,function(){var r,a;return Object(n.__generator)(this,function(i){switch(i.label){case 0:return e?e.SmartReplyData?[3,3]:[4,X.c.import()]:[3,4];case 1:return[4,i.sent()(e.ItemId.Id,W.a.SmartReply)];case 2:(r=i.sent())&&(a=function(e,t){var r=e.ExtendedProperty;if(r)for(var n=r.length,a=0;a<n;a++){var i=r[a];if(i.ExtendedFieldURI.PropertyName===t)return i}return null}(r,ie),pe(r,a)),i.label=3;case 3:return(null===(t=e.SmartReplyData)||void 0===t?void 0:t.ExtractionID)?[2,e.SmartReplyData.SmartReplies.map(function(t,r){return function(e,t,r,a,i){var o=this,c=Object(w.b)("SmartReply",r);return c.mainPayload.EID=a,c.mainPayload.confidenceScore=i+1,{ariaLabel:Object(_.b)(Object(_.a)(oe.a),t),featureName:"SmartReply",onClick:function(r){return Object(n.__awaiter)(o,void 0,void 0,function(){var a;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return[4,ue.j.importAndExecute(e.ItemId.Id,e.ConversationId.Id,t,1)];case 1:return a=n.sent(),ce(a,r.logData.mainPayload.timeClicked,r.logData.mainPayload.position),[2]}})})},logData:c,index:i,text:t,toolTip:t,confidenceScore:c.mainPayload.confidenceScore}}(e,t,e.SmartReplyData.LoggableSmartReplies[r],e.SmartReplyData.ExtractionID,r)})]:[3,5];case 4:u.d.info("[getSmartRepliesForItem] No item, cannot produce smart replies."),i.label=5;case 5:return[2,[]]}})})}var ve=r(21),be=(Object(a.mutator)(le,function(e){var t={SmartReplies:null,LoggableSmartReplies:null,ExtractionID:null,SuggestionAppropriatenessMap:null,FeedbackSubmitted:!1},r=e.item,n=e.validPropertyExists,a=e.smartReplies,i=e.loggableSmartReplies,o=e.smartReplyExtractionID;if(n){t={SmartReplies:a,LoggableSmartReplies:i,ExtractionID:o,SuggestionAppropriatenessMap:new ve.ObservableMap,FeedbackSubmitted:!1};for(var c=0;c<a.length;c++){var u=String(c);t.SuggestionAppropriatenessMap.set(u,"")}}r.SmartReplyData=t}),Object(a.mutator)(ce,function(e){var t=e.composeViewState,r=e.timeClicked,n=e.clickIndex;t&&(t.smartReplyComposeSIGSData={isSmartSuggestionsClicked:!0,suggestionsClickedTime:r,clickIndex:n})}),r(8933));var he="EntityExtraction/Events1.0";var Se=r(323),ye=r(71);var Oe=Object(a.action)("cacheSmartTimeExtendedPropertyAction",function(e,t,r){return{item:e,validPropertyExists:t,smartTimesExtendedProp:r}}),xe="@EntityId",Pe="confidence";var je=r(1318),Ie=r(7104),Te=r(838),_e=r(764);function we(){var e=Object(c.f)("mc-smartReplyWithMeeting-Cortana"),t=Object(_e.c)(_e.a.CalendarHelp).calendarHelpEnabled;return e&&t}function De(e){return Object(n.__awaiter)(this,void 0,void 0,function(){var t,r,a,i,o,l,s,d,m,f,p,g;return Object(n.__generator)(this,function(v){switch(v.label){case 0:return t=[],e?e.SmartTimeExtendedProperty?[3,3]:[4,X.c.import()]:[3,7];case 1:return[4,v.sent()(e.ItemId.Id,W.a.SmartTime)];case 2:(r=v.sent())&&(a=function(e){var t=null;if(e){var r=e.ExtendedProperty;r&&r.some(function(e){return e.ExtendedFieldURI.PropertyName==he&&(t=e,!0)})}return t}(r),function(e,t){var r,a;if(t){var i=null,o=!1;try{var c=JSON.parse(t.Value);if(c&&c.length>0){var l=c[0][xe],s=c[0][Pe];try{for(var d=Object(n.__values)(c),m=d.next();!m.done;m=d.next()){var f=m.value;if(f.times&&f.times.length>0){var p=f.times[0];i={beginingOfTimeRange:p.beginingOfTimeRange,endOfTimeRange:p.endOfTimeRange,duration:p.duration,entityId:l,hasIntent:!0,confidenceScore:s},o=!0}}}catch(e){r={error:e}}finally{try{m&&!m.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}}}catch(e){throw u.d.warn("[getSmartTimeForItem_parseSmartTimeProperty] Malformed property, cannot parse. Error: "+e.message),e.knownError=!0,e}finally{Oe(e,o,i)}}else u.d.info("[getSmartTimeForItem_parseSmartTimeProperty] No smart time extended property found.")}(r,a)),v.label=3;case 3:return(i=e.SmartTimeExtendedProperty)?(o=i.entityId,l=100*i.confidenceScore,s=null,d=null,Object(c.f)("mc-smartReplyWithMeeting-SuggestedTimeToCAS")&&(s=function(e){var t,r=null;if(null===(t=e)||void 0===t?void 0:t.SmartTimeExtendedProperty)try{var n=Object(I.jc)(e.SmartTimeExtendedProperty.beginingOfTimeRange);if(Object(Se.e)(n)){var a=e.SmartTimeExtendedProperty.duration,i=Number(a);i<=0&&(i=Object(ye.b)()),r={startTime:n,endTime:Object(I.h)(n,i)}}}catch(e){throw u.d.warn("[getSmartTimeSuggestion] Unable to parse suggested time. Error: "+e.message),e.knownError=!0,e}return r}(e))?[4,Object(Ie.a)(e,s)]:[3,5]):[3,6];case 4:v.sent(),d=Object(Te.b)().conversationReadingPaneViewState.calendarInlineComposeViewState,v.label=5;case 5:m=e,f=we(),p=function(e,t,r,n,a){var i=Object(w.b)("SmartTime",Object(_.a)(be.d)),o=null!=n,c=r.ToRecipients?r.ToRecipients.length:0,u=r.CcRecipients?r.CcRecipients.length:0;i.mainPayload.EID=e,i.mainPayload.confidenceScore=t,i.mainPayload.hasSuggestedTime=o,i.mainPayload.NumToRecipient=c,i.mainPayload.NumCCRecipient=u,i.mainPayload.isCalendarHelpEnabled=a,o&&(i.mainPayload.suggestedStartTime=n.startTime,i.mainPayload.suggestedEndTime=n.endTime);return i}(o,l,m,s,f),g=null,f&&(g={items:ke(e,d,o,m,p)}),t.push(function(e,t,r,n,a,i,o){return{ariaLabel:Object(_.a)(be.d),featureName:"SmartTime",onClick:r,index:e,logData:n,text:t,toolTip:t,icon:i,confidenceScore:a,menuProps:o}}(t.length,Object(_.a)(be.d),function(){return Re(e,d,o,m)},p,l,{iconName:"DateTime2"},g)),v.label=6;case 6:return[3,8];case 7:u.d.info("[getSmartTimesForItem] No item, cannot produce smart times."),v.label=8;case 8:return[2,t]}})})}function Re(e,t,r,n){je.l.importAndExecute(e.ItemId.Id,t,!1,null,r,n.InternetMessageId)}function Ee(e,t,r,n){var a={data:[e.mainPayload]};a.data[0].subtype=t,a.data[0].timeClicked=n,Object(w.g)("SmartPillClicked",[JSON.stringify(a)],r)}function ke(e,t,r,n,a){var i=[];return i.push({key:"OutlookMeeting",text:Object(_.a)(be.c),onClick:function(){Ee(a,"OutlookMeeting",n.InternetMessageId,(new Date).toISOString()),Re(e,t,r,n)}}),i.push({key:"CortanaMeeting",text:Object(_.a)(be.a),onClick:function(){Ee(a,"CortanaMeeting",n.InternetMessageId,(new Date).toISOString()),function(e){ue.j.importAndExecute(e.ItemId.Id,e.ConversationId.Id,Object(_.a)(be.b),2)}(e)}}),i}Object(a.mutator)(Oe,function(e){var t={beginingOfTimeRange:null,endOfTimeRange:null,duration:null,entityId:null,hasIntent:!1,confidenceScore:0},r=e.item,n=e.validPropertyExists,a=e.smartTimesExtendedProp;n&&a&&(t={beginingOfTimeRange:a.beginingOfTimeRange,endOfTimeRange:a.endOfTimeRange,duration:a.duration,entityId:a.entityId,hasIntent:!0,confidenceScore:a.confidenceScore}),r.SmartTimeExtendedProperty=t});var Ae=r(7720),Ne=r(2031),Ce=r(4133);function Fe(e,t,r,n){var a=Object(w.b)("SmartTodo",r);return a.mainPayload.confidenceScore=e.confidenceScore,a.mainPayload.EID=e.entityId,{ariaLabel:Object(_.a)(Ae.a),featureName:"SmartTodo",icon:{iconName:"ToDoLogoOutline"},onClick:function(){!function(e,t,r){if(Object(l.a)())Ne.f.importAndExecute("SmartTask"),e&&t&&Ce.b.importAndExecute(e,t,r)}(e.description,t,e.entityId)},logData:a,index:n,text:r,toolTip:r,confidenceScore:e.confidenceScore}}var Le=Object(a.action)("cacheSmartTaskData",function(e,t,r){return{item:e,validPropertyExists:t,smartTasks:r}}),Me="@EntityId",Be="@sourceConfidenceScore";function Ve(e,t){var r=!1;if(e){if(t)try{r=function(e,t){var r=JSON.parse(t.Value),n=!1;if(!t)return u.d.info("[getSmartTaskForItem_parseSmartTaskProperty] No smart task extended property found."),n;var a=[];if(r&&r.length>0)for(var i=r.length,o=0;o<i;o++){var c=r[o];a.push({entityId:c[Me],description:c.description,confidenceScore:100*Number(c[Be])})}a.length>0?Le(e,n=!0,a):u.d.info("[getSmartTasksForItem_extractAndCacheSmartTaskFromProperty] There are zero smart tasks for this item");return n}(e,t)}catch(e){throw u.d.warn("[getSmartTasksForItem_parseSmartTaskProperty] Malformed property, cannot parse. Error: "+e.message),e.knownError=!0,e}else u.d.info("[getSmartTasksForItem_parseSmartTaskProperty] No property found.");r||Le(e,!1)}else u.d.info("[getSmartTasksForItem_parseSmartTaskProperty] No item found.")}var ze,Ue="EntityExtraction/RequestForAction1.0";function Qe(e,t){var r;return Object(n.__awaiter)(this,void 0,void 0,function(){var a,i;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return e?e.SmartTaskData?[3,3]:[4,X.c.import()]:[3,4];case 1:return[4,n.sent()(e.ItemId.Id,W.a.SmartTask)];case 2:(a=n.sent())&&(i=function(e){var t=null;if(e){var r=e.ExtendedProperty;r&&r.some(function(e){return e.ExtendedFieldURI.PropertyName==Ue&&(t=e,!0)})}return t}(a),Ve(a,i)),n.label=3;case 3:return(null===(r=e.SmartTaskData)||void 0===r?void 0:r.SmartTasks)?[2,e.SmartTaskData.SmartTasks.map(function(r,n){return t==ze.Todo&&e.ItemId?Fe(r,e.ItemId.Id,Object(_.a)(Ae.a),n):function(e,t,r,n,a){var i=Object(w.b)("SmartReminder",n);return i.mainPayload.confidenceScore=e.confidenceScore,i.mainPayload.EID=e.entityId,{ariaLabel:Object(_.a)(Ae.b),featureName:"SmartReminder",icon:{iconName:"AddEvent"},onClick:function(){je.l.importAndExecute(t,null,!1,null,e.entityId,r,!0)},logData:i,index:a,text:n,toolTip:n,confidenceScore:e.confidenceScore}}(r,e.ItemId.Id,e.InternetMessageId,Object(_.a)(Ae.b),n)})]:[3,5];case 4:u.d.info("[getSmartTodosOrRemindersForItem] No item, cannot produce smart tasks."),n.label=5;case 5:return[2,[]]}})})}!function(e){e[e.Todo=0]="Todo",e[e.Reminder=1]="Reminder"}(ze||(ze={}));Object(a.mutator)(Le,function(e){var t={SmartTasks:null},r=e.item;if(e.validPropertyExists){var n=e.smartTasks;t.SmartTasks=n}r.SmartTaskData=t});function He(e){var t=[];return t.push(function(e){var t=this;return{buildPills:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){return Object(n.__generator)(this,function(t){return[2,De(e)]})})},getName:function(){return"SmartTime"}}}(e)),t.push(function(e){var t=this;return{buildPills:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){return Object(n.__generator)(this,function(t){return[2,Y(e)]})})},getName:function(){return"SmartDoc"}}}(e)),t.push(function(e){var t=this;return{buildPills:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){return Object(n.__generator)(this,function(t){return[2,ge(e)]})})},getName:function(){return"SmartReply"}}}(e)),t.push(function(e){var t=this;return{buildPills:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){return Object(n.__generator)(this,function(t){return[2,Qe(e,ze.Todo)]})})},getName:function(){return"SmartTodo"}}}(e)),Object(c.f)("mc-smartTaskWithReminder")&&t.push(function(e){var t=this;return{buildPills:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){return Object(n.__generator)(this,function(t){return[2,Qe(e,ze.Reminder)]})})},getName:function(){return"SmartReminder"}}}(e)),t}function qe(e){var t=this;return{updateLogData:function(r){return Object(n.__awaiter)(t,void 0,void 0,function(){var t,a,i,o,c;return Object(n.__generator)(this,function(n){return e&&(t=null===(o=e.stampedLanguage)||void 0===o?void 0:o.language,a=null===(c=e.stampedLanguage)||void 0===c?void 0:c.locale,i=e.InternetMessageId,r.forEach(function(e){e.logData.mainPayload.language=t,e.logData.mainPayload.locale=a,e.logData.cosmosOnlyData=i})),[2]})})},getName:function(){return"ItemLevelDataUpdater"}}}var Ge=Object(a.action)("updateItemLanguageAction",function(e){return{item:e}});function Je(e){var t=this;return{preRun:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){var t;return Object(n.__generator)(this,function(r){switch(r.label){case 0:return[4,X.c.import()];case 1:return[4,r.sent()(e.ItemId.Id,W.a.LanguageAndLocale)];case 2:return(t=r.sent())&&!t.stampedLanguage&&Ge(t),[2]}})})},getName:function(){return"LanguagePreRunner"}}}var Xe=r(12991);function We(e,t){var r;t.UniqueBody?r=t.UniqueBody.Value:t.NormalizedBody&&(r=t.NormalizedBody.Value);var n={subtitle:void 0,dSATOptions:void 0,donationJson:{messageBody:r}},a=e.some(function(e){return"SmartTime"===e.featureName});return e.some(function(e){return"SmartReply"===e.featureName})?(n.subtitle=Object(_.a)(Xe.f),n.dSATOptions=a?[{logString:"They aren't relevant",uiString:Object(_.a)(Xe.a)},{logString:"They don't sound like me",uiString:Object(_.a)(Xe.c)},{logString:"They're offensive or rude",uiString:Object(_.a)(Xe.d)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(_.a)(Xe.i)},{logString:"I don't want help scheduling a meeting",uiString:Object(_.a)(Xe.k)},{logString:"Other",uiString:Object(_.a)(Xe.e)}]:[{logString:"They aren't relevant",uiString:Object(_.a)(Xe.a)},{logString:"The meaning isn't clear",uiString:Object(_.a)(Xe.b)},{logString:"They don't sound like me",uiString:Object(_.a)(Xe.c)},{logString:"They're offensive or rude",uiString:Object(_.a)(Xe.d)},{logString:"Other",uiString:Object(_.a)(Xe.e)}]):a?(n.subtitle=Object(_.a)(Xe.l),n.dSATOptions=[{logString:"The meeting is already on my calendar",uiString:Object(_.a)(Xe.g)},{logString:"A meeting suggestion isn't relevant",uiString:Object(_.a)(Xe.h)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(_.a)(Xe.i)},{logString:"I want to schedule the meeting later",uiString:Object(_.a)(Xe.j)},{logString:"I don't want help scheduling a meeting",uiString:Object(_.a)(Xe.k)},{logString:"Other",uiString:Object(_.a)(Xe.e)}]):n.subtitle=Object(_.a)(Xe.f),n}var Ke=r(4951);var Ze=r(6340),Ye=r(103),$e=r(7696),et=r(12992),tt=function(e){function t(t){var r=e.call(this,t)||this,n=r.props.item;return r.smartPillBuilders=He(n),r.smartPillArbitrator=S,r.smartPillLogDataUpdaters=function(e){return[qe(e)]}(n),r.smartPillPreRunners=function(e){return[Je(e)]}(n),r.loggedToSIGS=!1,r}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){this.runSmartPillBuilders()},t.prototype.componentDidUpdate=function(){this.loggedToSIGS||(Object(Ze.b)(this.props.item),this.loggedToSIGS=!0)},t.prototype.componentWillUnmount=function(){this.smartPillBuilders=null,this.smartPillArbitrator=null,this.smartPillData=null,this.smartPillPreRunners=null,i(this.props.viewState,!1)},Object.defineProperty(t.prototype,"isComposeFormOpened",{get:function(){var e,t,r=this.props.item;return!(null===(t=null===(e=r)||void 0===e?void 0:e.ItemId)||void 0===t||!t.Id)&&null!=Object(ae.c)(r.ItemId.Id,1)},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.item,r=e.viewState.smartPillBlockVisible;if(!!t.RightsManagementLicenseData||!r||!this.smartPillData||0==this.smartPillData.pillsToShow.length&&0==this.smartPillData.pillsToHide.length||this.isComposeFormOpened)return null;var n=this.smartPillData.pillsToShow.length>0;return D.createElement("div",{className:n?et.bar:void 0},D.createElement($e.a,{arbitratedPills:this.smartPillData,enableFeedbackForm:!t.smartPillFeedbackSubmitted,feedbackData:We(this.smartPillData.pillsToShow,t)}))},t.prototype.runSmartPillBuilders=function(){return Object(n.__awaiter)(this,void 0,void 0,function(){var e;return Object(n.__generator)(this,function(t){switch(t.label){case 0:return u.d.info("[MailSmartPillBlock] Running smart pill builders"),e=this,[4,Object(w.a)(this.smartPillBuilders,this.smartPillArbitrator,this.smartPillPreRunners,this.smartPillLogDataUpdaters,3e3)];case 1:return e.smartPillData=t.sent(),r=this.props.item,n=this.smartPillData,a=n?n.pillsToShow.filter(function(e){return"SmartReply"===e.featureName}):[],o=a.length>0?a[0].logData.mainPayload.EID:"",c=n&&n.pillsToShow.length>0?"True":"False",l="True"===c?n.pillsToShow.map(function(e){return e.featureName}).toString():"",s="True"===c?n.pillsToShow.map(function(e){return e.text}).join("$"):"",Object(Ke.a)(r.ItemId.Id,c,l,s,o),this.smartPillData&&this.smartPillData.pillsToShow.length>0&&i(this.props.viewState,!0),[2]}var r,n,a,o,c,l,s})})},Object(n.__decorate)([ve.computed],t.prototype,"isComposeFormOpened",null),t=Object(n.__decorate)([Ye.observer],t)}(D.Component),rt=(Object(a.mutator)(i,function(e){e.viewState.smartPillBlockVisible=e.smartPillBlockVisible}),Object(a.mutator)(o,function(e){e.item.smartPillFeedbackSubmitted=e.smartPillFeedbackSubmitted}),r(4701));function nt(e){var t,r=function(e){var t=e.ExtendedProperty;if(t){var r=t.filter(function(e){return e.ExtendedFieldURI.PropertyName===rt.a});if(r.length>0)return r[0]}return null}(e),n=void 0,a=void 0,i=0,o=void 0;try{if(r){var c=JSON.parse(r.Value)[0],l=c[rt.c],s=c[rt.d];o=c[rt.b],a=Object.keys(s)[0],n=(null===(t=l)||void 0===t?void 0:t[rt.e])&&l[rt.e].toLowerCase(),i=parseInt(Object.values(s)[0])}}catch(e){u.d.info("[getStampedLanguage] Failed to parse property, error: "+e.message)}return{locale:n,language:a,confidenceScore:i,entityId:o}}Object(a.mutator)(Ge,function(e){var t=e.item;t.stampedLanguage=nt(t)});r.d(t,"MailSmartPillBlock",function(){return tt})},1414:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r(1048);r.d(t,"c",function(){return n.a});var a=r(1246);r.d(t,"d",function(){return a.a});var i=r(951);r.d(t,"e",function(){return i.a}),r.d(t,"b",function(){return i.b});var o=r(52),c=new o.c(function(){return r.e(240).then(r.bind(null,2682))}),u=Object(o.d)(c,function(e){return e.CloudIconWithOverlay})},1417:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o});var n=r(0),a=r(1292),i=function(){return Object(n.__spread)(Object(a.a)().providers.values())},o=function(e){return Object(a.a)().providers.get(e)||null}},1510:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i}),r.d(t,"c",function(){return o});var n,a=r(0);!function(e){e[e.Groups=1e4]="Groups"}(n||(n={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze(Object(a.__spread)(i,[0,4,10]))},1552:function(e,t,r){"use strict";var n=r(52),a=r(1919),i=r(1788),o=(r(1292),r(1327)),c=r(1510),u=(r(2471),r(2406),r(1417));var l=r(1769),s=r(1603),d=r(1388);r.d(t,"k",function(){return f}),r.d(t,"m",function(){return p}),r.d(t,"j",function(){return g}),r.d(t,"l",function(){return v}),r.d(t,"b",function(){return a.a}),r.d(t,"h",function(){return i.a}),r.d(t,"d",function(){return o.a}),r.d(t,"e",function(){return o.b}),r.d(t,"n",function(){return o.c}),r.d(t,"a",function(){return c.b}),r.d(t,"g",function(){return u.b}),r.d(t,"i",function(){return l.a}),r.d(t,"c",function(){return s.a}),r.d(t,"f",function(){return d.b});var m=new n.c(function(){return Promise.all([r.e(589),r.e(4),r.e(12),r.e(21),r.e(243)]).then(r.bind(null,14138))}),f=new n.b(m,function(e){return e.loadProviders}),p=new n.b(m,function(e){return e.removeFileProvider}),g=new n.b(m,function(e){return e.addFileProvider}),v=new n.b(m,function(e){return e.removeAndAddFileProvider})},1603:function(e,t,r){"use strict";var n;r.d(t,"a",function(){return n}),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(n||(n={}))},1769:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(1292);function a(){return Object(n.a)().loadState}},1788:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r(2649),a=r(2405),i=r(2569),o=r(5),c=r(160);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(o.a)(i.b);case 1:return Object(o.a)(i.a);case 2:case 9:return Object(o.a)(n.b);case 3:case 7:return Object(o.a)(n.a);case 5:return Object(o.a)(n.e);case 6:return Object(o.a)(n.d);case 4:return Object(o.a)(n.f);case 10:return Object(o.a)(a.b);case 8:return Object(o.a)(n.c);default:return Object(c.a)(e)}}},1919:function(e,t,r){"use strict";var n;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(n||(n={})),t.a=n},1995:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}},1996:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}},2031:function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return c}),r.d(t,"e",function(){return u}),r.d(t,"f",function(){return l}),r.d(t,"g",function(){return s}),r.d(t,"d",function(){return d}),r.d(t,"c",function(){return m});var n=r(1136),a=r(52),i=new a.c(function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(477)]).then(r.bind(null,3291))});Object(a.f)(n.b,i,function(e){return e.openTimePanelOrchestrator});var o=Object(a.d)(i,function(e){return e.TimePanel}),c=Object(a.d)(i,function(e){return e.TimePanelHeaderBar}),u=(new a.a(i,function(e){return e.preloadTimePanelData}),new a.a(i,function(e){return e.openEventDetailsView})),l=(new a.a(i,function(e){return e.openAttendeeTrackingView}),new a.a(i,function(e){return e.closeAttendeeTrackingView}),new a.a(i,function(e){return e.openTasksView})),s=new a.a(i,function(e){return e.openCalendarView}),d=new a.a(i,function(e){return e.openConflictsView}),m=new a.a(i,function(e){return e.closeConflictsView});new a.a(i,function(e){return e.openEventQuickComposeView})},2405:function(e){e.exports={a:"nza",b:"oza"}},2406:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(40),a=r(245),i=r(160),o=r(65);function c(e){var t=Object(n.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-box");case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-dropbox");case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||Object(o.f)("doc-filePicker-oneDriveConsumerForO365")&&t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(o.f)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},2471:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"b",function(){return i});var n=r(1510),a="file provider is not addable";function i(e){return n.a.indexOf(e)>-1}},2520:function(e,t,r){"use strict";var n=r(797),a=r(2);function i(e,t,r){if(!e||!t||!r)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+r:e+"?"+t+"="+r}r.d(t,"a",function(){return o}),r.d(t,"b",function(){return c}),r.d(t,"c",function(){return u}),r.d(t,"d",function(){return l});var o=Object(a.y)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",r=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(n.m)()+"/mail/"+r+t}function u(e){var t=Object(n.m)()+"/mail/AddFileProvider.html",r=encodeURIComponent("provider="+e+"&url="+t);return o+"/ADPRedirect.aspx?"+r}function l(e,t,r,n,a,o){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,r=[],n=0;n<16;n++)r.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+r.join("")}(),c=i(t,"client_id",n);if(c=i(c,"redirect_uri",r),c=i(c,"response_type",a),o){var u=o(e);c=Object.keys(u).reduce(function(e,t){return i(e,t,u[t])},c)}return{authUrl:c,redirectUrl:r,csrfToken:e}}}},2569:function(e){e.exports={b:"Aza",a:"Bza"}},2649:function(e){e.exports={b:"tza",a:"uza",e:"vza",d:"wza",f:"xza",c:"yza"}},2650:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(129),a=r(1995);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),n.makeServiceRequest("GetNewAttachmentDataProviderCreationInfo",e,t)}},2651:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(129),a=r(1996);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),n.makeServiceRequest("GetAttachmentDataProviderCreator",e,t)}},3164:function(e,t,r){"use strict";var n=r(0),a=2500,i=r(142),o=r(385);function c(e,t,r){var n=new o.a(e,t,{isCore:!0,isCosmosDatapoint:!0});r&&n.addCosmosOnlyData(r),i.e.importAndExecute(n)}function u(e,t,r,i,o){return Object(n.__awaiter)(this,void 0,void 0,function(){var u,l,s,d,m,f,p,g,v,b,h;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return u={},l=o||a,r?[4,Promise.all(r.map(function(e){return e.preRun().catch(function(t){u[e.getName()]=new Error(t)})}))]:[3,2];case 1:n.sent(),n.label=2;case 2:return d=Date.now(),[4,Promise.all(e.map(function(e){return Promise.race([e.buildPills(),(t=l,new Promise(function(e,r){setTimeout(function(){var e=new Error("timeout");e.knownError=!0,r(e)},t)}))]).catch(function(t){return u[e.getName()]=new Error(t),[]});var t})).then(function(e){return s=Date.now(),e})];case 3:return m=n.sent(),f=[].concat.apply([],m),p=f.length,i?[4,Promise.all(i.map(function(e){return e.updateLogData(f).catch(function(t){u[e.getName()]=new Error(t)})}))]:[3,5];case 4:n.sent(),n.label=5;case 5:g={pillsToShow:[],pillsToHide:[],arbitratorId:""};try{g=t.arbitratePills(f)}catch(e){u.arbitrator=new Error(e)}finally{return v=Object.keys(u),b=[],h=[],v.length>0&&v.forEach(function(e){var t=u[e];t.hasOwnProperty("knownError")?b.push(e+"_"+t.message):h.push(e+"_"+t.message)}),c("SmartPillError",[b.toString(),h.toString(),p,s-d,l]),[2,g]}return[2]}})})}function l(e,t,r){return{mainPayload:{renderStory:0,loggableText:t,type:e,timeClicked:null,position:-1},cosmosOnlyData:r}}function s(e,t,r){var n=void 0;e.concat(t).forEach(function(e){!n&&e.logData.cosmosOnlyData&&(n=e.logData.cosmosOnlyData)});var a={data:e.map(function(e){return e.logData.mainPayload})},i={data:t.map(function(e){return e.logData.mainPayload})};c("SmartPillsRendered",[e.length,t.length,JSON.stringify(a),JSON.stringify(i),r],n)}function d(e,t,r,n,a,i,o){c("SmartReply_Rendered",[e,!1,t.join("$"),!1,r.toString(),n.toString(),a,i],o)}function m(e){var t={data:[e.mainPayload]};c("SmartPillClicked",[JSON.stringify(t)],e.cosmosOnlyData)}function f(e,t,r,n,a,i,o){c("SmartReply_Clicked",[e,t,r,!1,n,a,i],o)}r(151);r.d(t,"a",function(){return u}),r.d(t,"b",function(){return l}),r.d(t,"e",function(){return s}),r.d(t,"f",function(){return d}),r.d(t,"c",function(){return m}),r.d(t,"d",function(){return f}),r.d(t,"g",function(){return c})},3305:function(e,t,r){"use strict";var n,a=r(52),i=r(4951),o=r(4),c=r(740);Object(o.mutator)(i.a,function(e){var t,r=e.itemId,n=e.isSmartSuggestionsRendered,a=e.suggestionTypesRendered,i=e.suggestionsRendered,o=e.extractionId,u=Object(c.s)().items.get(r);(null===(t=u)||void 0===t?void 0:t.SIGSData)&&(u.SIGSData.SmartPillData={IsSmartSuggestionsRendered:n,SuggestionTypesRendered:a,SuggestionsRendered:i,ExtractionId:o})});!function(e){e.LanguageAndLocale="SmartPill_LanguageAndLocale",e.SmartDoc="SmartPill_SmartDoc",e.SmartReply="SmartPill_SmartReply",e.SmartTask="SmartPill_SmartTask",e.SmartTime="SmartPill_SmartTime"}(n||(n={})),r.d(t,"b",function(){return l}),r.d(t,"a",function(){return n});var u=new a.c(function(){return r.e(462).then(r.bind(null,13982))}),l=new a.a(u,function(e){return e.logToSIGSOnMessageSent})},4133:function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"c",function(){return o}),r.d(t,"b",function(){return c}),r.d(t,"d",function(){return u});var n=r(52),a=new n.c(function(){return Promise.all([r.e(7),r.e(15),r.e(23),r.e(633),r.e(486)]).then(r.bind(null,6456))}),i=Object(n.d)(a,function(e){return e.TaskListView}),o=new n.a(a,function(e){return e.preloadTaskPanelData}),c=new n.a(a,function(e){return e.initializeQuickAdd}),u=new n.a(a,function(e){return e.switchFolderAndCreateTasks})},4701:function(e,t,r){"use strict";r.d(t,"c",function(){return i}),r.d(t,"e",function(){return o}),r.d(t,"d",function(){return c}),r.d(t,"b",function(){return u}),r.d(t,"a",function(){return l}),r.d(t,"f",function(){return s}),r.d(t,"h",function(){return d}),r.d(t,"i",function(){return m}),r.d(t,"j",function(){return f}),r.d(t,"g",function(){return p});var n=r(468),a=r.n(n),i="Language",o="Locale",c="LanguageScores",u="@EntityId",l="EntityExtraction/ExtractLanguage1.0",s=a()({PropertyName:l,DistinguishedPropertySetId:"Common",PropertyType:"String"}),d=a()({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),m=a()({PropertyName:"EntityExtraction/Events1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),f=a()({PropertyName:"EntityExtraction/RequestForAction1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),p=a()({PropertyName:"EntityExtraction/SendContentRequestV21.0",DistinguishedPropertySetId:"Common",PropertyType:"String"})},4951:function(e,t,r){"use strict";var n=r(4);t.a=Object(n.action)("initializeSIGSDataAction",function(e,t,r,n,a){return{itemId:e,isSmartSuggestionsRendered:t,suggestionTypesRendered:r,suggestionsRendered:n,extractionId:a}})},6340:function(e,t,r){"use strict";r.d(t,"b",function(){return u}),r.d(t,"a",function(){return l});var n=r(0),a=r(151),i=r(740),o=r(62),c=4e3;function u(e){var t,r;if(e.SIGSData&&e.SIGSData.SmartPillData){var n=e.SIGSData.SmartPillData,i=n.IsSmartSuggestionsRendered,u=n.SuggestionTypesRendered,l=n.SuggestionsRendered,s=n.ExtractionId,d=e.InternetMessageId,m=(null===(t=e.UniqueBody)||void 0===t?void 0:t.Value)||(null===(r=e.NormalizedBody)||void 0===r?void 0:r.Value);if(m&&(m=m.substring(0,c)),"True"===i){var f={InternetMessageId:d,MessageBody:m,SuggestionTypesRendered:u,SuggestionsRendered:l,ExtractionId:s};a.j.importAndExecute("SmartSuggestionsRendered",{compliance:"CustomerContent",customProperties:f})}}else o.d.warn("SIGSData object not initialized on item.")}function l(e,t,r){var u,l,s,d,m;try{if(e){var f=Object(i.s)().items.get(e);if(null===(l=null===(u=f)||void 0===u?void 0:u.SIGSData)||void 0===l?void 0:l.SmartPillData){var p=f.InternetMessageId,g=(null===(s=f.NormalizedBody)||void 0===s?void 0:s.Value)||(null===(d=f.UniqueBody)||void 0===d?void 0:d.Value);g&&(g=g.substring(0,c));var v=t.substring(0,c);a.j.importAndExecute("SmartSuggestionsClicked",{compliance:"CustomerContent",customProperties:Object(n.__assign)(Object(n.__assign)({InternetMessageId:p,MessageBody:g},f.SIGSData.SmartPillData),{IsSmartSuggestionsClicked:r&&r.isSmartSuggestionsClicked?"True":"False",SuggestionsClickedTime:null===(m=r)||void 0===m?void 0:m.suggestionsClickedTime,ClickIndex:r&&r.clickIndex.toString(),ReplyBody:v})})}}}catch(e){o.d.error("[logToSIGSOnMessageSent] Error: "+e.message)}}},7696:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(52),a=new n.c(function(){return r.e(463).then(r.bind(null,9332))}),i=(Object(n.d)(a,function(e){return e.SmartPill}),Object(n.d)(a,function(e){return e.SmartPillBlock}))},7720:function(e){e.exports={a:"wvc",b:"xvc"}},8932:function(e,t,r){var n=r(12989),a=r(44);"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)a.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},8933:function(e){e.exports={d:"yvc",c:"zvc",a:"Avc",b:"Bvc"}},951:function(e,t,r){"use strict";r.d(t,"b",function(){return u}),r.d(t,"a",function(){return f});var n,a=r(1256),i=r(1048),o=r(762),c={};function u(e){return e in c?c[e]:(c[e]={extraSmall:Object(i.a)(e+"_16x16"),small:Object(i.a)(e+"_20x20"),medium:Object(i.a)(e+"_32x32"),large:Object(i.a)(e+"_64x64"),cdn:-1===m.indexOf(e)?Object(a.a)(e+"_16x16"):Object(a.a)("generic_16x16")},c[e])}var l="generic",s=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":l,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),d=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"}),m=["gdoc","gform","gsheet","gslide"];function f(e,t,r){if(void 0===t&&(t=!1),t)return n=n||{extraSmall:null,small:Object(i.a)("folder_20x20"),medium:Object(i.a)("folder_32x32"),large:Object(i.a)("folder_64x64"),cdn:Object(a.a)("folder_16x16")};var c,m=Object(o.b)(e);return m&&(c=s[m.toLowerCase()]),!c&&r&&r in d&&(c=d[r]),u(c||l)}}},0,[589,4,12,21,243,1,2,22,577,185,0,578,189,3,477,7,379,5,6,329,15,23,633,486,49,347,565,110,240,260,342,376,463]]);
//# sourceMappingURL=owa.MailSmartPill.js.map
self.scriptsLoaded['owa.MailSmartPill.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailSmartPill.js'] = (new Date()).getTime();