self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.GetItemManager.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[260],{14164:function(e,t,r){"use strict";r.r(t);var n=r(5917),i=r(7722),a=r(7721),o=r(758),s=r(468),u=r.n(s),c=r(737),d={featureId:"rp-omeRevocation",propertyPaths:[u()({PropertyName:"x-ms-exchange-organization-ome-messagestate",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})],isPropertyExistedOnItem:function(e){return!1},shouldGetItemPropertiesFromServer:function(e){var t=o.a.items.get(e);return t&&t.ParentFolderId.Id===Object(c.a)("sentitems")}},m=r(4701),f=r(740),l=r(3305),g=r(65),p=r(4923);function P(e,t){var r=Object(f.s)(),n=r.items.get(e);if(n)if(0===t){var i=r.conversations.get(n.ConversationId.Id);if(i){var a=Object(p.a)(i.conversationId);return n&&a&&a.Id===e}}else if(1===t)return Object(g.f)("mc-smartPillsMessageView");return!1}var I={featureId:l.a.LanguageAndLocale,propertyPaths:[m.f],isPropertyExistedOnItem:function(e){var t=f.H.items.get(e);return t&&!!t.stampedLanguage},shouldGetItemPropertiesFromServer:P},S={featureId:l.a.SmartDoc,propertyPaths:[m.g],isPropertyExistedOnItem:function(e){var t=f.H.items.get(e);return t&&!!t.SmartDocData},shouldGetItemPropertiesFromServer:P},v={featureId:l.a.SmartReply,propertyPaths:[m.h],isPropertyExistedOnItem:function(e){var t=f.H.items.get(e);return t&&!!t.SmartReplyData},shouldGetItemPropertiesFromServer:P},y={featureId:l.a.SmartTask,propertyPaths:[m.j],isPropertyExistedOnItem:function(e){var t=f.H.items.get(e);return t&&!!t.SmartTaskData},shouldGetItemPropertiesFromServer:P},h={featureId:l.a.SmartTime,propertyPaths:[m.i],isPropertyExistedOnItem:function(e){var t=f.H.items.get(e);return t&&!!t.SmartTimeData},shouldGetItemPropertiesFromServer:P},O=r(7117),b=r(7705),E=r(7706);function T(){Object(n.d)([i.c,a.c,b.a,E.b,I,S,v,h,y,O.a,d])}r.d(t,"initializeGetItemManagerForRP",function(){return T})},1726:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(40);function i(){var e=Object(n.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},3305:function(e,t,r){"use strict";var n,i=r(52),a=r(4951),o=r(4),s=r(740);Object(o.mutator)(a.a,function(e){var t,r=e.itemId,n=e.isSmartSuggestionsRendered,i=e.suggestionTypesRendered,a=e.suggestionsRendered,o=e.extractionId,u=Object(s.s)().items.get(r);(null===(t=u)||void 0===t?void 0:t.SIGSData)&&(u.SIGSData.SmartPillData={IsSmartSuggestionsRendered:n,SuggestionTypesRendered:i,SuggestionsRendered:a,ExtractionId:o})});!function(e){e.LanguageAndLocale="SmartPill_LanguageAndLocale",e.SmartDoc="SmartPill_SmartDoc",e.SmartReply="SmartPill_SmartReply",e.SmartTask="SmartPill_SmartTask",e.SmartTime="SmartPill_SmartTime"}(n||(n={})),r.d(t,"b",function(){return c}),r.d(t,"a",function(){return n});var u=new i.c(function(){return r.e(462).then(r.bind(null,13982))}),c=new i.a(u,function(e){return e.logToSIGSOnMessageSent})},3560:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return a}),r.d(t,"d",function(){return o}),r.d(t,"f",function(){return s}),r.d(t,"c",function(){return u}),r.d(t,"e",function(){return c});var n=r(468),i="userHighlightEvent",a="existingHighlight",o="newHighlight",s=r.n(n)()({PropertyName:"UserNoteData",PropertyType:"String",DistinguishedPropertySetId:"Common"}),u=500,c=10},4701:function(e,t,r){"use strict";r.d(t,"c",function(){return a}),r.d(t,"e",function(){return o}),r.d(t,"d",function(){return s}),r.d(t,"b",function(){return u}),r.d(t,"a",function(){return c}),r.d(t,"f",function(){return d}),r.d(t,"h",function(){return m}),r.d(t,"i",function(){return f}),r.d(t,"j",function(){return l}),r.d(t,"g",function(){return g});var n=r(468),i=r.n(n),a="Language",o="Locale",s="LanguageScores",u="@EntityId",c="EntityExtraction/ExtractLanguage1.0",d=i()({PropertyName:c,DistinguishedPropertySetId:"Common",PropertyType:"String"}),m=i()({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),f=i()({PropertyName:"EntityExtraction/Events1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),l=i()({PropertyName:"EntityExtraction/RequestForAction1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),g=i()({PropertyName:"EntityExtraction/SendContentRequestV21.0",DistinguishedPropertySetId:"Common",PropertyType:"String"})},4923:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r(758),i=r(838),a=r(1726);function o(e){var t=n.a.conversations.get(e.Id),r=t?t.conversationNodeIds:[],o=r.length;if(0==o||!i.a.conversationReadingPaneViewState)return null;for(var s=i.a.conversationReadingPaneViewState.itemPartsMap,u=Object(a.a)()?o-1:0,c=Object(a.a)()?-1:1;u>=0&&u<o;){var d=s.get(r[u]),m=d?n.a.items.get(d.itemId):null;if(m&&!m.IsDraft&&!d.isInRollUp)return{mailboxInfo:e.mailboxInfo,Id:m.ItemId.Id};u+=c}return null}},4951:function(e,t,r){"use strict";var n=r(4);t.a=Object(n.action)("initializeSIGSDataAction",function(e,t,r,n,i){return{itemId:e,isSmartSuggestionsRendered:t,suggestionTypesRendered:r,suggestionsRendered:n,extractionId:i}})},5725:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(131);function i(e){var t;return(null===(t=e)||void 0===t?void 0:t.MailboxInfo)&&e.MailboxInfo.type==n.a.GroupMailbox}},5917:function(e,t,r){"use strict";var n=r(0);var i=r(4),a=r(740),o=Object(i.mutatorAction)("updateItemInStore",function(e,t){var r=a.H.items.get(e);r&&Object.keys(t).forEach(function(e){"ExtendedProperty"==e?r.ExtendedProperty=Object(n.__spread)(t.ExtendedProperty,r.ExtendedProperty):"ItemId"!=e&&(r[e]=t[e])})}),s=r(151),u=r(1081),c=r(1074),d=r(758),m=r(842),f=r.n(m),l=r(62);r.d(t,"d",function(){return I}),r.d(t,"b",function(){return S}),r.d(t,"c",function(){return v}),r.d(t,"a",function(){return y});var g={},p={},P="GetItemManagerFailure";function I(e){e.forEach(function(e){p[e.featureId]=e})}function S(e,t){var r;if(!g[e]||"Pending"!=g[e].requestStatus){var i=function(e,t){var r=[];if(Object.keys(p).forEach(function(i){var a=p[i],o=a.isPropertyExistedOnItem,s=a.shouldGetItemPropertiesFromServer,u=a.propertyPaths;!o(e)&&s(e,t)&&r.push.apply(r,Object(n.__spread)(u))}),r.length>0)return f()({BaseShape:"IdOnly",AdditionalProperties:r});return null}(e,t);if(i){var a={itemId:e,listViewType:t,requestStatus:"Pending",pendingPromise:null};g[e]=a;var m=null===(r=d.a.items.get(e).MailboxInfo)||void 0===r?void 0:r.requestOptions;a.pendingPromise=Object(u.a)([e],i,null,null,m).then(function(t){if(t&&Object(c.a)(t[0])){a.requestStatus="Success";var r=t[0];return o(e,r.Items[0]),Promise.resolve(d.a.items.get(e))}var i=Object(n.__read)(function(e){return e&&"Success"!=e.ResponseClass?[e.ResponseCode,e.StackTrace]:[null,null]}(t[0]),2),s=i[0],u=i[1];return a.requestStatus="Error",Promise.reject(new Error("GetItem failed ErrorResponseCode="+s+", StackTrace="+u))}).catch(function(e){return a.requestStatus="Error",Object(s.m)(P,{errorMessage:e.message}),l.d.warn("[GetItemManager_getAdditionalPropertiesFromServer] Error: "+e.message),Promise.reject(e)})}}}function v(e,t){var r=p[t];if(!r)return Promise.reject("GetItemManager: The featureId is not registered in GetItemManager.");if(r.isPropertyExistedOnItem(e))return Promise.resolve(d.a.items.get(e));if(!g[e])return Promise.reject("GetItemManager: Please trigger getItem after the container finished loading.");var n=g[e];switch(n.requestStatus){case"Success":return Promise.resolve(d.a.items.get(e));case"Pending":case"Error":return n.pendingPromise;default:return Promise.reject("GetItemManager: The request status is unknown.")}}function y(e){delete g[e]}},7117:function(e,t,r){"use strict";r.d(t,"b",function(){return s});var n=r(1695),i=r(758),a=r(743),o=r.n(a),s="MeetingConflicts",u=o()({FieldURI:"ConflictingMeetings"}),c=o()({FieldURI:"AdjacentMeetings"}),d={featureId:s,propertyPaths:[c,u],isPropertyExistedOnItem:function(e){return!1},shouldGetItemPropertiesFromServer:function(e){var t=i.a.items.get(e);return!(!t||!Object(n.a)(t.ItemClass))}};t.a=d},7705:function(e,t,r){"use strict";r.d(t,"b",function(){return s});var n=r(5725),i=r(65),a=r(758),o=r(743),s="UserHighlight",u=r.n(o)()({FieldURI:"UserHighlightData"}),c={featureId:s,propertyPaths:[u],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userHighlightData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.f)("mc-userHighlighting"))return!1;var r=a.a.items.get(e);return r&&!Object(n.a)(r)}};t.a=c},7706:function(e,t,r){"use strict";r.d(t,"c",function(){return s}),r.d(t,"a",function(){return u});var n=r(5725),i=r(65),a=r(758),o=r(3560),s="UserNote",u="UserNoteData",c={featureId:s,propertyPaths:[o.f],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userNoteData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.f)("rp-userMarkup"))return!1;var r=a.a.items.get(e);return r&&!Object(n.a)(r)}};t.b=c},7721:function(e,t,r){"use strict";r.d(t,"a",function(){return s}),r.d(t,"b",function(){return u}),r.d(t,"d",function(){return c});var n=r(65),i=r(758),a=r(468),o=r.n(a),s="EntityExtraction/ExtractLanguage1.0",u="EntityExtraction/ExtractQuotedTextLanguages1.0",c="InlineTranslationLocale",d=[o()({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"}),o()({PropertyName:u,DistinguishedPropertySetId:"Common",PropertyType:"String"})],m={featureId:c,propertyPaths:d,isPropertyExistedOnItem:function(e){var t,r=i.a.items.get(e);return(null===(t=r)||void 0===t?void 0:t.TranslationData)&&null!=r.TranslationData.itemLocale},shouldGetItemPropertiesFromServer:function(e,t){return!!(Object(n.f)("rp-inlineTranslation")&&0==t||Object(n.f)("rp-inlineTranslation-conversationViewOff"))&&!i.a.items.get(e).RightsManagementLicenseData}};t.c=m},7722:function(e,t,r){"use strict";r.d(t,"a",function(){return s}),r.d(t,"b",function(){return u}),r.d(t,"d",function(){return c});var n=r(65),i=r(758),a=r(468),o=r.n(a),s="TranslationData",u="TranslationStatus",c="InlineTranslationDataAndStatus",d=[o()({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"}),o()({PropertyName:u,DistinguishedPropertySetId:"Common",PropertyType:"String"})],m={featureId:c,propertyPaths:d,isPropertyExistedOnItem:function(e){var t,r=i.a.items.get(e);return(null===(t=r)||void 0===t?void 0:t.TranslationData)&&null!=r.TranslationData.userLanguage},shouldGetItemPropertiesFromServer:function(e,t){return!!(Object(n.f)("rp-inlineTranslation")&&Object(n.f)("tra-cacheTranslation")&&0==t||Object(n.f)("rp-inlineTranslation-conversationViewOff")&&Object(n.f)("tra-cacheTranslation"))&&!i.a.items.get(e).RightsManagementLicenseData}};t.c=m},838:function(e,t,r){"use strict";r.d(t,"b",function(){return a});var n=r(1089),i=r(4),a=Object(i.createStore)("readingpane",{conversationReadingPaneViewState:null,itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null}),o=a();n.a.registerReference(function(){return o.conversationReadingPaneViewState&&o.conversationReadingPaneViewState.conversationId.Id}),t.a=o},8906:function(e,t,r){"use strict";r.r(t);var n=r(5917);r.d(t,"getAdditionalPropertiesFromServer",function(){return n.b}),r.d(t,"getItemProperties",function(){return n.c}),r.d(t,"cleanUpByItemId",function(){return n.a})}},0,[0,1,2,578,189]]);
//# sourceMappingURL=owa.GetItemManager.js.map
self.scriptsLoaded['owa.GetItemManager.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.GetItemManager.js'] = (new Date()).getTime();