self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentPreviewSxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[128],{1007:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return u});var r=600,a=600,i=650,o=1/2.89*100,c=420,u=420/1300*100},1017:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(40),a="HTML",i="Text",o="Html";function c(){return Object(r.a)().UserOptions.ComposeMarkup==o?"HTML":"Text"}},1054:function(e,t,n){var r=n(1270),a=36e5,i=6e4,o=2,c=/[T ]/,u=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],v=/^-(\d{2})$/,b=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,h=/^-?W(\d{2})$/,p=/^-?W(\d{2})-?(\d{1})$/,w=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,y=/^(Z)$/,I=/^([+-])(\d{2})$/,P=/^([+-])(\d{2}):?(\d{2})$/;function _(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var j=function(e){var t,n={},r=e.split(c);if(u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var a=S.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),C=function(e,t){var n,r=d[t],a=f[t];if(n=l.exec(e)||a.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=s.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(j.date,n),T=C.year,A=function(e,t){if(null===t)return null;var n,r,a,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=v.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=b.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=m.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=h.exec(e))return i=parseInt(n[1],10)-1,_(t,i);if(n=p.exec(e)){i=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return _(t,i,u)}return null}(C.restDateString,T);if(A){var E,R=A.getTime(),x=0;return j.time&&(x=function(e){var t,n,r;if(t=w.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=g.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*i;if(t=O.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*i+1e3*o}return null}(j.time)),j.timezone?(D=j.timezone,E=(M=y.exec(D))?0:(M=I.exec(D))?(k=60*parseInt(M[2],10),"+"===M[1]?-k:k):(M=P.exec(D))?(k=60*parseInt(M[2],10)+parseInt(M[3],10),"+"===M[1]?-k:k):0):(E=new Date(R+x).getTimezoneOffset(),E=new Date(R+x+E*i).getTimezoneOffset()),new Date(R+x+E*i)}var D,M,k;return new Date(e)}},1058:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),a=n(821),i=n(814),o=n(62);function c(){var e,t,n=Object(i.a)();try{for(var c=Object(r.__values)(n.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(s.isActive&&s.type!=a.a.FloatingChat)return s}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}return o.d.error("There is no active tab. Something went very wrong."),null}},1075:function(e,t,n){"use strict";n.d(t,"t",function(){return d}),n.d(t,"g",function(){return l}),n.d(t,"h",function(){return f}),n.d(t,"i",function(){return v}),n.d(t,"j",function(){return b}),n.d(t,"k",function(){return m}),n.d(t,"l",function(){return h}),n.d(t,"m",function(){return p}),n.d(t,"n",function(){return w}),n.d(t,"o",function(){return g}),n.d(t,"p",function(){return O}),n.d(t,"q",function(){return S}),n.d(t,"r",function(){return y}),n.d(t,"s",function(){return I}),n.d(t,"u",function(){return P});var r=n(2088);n.d(t,"c",function(){return r.a});var a=n(1538);n.d(t,"d",function(){return a.a});var i=n(1499);n.d(t,"f",function(){return i.a});var o=n(52),c=n(1007);n.d(t,"b",function(){return c.a}),n.d(t,"e",function(){return c.d});var u=n(2089);n.d(t,"a",function(){return u.a});var s=new o.c(function(){return Promise.all([n.e(79),n.e(628),n.e(4),n.e(12),n.e(471)]).then(n.bind(null,3997))}),d=new o.b(s,function(e){return e}),l=new o.b(s,function(e){return e.resetPreviewPane}),f=(new o.b(s,function(e){return e.setAudioPreviewState}),new o.b(s,function(e){return e.setBlankPreviewState}),new o.b(s,function(e){return e.setCustomPreviewState}),new o.b(s,function(e){return e.setIframePreviewState})),v=(new o.b(s,function(e){return e.setImageGalleryItems}),new o.b(s,function(e){return e.setImagePreviewLoaded})),b=new o.b(s,function(e){return e.setImagePreviewState}),m=new o.b(s,function(e){return e.setImagePreviewStateFromImageGalleryItem}),h=(new o.b(s,function(e){return e.setNativePdfPreviewState}),new o.b(s,function(e){return e.setPanesSize})),p=(new o.b(s,function(e){return e.setPdfJsPreviewState}),new o.b(s,function(e){return e.setPdfJsPreviewStateByData}),new o.b(s,function(e){return e.setPreviewError})),w=new o.b(s,function(e){return e.setPreviewLoading}),g=new o.b(s,function(e){return e.setRightPaneDisplayAndUpdateSize}),O=new o.b(s,function(e){return e.setSaveStatusText}),S=new o.b(s,function(e){return e.setTextPreviewState}),y=(new o.b(s,function(e){return e.setVideoPreviewState}),new o.b(s,function(e){return e.setWacPreviewState})),I=new o.b(s,function(e){return e.setWacReadOnly}),P=new o.b(s,function(e){return e.updatePanesSize})},1098:function(e,t,n){"use strict";var r=n(1138);n(809),n(50),n(832);n(820),n(846);n.d(t,"a",function(){return r.a})},1104:function(e,t,n){"use strict";n.d(t,"a",function(){return v}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return m});var r=n(0),a=n(5),i=n(1161),o=n(1784),c=n.n(o),u=n(40),s=n(151),d=n(62),l=Object(i.b)({timeBetweenRetryInMS:function(){return 3e4}}),f=function(){function e(e,t,n){var i=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return Object(r.__awaiter)(i,void 0,void 0,function(){function e(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,c()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),d.d.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}var t,n,a,i,o=this;return Object(r.__generator)(this,function(c){switch(c.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=l(function(){return Object(r.__awaiter)(o,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,a=new s.b("AttachmentRefreshDownloadToken"),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n()];case 2:return c.sent(),a.addCustomData([t]),a.end(),[3,4];case 3:return i=c.sent(),d.d.warn("Retry to refresh token failed: "+i),a.addCustomData([t]),a.endWithError("ServerError",i),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(a.g)(this.downloadUrlBase),this.downloadToken=n,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(u.a)().ApplicationSettings;e.instance=new e(t.DownloadTokenRefreshMinutes,t.DownloadUrlBase,t.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function v(){return f.getInstance().getDownloadToken()}function b(){return f.getInstance().getUseDownloadUrlBase()}function m(){return f.getInstance().getDownloadUrlBase()}},1138:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(809);function a(){return(location?location.pathname:"").split("/").indexOf(r.c)>=0}},11462:function(e){e.exports={a:"Ttb"}},1157:function(e,t,n){"use strict";var r=n(821),a=n(1483),i=n(1058),o=n(1861),c=n(1952),u=n(49),s=n(1197);t.a=Object(u.c)("activateTab",a.a.TabViewActivateTab)(function(e,t){var n,a;switch(Object(o.a)(e,!0),e.type){case r.a.FloatingChat:return void Object(c.a)(e);case r.a.Primary:case r.a.OverflowMenu:case r.a.SecondaryReadingPane:case r.a.Compose:if(!e.isActive){var u,d=Object(i.a)();if(d)d.isActive=!1,(null===(n=u=Object(s.a)(d.type))||void 0===n?void 0:n.onDeactivate)&&u.onDeactivate(d);if(e)e.isActive=!0,e.blink=!1,(null===(a=u=Object(s.a)(e.type))||void 0===a?void 0:a.onActivate)&&u.onActivate(e)}return}})},1160:function(e,t,n){"use strict";var r=n(160),a=n(131),i=n(1324),o=n(41);function c(e,t,n,o,c){void 0===c&&(c=!0);var u=t,s=u.AttachmentId,l=u.Name,f=u.OriginalPermissionType,v=u.PermissionType,b=d(t),m=e.mailboxInfo.type===a.a.GroupMailbox?e.mailboxInfo.primarySmtpAddress+"/":null;switch(n){case 0:case 3:return i.b(s,b,n,o,v,f,c,l,m);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:i.b(s,b,1,o,v,f,c,l,m);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function u(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),i.a(e.mailboxInfo.routingKey,e,t,n,r)}function s(e,t,n,r,a){void 0===a&&(a=!1);var s=n?c(e,t,1,r,!1):u(e,1,a,!1);if(n)return{url:s,init:{credentials:"include"}};var d=Object(i.c)(),l=new Headers;return l.set("X-Token",d),l.set("X-OWA-CANARY",Object(o.getOwaCanaryCookie)()),{url:s,init:{headers:l}}}function d(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}function l(e,t,n,r,a,i){return void 0===i&&(i=!1),r?c(e,t,n,a):u(e,n,i)}n.d(t,"a",function(){return l}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return d})},1161:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(o,c){a?c(new Error("The function retry was cancelled")):(r++,e().then(function(e){return o(e)}).catch(function(e){t&&r>=t?c(e):setTimeout(function(){return i(o,c)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a})},1191:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),a=n(948),i=n(814),o=n(889),c=n(160);function u(e,t,n){var u,f,v;void 0===t&&(t=0);var b=function(e){switch(e){case 0:return s;case 1:return d;case 2:return l;default:return Object(c.a)(e)}}(t),m=Object(o.b)();try{for(var h=Object(r.__values)(Object(i.a)().tabs),p=h.next();!p.done;p=h.next()){var w=p.value;if(w.type==a.a.Compose&&!w.isShown){var g=m.viewStates.get(w.data);if((null===(v=g)||void 0===v?void 0:v.isInlineCompose)&&b(g,e)&&(0==g.asyncSendState||n&&6==g.asyncSendState))return g}}}catch(e){u={error:e}}finally{try{p&&!p.done&&(f=h.return)&&f.call(h)}finally{if(u)throw u.error}}return null}function s(e,t){return e.conversationId===t}function d(e,t){return e.referenceItemId.Id===t}function l(e,t){return!1}},1197:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(821),a={};function i(e,t){a[r.a[e]]=t}function o(e){return a[r.a[e]]}},1217:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i});var r=n(1951);function a(e){var t,n,r;return e.isDirty||(null===(t=e.toRecipientWell)||void 0===t?void 0:t.isDirty)||(null===(n=e.ccRecipientWell)||void 0===n?void 0:n.isDirty)||(null===(r=e.bccRecipientWell)||void 0===r?void 0:r.isDirty)}function i(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}},1270:function(e,t){e.exports=function(e){return e instanceof Date}},1285:function(e,t,n){"use strict";var r=n(4),a=Object(r.actionCreator)("ADD_CHAT_TAB",function(e){return{chatConversationId:e}});t.a=a},1286:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",function(e,t){return{itemContexts:e,parentFolderId:t}})},1317:function(e,t,n){"use strict";var r=n(160),a=n(5),i=n(41),o="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",l="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",v="pdfprint.aspx?id={0}&location={1}",b=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var m=n(1104),h=n(245),p=n(33),w=n(2);function g(e,t,n,c,s,l,f,m,h){var p;switch(void 0===s&&(s=0),void 0===l&&(l=0),void 0===f&&(f=!0),void 0===m&&(m=null),void 0===h&&(h=null),n){case 0:p=u;break;case 3:p=v;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&b.indexOf(t.toLowerCase())>=0}(m))return null;p=d;break;default:Object(r.a)(n)}var w=c?l:s;!w&&s&&(w=s);var g=Object(a.b)("{0}{1}{2}&permissionLevel={3}",o,h,Object(a.b)(p,encodeURIComponent(e.Id),encodeURIComponent(t)),w);f&&(g=g+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)());return g}function O(e,t,n,u,d){var v;switch(void 0===u&&(u=!1),void 0===d&&(d=!0),n){case 0:v=c;break;case 1:v=s;break;case 2:v=l;break;case 3:v=f;break;default:return Object(r.a)(n)}return Object(a.g)(v)?null:Object(a.b)("{0}{1}{2}",function(e,t,n,r,c){if(void 0===c&&(c=!1),!t||!t.Id)return null;var u=Object(a.b)(n,encodeURIComponent(t.Id));if(!Object(m.c)()||c&&"Firefox"===Object(p.a)().browser)return o+u+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)();var s="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(h.a)()&&(s+="&isc=1");var d=Object(a.b)(s,Object(m.b)(),e,u,window.location.hostname,Object(w.h)()||"unofficial");return r&&(d+="&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)(),d+="&token="+Object(m.a)()),d}(e,t,v,d,3===n),u?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return g}),n.d(t,"a",function(){return O})},1318:function(e,t,n){"use strict";var r=n(52),a=n(2326),i=n(1582),o=n(1286),c=n(1637),u=n(1854),s=n(1855),d=n(1691),l=n(2079),f=(n(1597),n(1781),n(758)),v=n(838);function b(e,t){return!!e&&(1!==t&&!!f.a.conversations.get(e))}function m(e,t){return 2!=t&&(v.a.itemReadingPaneViewState&&v.a.itemReadingPaneViewState.itemId==e)}n.d(t,"f",function(){return p}),n.d(t,"j",function(){return w}),n.d(t,"g",function(){return g}),n.d(t,"k",function(){return O}),n.d(t,"m",function(){return S}),n.d(t,"h",function(){return y}),n.d(t,"i",function(){return I}),n.d(t,"d",function(){return P}),n.d(t,"c",function(){return _}),n.d(t,"e",function(){return j}),n.d(t,"l",function(){return C}),n.d(t,"a",function(){return b}),n.d(t,"b",function(){return m}),n.d(t,"n",function(){return v.a});var h=new r.c(function(){return Promise.all([n.e(3),n.e(5),n.e(8),n.e(13),n.e(422)]).then(n.bind(null,14058))}),p=new r.a(h,function(e){return e.loadConversationReadingPane}),w=(new r.a(h,function(e){return e.reloadReadingPane}),new r.a(h,function(e){return e.moveReadingPaneToTab})),g=new r.a(h,function(e){return e.loadConversationReadingPaneForSingleMailItemSelected}),O=new r.a(h,function(e){return e.print}),S=new r.a(h,function(e){return e.setItemIdToScrollTo}),y=new r.a(h,function(e){return e.loadItemReadingPane}),I=new r.a(h,function(e){return e.loadItemReadingPaneForSingleMailItemSelected}),P=new r.a(h,function(e){return e.initializeStitches});Object(r.f)(o.a,h,function(e){return e.deleteItemsStoreUpdateOrchestrator}),Object(r.f)(u.a,h,function(e){return e.markConversationsAsReadStoreUpdateOrchestrator}),Object(r.f)(s.a,h,function(e){return e.markItemsAsReadStoreUpdateOrchestrator}),Object(r.f)(c.a,h,function(e){return e.markAllAsReadOrchestrator}),Object(r.f)(a.a,h,function(e){return e.applyConversationFlagStateStoreUpdateOrchestrator}),Object(r.f)(i.a,h,function(e){return e.deleteConversationStoreUpdateOrchestrator}),Object(r.f)(d.a,h,function(e){return e.conversationReadyToLoadOrchestrator}),Object(r.f)(d.b,h,function(e){return e.updateItemMandatoryPropertiesOrchestrator}),Object(r.f)(l.a,h,function(e){return e.updateInternetMessageIdOrchestrator});var _=new r.b(h,function(e){return e.getLastestNonDraftItemId}),j=new r.b(h,function(e){return e.isUnsupportedItem}),C=(new r.a(h,function(e){return e.setCalendarInlineComposeViewState}),new r.a(h,function(e){return e.replyByMeeting}))},1323:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0);function a(e){var t,n,a,i,o=[];if(null===(a=e)||void 0===a?void 0:a.recipients)try{for(var c=Object(r.__values)(e.recipients),u=c.next();!u.done;u=c.next()){var s=u.value,d=s.persona.EmailAddress;(null===(i=d)||void 0===i?void 0:i.ItemId)&&"PrivateDL"==d.MailboxType?o.push({Name:d.Name,RoutingType:d.RoutingType,MailboxType:d.MailboxType,ItemId:{Id:d.ItemId.Id,ChangeKey:null},EmailAddressIndex:d.EmailAddressIndex,RelevanceScore:d.RelevanceScore||0}):o.push(s.persona.EmailAddress)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return o}},1324:function(e,t,n){"use strict";var r=n(1317);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b});var a=n(1104);n.d(t,"c",function(){return a.a})},1360:function(e,t,n){"use strict";n.d(t,"m",function(){return i}),n.d(t,"l",function(){return o}),n.d(t,"o",function(){return c}),n.d(t,"q",function(){return u}),n.d(t,"p",function(){return s}),n.d(t,"b",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"g",function(){return f}),n.d(t,"h",function(){return v}),n.d(t,"k",function(){return b}),n.d(t,"n",function(){return m}),n.d(t,"r",function(){return h}),n.d(t,"c",function(){return p}),n.d(t,"d",function(){return w}),n.d(t,"j",function(){return g}),n.d(t,"f",function(){return O}),n.d(t,"i",function(){return S}),n.d(t,"a",function(){return y});var r=n(52),a=(n(1596),new r.c(function(){return Promise.all([n.e(645),n.e(4),n.e(12),n.e(37),n.e(554)]).then(n.bind(null,3289))})),i=new r.a(a,function(e){return e.onSmimeItemAttachmentOpened}),o=new r.a(a,function(e){return e.mergeSmimeDecodedMessageProperties}),c=(new r.b(a,function(e){return e.fetchAndDecodeSmimeMessage}),new r.b(a,function(e){return e.setSmimePropertiesInDraftMessage})),u=new r.b(a,function(e){return e.trySetSmimeProperties}),s=new r.b(a,function(e){return e.tryAddSmimeProperties}),d=new r.b(a,function(e){return e.createMailResponseBodyContent}),l=new r.b(a,function(e){return e.downloadSmimeAttachment}),f=new r.b(a,function(e){return e.getMergedSmimeViewState}),v=new r.b(a,function(e){return e.getMergedSmimeViewStateForDraft}),b=new r.b(a,function(e){return e.isSmimeItemDecoding}),m=new r.b(a,function(e){return e.previewSmimeAttachment}),h=new r.b(a,function(e){return e.updateSmimeAttachmentIds}),p=new r.b(a,function(e){return e.createSmimeAttachmentsFromFiles}),w=new r.b(a,function(e){return e.createSmimeAttachmentsViaSmimeQueueManager}),g=new r.b(a,function(e){return e.initializeAttachmentStateForSmimeAttachments}),O=new r.b(a,function(e){return e.getAttachmentsForSmimeResponse}),S=new r.b(a,function(e){return e.getSmimeAttachmentsForRequest}),y=Object(r.d)(a,function(e){return e.SignatureDetails})},1383:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},1412:function(e,t,n){"use strict";var r=n(745),a=n.n(r),i=n(69);function o(e){e&&(e.isDirty=!1)}t.a=Object(i.action)("updateComposeItemId")(function(e,t,n,r){e&&(e.itemId?e.itemId.ChangeKey=n:e.itemId=a()({Id:t,ChangeKey:n}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,o(e.toRecipientWell),o(e.ccRecipientWell),o(e.bccRecipientWell)))})},1413:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),a=n(1754);function i(e){var t;return Object(r.__awaiter)(this,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,a.c.import()];case 1:return n=r.sent(),e&&n(null===(t=e.referenceItemId)||void 0===t?void 0:t.Id),[2]}})})}},1482:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(4),a=Object(r.action)("messageBeingSent")},1483:function(e,t,n){"use strict";t.a={TabViewAddTab:{name:"TabViewAddTab",customData:function(e,t,n,r){return[e,t,n]}},TabViewCloseTab:{name:"TabViewCloseTab",customData:function(e,t){return[e.type,e.isShown,e.isActive,t,e.startTime?(new Date).getTime()-e.startTime:0]}},TabViewActivateTab:{name:"TabViewActivateTab",customData:function(e,t){return[e.type,t]},options:{isVerbose:!0}}}},1484:function(e,t,n){"use strict";var r=n(4),a=Object(r.createStore)("MRUAttachmentStore",{attachments:[]});t.a=a},1485:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("onInlineComposeSendStateChange",function(e,t){return{viewState:e,isSendPending:t}})},1543:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1582:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("DELETE_CONVERSATION_STORE_UPDATE",function(e,t){return{conversationIds:e,tableView:t}})},1587:function(e,t,n){var r=n(1054);e.exports=function(e,t){var n=r(e).getTime(),a=Number(t);return new Date(n+a)}},1596:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("saveSigningCertificate",function(e,t){return{smimeViewState:e,signingCertRawData:t}})},1597:function(e,t,n){"use strict";var r=n(838),a=n(69);t.a=Object(a.action)("setItemReadingPaneViewState")(function(e){r.a.itemReadingPaneViewState=e})},161:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,a=!1;function i(t){r--,delete e[t]}this.put=function(t,n,a,o){if(void 0!==a&&("number"!=typeof a||isNaN(a)||a<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var u={value:n,expire:a+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){i(t),o&&o(t,n)}.bind(this),a)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),a&&(t=0,n=0)},this.get=function(i){var o=e[i];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return a&&t++,o.value;a&&n++,r--,delete e[i]}else a&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){a=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),a=Date.now(),i=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(i)if(e[o])continue;var c=r[o],u=c.expire-a;if(u<=0){this.del(o);continue}u=u>0?u:void 0,this.put(o,c.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},1637:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",function(e,t,n){return{tableView:e,markAsRead:t,rowIdsToExclude:n}})},1691:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(4),a=Object(r.action)("CONVERSATION_READY_TO_LOAD",function(e,t){return{conversationId:e,nodeIdCollectionChange:t}}),i=Object(r.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",function(e,t){return{conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:t}})},1754:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return c});var r=n(52),a=n(1484);n.d(t,"a",function(){return a.a});var i=new r.c(function(){return Promise.all([n.e(4),n.e(130)]).then(n.bind(null,3049))}),o=new r.b(i,function(e){return e.getAttachmentSuggestionsAction}),c=new r.b(i,function(e){return e.createCloudFileFromAttachmentData})},1755:function(e){e.exports={a:"Xca",b:"Yca"}},1781:function(e,t,n){"use strict";var r=n(838),a=n(69);t.a=Object(a.action)("setItemPrintPaneViewState")(function(e){r.a.itemPrintPaneViewState=e})},1784:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},1835:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129);t.default=function(e,t){return r.makeServiceRequest("GetWacAttachmentInfo",e,t)}},1854:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",function(e,t,n,r){return{conversationIds:e,tableViewId:t,isReadValue:n,isExplicit:r}})},1855:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",function(e,t,n,r){return{itemIds:e,isReadValue:t,isExplicit:n,tableViewId:r}})},1861:function(e,t,n){"use strict";var r=n(1157),a=n(69),i=n(814);t.a=Object(a.action)("setTabIsShown")(function(e,t){if(e.isShown!=t&&(e.isShown=t,e.blink=t,e.isActive&&!t)){var n=Object(i.a)(),a=n.tabs.indexOf(e),o=n.tabs.filter(function(t){return t.id==e.parentTabId&&t.isShown})[0]||function(e,t){t<0&&(t=0);for(var n=t;n<e.length;n++)if(e[n].isShown)return e[n];for(n=t-1;n>=0;n--)if(e[n].isShown)return e[n];return null}(n.tabs,a);o&&Object(r.a)(o)}})},1910:function(e,t,n){"use strict";var r=n(0),a=n(1157),i=n(1483),o=n(1058),c=n(821),u=n(49),s=n(814),d=1;t.a=Object(u.c)("addTab",i.a.TabViewAddTab)(function(e,t,n,i){var u=Object(o.a)(),l=Object(s.a)(),f={id:c.a[e]+(d++).toString(),isShown:t,isActive:!1,startTime:(new Date).getTime(),parentTabId:u?u.id:null,blink:t,data:i},v=null;switch(e){case c.a.Primary:v=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.Primary});break;case c.a.OverflowMenu:v=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.OverflowMenu,data:i});break;case c.a.SecondaryReadingPane:v=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.SecondaryReadingPane,data:i});break;case c.a.Compose:v=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.Compose,data:i});break;case c.a.FloatingChat:v=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.FloatingChat,data:i,isChatActive:!1})}l.tabs.push(v),n&&Object(a.a)(l.tabs[l.tabs.length-1])})},1951:function(e,t,n){"use strict";function r(e){var t;return(null===(t=e)||void 0===t?void 0:t.recipients)?e.recipients.length:0}n.d(t,"a",function(){return r})},1952:function(e,t,n){"use strict";var r=n(69);t.a=Object(r.action)("toggleChatTab")(function(e){e.isChatActive=!e.isChatActive,e.isActive=e.isChatActive,e.blink=!1})},2038:function(e,t,n){var r=n(1587),a=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*a)}},2039:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),a=n(1383);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},2079:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("updateInternetMessageId",function(e,t,n){return{conversationId:e,itemId:t,internetMessageId:n}})},2088:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Default=0]="Default",e[e.NeedPassword=1]="NeedPassword",e[e.IncorrectPassword=2]="IncorrectPassword"}(r||(r={}))},2089:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="autoHideEmail"},2143:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},2232:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),a=n(2233);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAttachmentTextPreview",e,t)}},2233:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentTextPreviewRequest:#Exchange"},e)}},2290:function(e,t,n){"use strict";var r=n(0);function a(e,t,n,a,i,o,c,u){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:t,searchScope:n,pillSuggestions:Object(r.__spread)(a.values()),includeAttachments:o,fromDate:c,toDate:u,scenarioType:"mail",lastIndexFetched:0}}function i(e){var t=e;return 1==e.type?t.scenarioType:void 0}var o=n(732),c=n(740),u=n(737),s=n(754);function d(e){var t=e;return Object(c.y)(t.folderId)?Object(s.e)(t.searchScope,Object(s.c)({folderId:Object(u.a)(o.b),kind:"ArchiveMailbox"})):Object(s.e)(t.searchScope,Object(s.Q)({folderId:Object(u.a)(o.i),kind:"PrimaryMailbox"}))}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return d})},2326:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",function(e,t,n){return{conversationIds:e,flagType:t,tableViewId:n}})},2414:function(e){e.exports={a:"rjb"}},2779:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SaveAttachmentsToCloudRequest:#Exchange"},e)}},2782:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),a=n(2143);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("FetchDataProviderResource",e,t)}},298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"TokenRequest:#Exchange"},e)}},3112:function(e){e.exports={a:"vtb"}},3137:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}},3138:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}},3139:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}},3140:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FileAttachment:#Exchange"},e)}},3141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}},3206:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),a=n(3207);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("ImportCalendarEvent",e,t)}},3207:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ImportCalendarEventJsonRequest:#Exchange"},e)}},3208:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ImportCalendarEventRequest:#Exchange"},e)}},3246:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(0),a=n(151),i=n(65),o=n(2143),c=n.n(o),u=n(2782),s=n.n(u),d=n(62);function l(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,function(){var u,l,f,v,b,m,h,p,w,g,O,S;return Object(r.__generator)(this,function(r){switch(r.label){case 0:u=new a.a("getWacInfoForOneDriveJsApi"),o&&u.addCustomData({redeemSharingLinkIfNecessary:o}),r.label=1;case 1:return r.trys.push([1,3,,4]),l=btoa(t),f="u!"+l.replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),v=new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0],Object(i.f)("doc-SxS-jsApi-ODB-Readonly")&&(n=!1),b=v+"_api/v2.0/shares/"+f+"/root?select=openWith/wac,officeBundle,@content.downloadUrl,name,size,currentUserRole&action="+(n?"Open":"View"),m=new Object,o&&(m.prefer="redeemSharingLinkIfNecessary"),h=c()({ProviderType:e,Url:b,Headers:JSON.stringify(m)}),p=(new Date).getTime(),[4,s()(h)];case 2:if(200===(w=r.sent()).Status&&w.Body)return g=(new Date).getTime(),(O=JSON.parse(w.Body)).fetchStartTime=p,O.responseStartTime=g,O.openWith.wac.fileGetUrl=O["@content.downloadUrl"],O.openWith.wac.accessTokenExpiry&&(O.openWith.wac.accessTokenExpiry=new Date(Number(O.openWith.wac.accessTokenExpiry))),!n&&O.currentUserRole&&(O.currentUserRole.readOnly=!0),u.end(),[2,O];throw u.addCustomData({StatusCode:w.Status}),new Error("Result status is: "+w.Status+" or empty response body.");case 3:return S=r.sent(),u.endWithError("ServerError",S),d.d.warn("Something went wrong while calling fetchDataProviderResourceOperation: "+S),[3,4];case 4:return[2,null]}})})}},339:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),a=n(298);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAccessTokenforResource",e,t)}},3539:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),a=n(2779);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=a.default(e.requestObject)),r.makeServiceRequest("SaveAttachmentsToCloud",e,t)}},3904:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),a=n(3137);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=a.default(e.requestObject)),r.makeServiceRequest("ConvertLocalToRefAttachment",e,t)}},3905:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),a=n(3138);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("CancelConvertLocalToRefAttachment",e,t)}},3906:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),a=n(3139);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=a.default(e.requestObject)),r.makeServiceRequest("ConvertRefToLocalAttachment",e,t)}},3907:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),a=n(3141);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("CancelConvertRefToLocalAttachment",e,t)}},3912:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(4140),a=n(4508),i=n(2414),o=n(5);function c(e){switch(e){case 2:return Object(o.a)(a.d);case 3:return Object(o.a)(a.e);case 5:return Object(o.a)(a.c);case 6:return Object(o.a)(r.a);case 7:return Object(o.a)(a.g);case 4:return Object(o.a)(a.f);case 10:return Object(o.a)(a.a);case 11:return Object(o.a)(a.b);default:return Object(o.a)(i.a)}}},3947:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SINGLE_EVENT_ICS=1]="SINGLE_EVENT_ICS",e[e.MULTIPLE_EVENT_ICS=2]="MULTIPLE_EVENT_ICS"}(r||(r={}))},4140:function(e){e.exports={a:"vmb"}},4508:function(e){e.exports={d:"wmb",e:"xmb",c:"ymb",g:"zmb",f:"Amb",a:"Bmb",b:"Cmb"}},4743:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(4),i=Object(a.action)("initializeReadingPaneInSxS",function(e,t,n,r){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:r}}),o=Object(a.action)("initializeConversationReadingPaneInSxS",function(e,t,n,r){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:r}}),c=Object(a.action)("initializeItemReadingPaneInSxS",function(e,t){return{readingPaneStrategy:e,instrumentationContext:t}}),u=Object(a.action)("initializeReadingPaneInSxSByCopyingMailReadingPane",function(e,t,n){return{previewPaneSelectionSource:e,parentItemId:t,instrumentationContext:n}}),s=n(160),d=n(1318),l=n(888);Object(a.orchestrator)(o,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,t&&t.conversationId?l.G.readingPaneState&&l.G.readingPaneState.mode===l.g.ConversationReadingPane&&l.G.readingPaneState.conversationId&&l.G.readingPaneState.conversationId.Id===t.conversationId.Id?(a&&function(e){switch(e){case l.c.MailList:case l.c.ConversationAttachmentWell:return!0;case l.c.ReadingPane:case l.c.FilesHub:case l.c.PhotoHub:case l.c.GroupFilesHub:case l.c.ConsumerGroupFilesHub:case l.c.Deeplink:case l.c.FileSuggestion:case l.c.LinkSuggestion:case l.c.ComposeDocLink:case l.c.ReadingPaneDocLink:return!1;default:return Object(s.a)(e)}}(n)&&d.m.importAndExecute(a.Id),[2]):[4,d.f.importAndExecute(t.conversationId,i,t.conversationSubject,t.conversationCategories,t.itemIdToScrollTo)]:[2];case 1:return r.sent(),[4,l.y.import()];case 2:return r.sent()({mode:l.g.ConversationReadingPane,conversationId:t.conversationId,conversationCategories:t.conversationCategories,conversationSubject:t.conversationSubject}),a&&d.m.importAndExecute(a.Id),[2]}})})}),Object(a.orchestrator)(c,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.instrumentationContext,t&&t.itemId?l.G.readingPaneState&&l.G.readingPaneState.mode===l.g.ItemReadingPane&&l.G.readingPaneState.itemId&&l.G.readingPaneState.itemId.Id===t.itemId.Id?[2]:[4,l.y.import()]:[2];case 1:return a=r.sent(),[4,d.h.import()];case 2:return[4,r.sent()(t.itemId,n,function(e){a({mode:l.g.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:e})})];case 3:return r.sent(),[2]}})})});var f=n(2269),v=n(889),b=n(972),m=n(731),h=n(838),p=n(1098),w=n(948),g=n(2290);Object(a.orchestrator)(u,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,i,u,s,d,O,S,y,I,P,_,j,C,T,A,E;return Object(r.__generator)(this,function(R){switch(R.label){case 0:return l.G.shouldShow&&(l.G.readingPaneState||l.G.composeId)?[2]:(t=e.previewPaneSelectionSource,n=e.parentItemId,a=e.instrumentationContext,i=m.O.tableViews.get(m.O.selectedTableViewId).tableQuery,u=Object(m.J)(i)||Object(g.c)(i),s=Object(w.c)(),(d=Object(b.e)())?Object(p.a)()&&window.opener?[2]:d.composeId!==v.a.primaryComposeId?[3,3]:[4,b.p.import()]:[3,7]);case 1:return[4,R.sent()(d,!0,!0)];case 2:R.sent(),s=Object(w.c)(),R.label=3;case 3:return[4,w.g.import()];case 4:return[4,R.sent()(s,!0)];case 5:return R.sent(),[4,l.z.import()];case 6:return R.sent()(d),[2];case 7:if(O=h.a.conversationReadingPaneViewState,S=h.a.deeplinkId)c({method:f.a.LoadItemReadingPane,itemId:{mailboxInfo:S.mailboxInfo,Id:S.id}},a);else if(s&&s.type===w.a.SecondaryReadingPane)switch((y=s.data).listViewType){case 0:o({method:f.a.LoadConversationReadingPane,conversationId:y.id,conversationSubject:y.subject,conversationCategories:y.categories},t,n,a);break;case 1:c({method:f.a.LoadItemReadingPane,itemId:y.id},a)}else if(O&&Object(b.c)(O.conversationId.Id))o({method:f.a.LoadConversationReadingPane,conversationId:O.conversationId,conversationSubject:O.conversationSubject,conversationCategories:O.conversationCategories},t,n,a);else if(I=Object(m.B)(),P=I&&Object(r.__spread)(I.selectedRowKeys.keys()),_=null===(E=I)||void 0===E?void 0:E.isInVirtualSelectAllMode,j=m.O.expandedConversationViewState.selectedNodeIds.length,1==P.length&&j<=1&&!_&&!u)switch(C=m.b.getRowClientItemId(P[0],I),I&&I.tableQuery.listViewType){case 0:T=m.b.getSubject(P[0],I),A=m.b.getCategories(P[0],I),o({method:f.a.LoadConversationReadingPane,conversationId:C,conversationSubject:T,conversationCategories:A},t,n,a);break;case 1:c({method:f.a.LoadItemReadingPane,itemId:C},a)}return[2]}})})}),Object(a.orchestrator)(i,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,!t)return[2];switch(t.method){case f.a.NoOp:return[3,1];case f.a.AlwaysHidden:return[3,2];case f.a.CopyMailReadingPaneContainer:return[3,4];case f.a.LoadConversationReadingPane:return[3,5];case f.a.LoadItemReadingPane:return[3,6]}return[3,7];case 1:return[2];case 2:return[4,l.y.import()];case 3:return r.sent()(null),[2];case 4:return u(n,a,i),[2];case 5:return o(t,n,a,i),[2];case 6:return c(t,i),[2];case 7:return[2]}})})});var O=n(151),S=n(894),y=n(1097),I=n(823),P=n(988),_=n(2703),j="download",C="open";function T(e){var t;return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=Object(_.a)(e.AttachLongPathName),[4,Object(P.l)(n)];case 1:return a=r.sent(),[2,(null===(t=a.result)||void 0===t?void 0:t.webContentLink)&&(i=a.result.webContentLink,i.lastIndexOf(j,i.length-j.length)>-1)?A(a.result.webContentLink):null]}var i})})}function A(e){return e.slice(0,-j.length)+C}var E=n(1009),R=n(971),x=n(7107),D=n(1160),M=n(3246),k=n(6146),F=n(65),N=n(762),U=n(6148),L=n(5),V=n(2414),B=n(4140),W=n(3112),G=n(740),q=n(6265),z=n(1075),H=n(62);function J(e){switch(e){case S.b.Unsupported:return"Unsupported";case S.b.Image:return"Image";case S.b.MailItem:return"MailItem";case S.b.CalendarEvent:return"CalendarEvent";case S.b.Wac:return"Wac";case S.b.SuiteExtensions:return"SuiteExtensions";case S.b.Audio:return"Audio";case S.b.Text:return"Text";case S.b.NativeView:return"NativeView";case S.b.GoogleDoc:return"GoogleDoc";case S.b.PdfJs:return"PdfJs";case S.b.ItemAttachment:return"ItemAttachment";case S.b.Video:return"Video";default:return Object(s.a)(e)}}var Y="/owa/{0}/service.svc/s/GetAttachmentPdfPreview?id={1}";function $(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=Object(L.b)(Y,e,encodeURIComponent(t)),[4,fetch(n,{credentials:"same-origin"})];case 1:return[2,r.sent()]}})})}function X(e){var t;return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,c,u,s,d,l,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,$(null===(t=e.mailboxInfo)||void 0===t?void 0:t.routingKey,e.Id)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:for(a=r.sent(),i=a.replace(/\s/gi,""),o=atob(i),c=o.length,u=new Uint8Array(new ArrayBuffer(c)),s=0;s<c;s++)u[s]=o.charCodeAt(s);return d=n.headers.get("PrintAllowed"),l=n.headers.get("CopyAllowed"),f=n.headers.get("ExportAllowed"),[2,{data:u,printAllowed:!d||"true"===d.toLowerCase(),copyAllowed:!l||"true"===l.toLowerCase(),exportAllowed:!f||"true"===f.toLowerCase()}];case 3:throw n.statusText}})})}var K=n(2331);function Q(e){var t=new Error(e);throw t.isUserError=!0,t}function Z(e){if(null!=e&&e.isUserError)return!0;return!1}var ee=n(11462),te=n(2454),ne=[".odp",".pot",".potm",".potx",".pps",".ppsm",".ppsx",".ppt",".pptm",".pptx"];function re(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,b.o.import()];case 1:return t.sent()(e.Id,3),[2]}})})}function ae(e,t,n,a,o,c,u,s,d){return void 0===d&&(d=l.e.Mail),Object(r.__awaiter)(this,void 0,void 0,function(){function f(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return c?[3,1]:(n=null,[3,3]);case 1:return[4,c()];case 2:n=r.sent(),r.label=3;case 3:return t=n,_(),A.setImagePreviewState(ae,ce.previewImage.url,t,le),[4,I.k.import()];case 4:return[4,r.sent()(e.attachmentId,e.isReadOnly)];case 5:return r.sent(),_(),A.setImagePreviewState(ae,oe(e.attachmentId).previewImage.url,t,le),[2]}})})}function v(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return t=ce.model.ProviderType,Object(y.b)(e.isCloudy,t,ce.model.Name)&&t===I.a.providers.ONE_DRIVE_PRO?[4,m()]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,b()];case 3:n.sent(),n.label=4;case 4:return[2]}})})}function b(){var t;return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i,c,u,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),n=!1,[4,Object(k.a)(e.attachmentId,n,l.c[o])];case 1:return a=r.sent(),ce.model.Name&&(i=ce.model.Name.lastIndexOf("."))>=0&&(c=ce.model.Name.substr(i).toLowerCase(),le.useHighContrastCommandBar=ne.indexOf(c)>=0),_(),A.setWacPreviewState(ae,a.wacUrl,null,a.token,j.getTime(),!n,le),[3,3];case 2:if(u=r.sent(),null===(t=s=u)||void 0===t?void 0:t.errorMessage)throw H.d.warn("Something went wrong while getting the attachment state: "+s),A.setPreviewError(ae,s.errorMessage),s.error;throw u;case 3:return[2]}})})}function m(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,a,i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),he.addCustomData({useJsApi:"true"}),null==(e=ce.openUrl))throw new Error("openUrl is null");return t=ce.model.Name,n=t&&t.substring(t.lastIndexOf(".")),a=".xls"!==n,[4,Object(M.a)(0,e,a,!0)];case 1:if(!(i=r.sent()))throw new Error("Vroom API call failed");return _(),A.setWacPreviewState(ae,i.openWith.wac.applicationUrl,{bootScriptUrl:i.openWith.wac.bootstrapperUrl,wopiSrcUrl:i.openWith.wac.wopiSrc,accessToken:i.openWith.wac.accessToken,accessTokenExpiry:i.openWith.wac.accessTokenExpiry,fileSize:ce.model.Size,fileGetUrl:i.openWith.wac.fileGetUrl,bundleInfo:i.officeBundle,fetchStartTime:i.fetchStartTime,responseStartTime:i.responseStartTime,openUrl:e},null,j.getTime(),i.currentUserRole.readOnly,le),[3,3];case 2:throw o=r.sent(),H.d.warn("Something went wrong while getting the attachment state: "+o.message),A.setPreviewError(ae,Object(L.a)(V.a)),o;case 3:return[2]}})})}function h(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return Object(E.b)(ce.model)&&ce.model.ProviderType===I.a.providers.GDRIVE?[4,p()]:[3,2];case 1:return n.sent(),[3,3];case 2:t=Object(D.a)(e.attachmentId,ce.model,3,Object(E.b)(ce.model),e.isReadOnly),A.setNativePdfPreviewState(ae,ce.download.url+"&isDocumentPreview=True#toolbar=0",t,"application/pdf",le),n.label=3;case 3:return[2]}})})}function p(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,T(ce.model)];case 2:return(t=r.sent())?(_(),A.setNativePdfPreviewState(ae,t,null,"application/pdf",le),[2]):[3,4];case 3:return n=r.sent(),e=n,[3,4];case 4:throw _(),A.setPreviewError(ae,Object(L.a)(B.a)),e||new Error("Unexpected error in handleNativeViewPreviewForGDrive")}})})}function w(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=ce.info.allowDownload,n=Object(R.g)(ce.model,!0),t&&n.directFileAccessEnabled&&!ve?(A.setPdfJsPreviewState(ae,ce.download.url+"&isDocumentPreview=True",!1,le),[3,3]):[3,1];case 1:return[4,X(e.attachmentId)];case 2:a=r.sent(),_(),A.setPdfJsPreviewStateByData(ae,a.data,!t&&!Object(R.k)().printWithoutDownloadEnabled||!a.printAllowed,a.copyAllowed,a.exportAllowed,le),r.label=3;case 3:return[2]}})})}function g(){var t,n;return Object(r.__awaiter)(this,void 0,void 0,function(){var a,i,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(x.a)(e.attachmentId.Id,null===(t=e.attachmentId.mailboxInfo)||void 0===t?void 0:t.requestOptions,0,l.c[o])];case 1:return a=r.sent(),_(),A.setTextPreviewState(ae,a,le),[3,3];case 2:if(i=r.sent(),null===(n=c=i)||void 0===n?void 0:n.errorMessage)throw _(),A.setPreviewError(ae,c.errorMessage),c.error;throw i;case 3:return[2]}})})}function P(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t={calendarItem:null,isIcsAttachmentLoading:!0,icsCalendarEventType:q.a.UNKNOWN,attachmentId:e.attachmentId,addToCalendarStatus:1,errorMessage:null},[4,q.d.import()];case 1:return n=r.sent(),a=null,[4,n({attachmentId:e.attachmentId,size:ce.model.Size,showSizeLimitExceedsError:function(){a=Object(L.a)(ee.a)},errorCallback:function(){a=Object(L.a)(W.a)},state:t})];case 2:if(r.sent(),_(),a)throw A.setPreviewError(ae,a),new Error(a);return C.onShowCustomPreview(t),A.setCustomPreviewState(ae,le),[2]}})})}function _(){l.G.pendingPreviewOperation&&ge.id===l.G.pendingPreviewOperation.id||Q("Preview changed before loading finished")}var j,C,A,Y,$,ae,oe,ce,ue,se,de,le,fe,ve,be,me,he,pe,we,ge,Oe,Se,ye;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return j=new Date,[4,l.C.import()];case 1:return C=r.sent(),K.a.available()?(K.a.run(),[4,z.t.import()]):(C.openSxSInANewWindow(t,e.attachmentId.Id,null),[2]);case 2:return A=r.sent(),Y=C.onPreviewOperationStart,$=C.onPreviewOperationFinished,ae=l.G.viewState,[4,I.i.import()];case 3:oe=r.sent(),ce=oe(e.attachmentId),ue=e.strategy,se=ue.isSaveToCloudSupported&&Object(L.g)(ce.model.AttachmentOriginalUrl),de=se?l.d.available:l.d.disabled,le={downloadUrl:ce.download.url,downloadShouldOpenNewTab:!1,fileName:ce.model.Name,useHighContrastCommandBar:!1,id:e.attachmentId},fe=ue.previewMethod,ve=!1,ue.previewMethod!==S.b.NativeView&&ue.previewMethod!==S.b.PdfJs||(be=G.H.items.get(t.Id))&&be.RightsManagementLicenseData&&(fe=S.b.PdfJs,ve=!0),me=function(e,t,n,r,a,i,o){var c,u,s,d=8!==e.attachmentClass&&9!==e.attachmentClass&&Object(N.c)(e.model.Name||"")||e.model.ContentType||"",f=new O.a("PreviewAttachmentInSxSE2E",{isQos:!0,timeout:ie}),v=Date.now();f.addCustomData({previewMethod:J(t),isCloudy:n?"cloudy":"classic",isChangingFromEditing:r?"changingFromEdit":"",officeFileType:Object(U.a)(d),actionSource:l.c[a],attachmentFileType:i,isRepeat:o,downloadAllowed:!!e.download.url});var b="";Object(F.f)("doc-SxS-jsApi-ODB-Base")&&(b+="doc-SxS-jsApi-ODB-Base;");Object(F.f)("doc-SxS-jsApi-ODB-BaseNoEditString")&&(b+="doc-SxS-jsApi-ODB-BaseNoEditString;");Object(F.f)("doc-SxS-jsApi-ODB-Readonly")&&(b+="doc-SxS-jsApi-ODB-Readonly;");Object(F.f)("doc-SxS-jsApi-ODB-Basecf")&&(b+="doc-SxS-jsApi-ODB-Basecf;");return f.addCustomData({associatedFlights:b}),f.addCosmosOnlyData(JSON.stringify({attachmentId:null===(u=null===(c=e)||void 0===c?void 0:c.id)||void 0===u?void 0:u.Id,fileType:(null===(s=d)||void 0===s?void 0:s.substring(0,4))||"",fileSize:e.model.Size})),{perfDatapoint:f,perfDatapointCreatedTime:v}}(ce,fe,e.isCloudy,l.G.editState.mode!==l.b.View,o,e.fileType,C.repeatTracker.contains(e.attachmentId.Id)),he=me.perfDatapoint,pe=me.perfDatapointCreatedTime,we=function(){he.addCustomData({autoHide:!0})},ae.eventManager.on(z.a,we),ge={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.attachmentId},Y(ge),r.label=4;case 4:return r.trys.push([4,27,28,29]),[4,C.canCloseSxS()];case 5:switch(r.sent()||he.addCustomData({exitEditMode:"notSaved"}),_(),i(u,o,t,s),A.setPreviewLoading(ae,"",le),C.showSxS(l.G.shouldShow?null:d,{previewMode:fe,attachmentId:e.attachmentId,selectionSource:o,isCloudy:e.isCloudy,saveToCloudStatus:de,textPreviewReadMode:0},{editAllowed:ue.allowEdit,itemId:t,isDraft:n},null),Object(l.E)(null),fe){case S.b.Image:return[3,6];case S.b.Wac:return[3,8];case S.b.GoogleDoc:return[3,10];case S.b.NativeView:return[3,11];case S.b.PdfJs:return[3,13];case S.b.Audio:return[3,15];case S.b.Video:return[3,16];case S.b.Text:return[3,17];case S.b.ItemAttachment:return[3,19];case S.b.CalendarEvent:return[3,20]}return[3,22];case 6:return[4,f()];case 7:return r.sent(),[3,23];case 8:return[4,v()];case 9:return r.sent(),[3,23];case 10:return A.setIframePreviewState(ae,ce.model.AttachLongPathName,le),[3,23];case 11:return[4,h()];case 12:return r.sent(),[3,23];case 13:return[4,w()];case 14:return r.sent(),[3,23];case 15:return A.setAudioPreviewState(ae,ce.download.url,le),[3,23];case 16:return A.setVideoPreviewState(ae,ce.download.url,le),[3,23];case 17:return[4,g()];case 18:return r.sent(),[3,23];case 19:return Object(te.a)(e.attachmentId,null),A.setCustomPreviewState(ae,le),[3,23];case 20:return[4,P()];case 21:return r.sent(),[3,23];case 22:throw new Error("Unsupported preview method");case 23:return[4,C.waitForPreviewLoadOrThrowError()];case 24:return Oe=r.sent(),_(),$(),a?[4,l.q.import()]:[3,26];case 25:r.sent()(re),r.label=26;case 26:return Oe?(Se=Oe-pe,he.end(Se)):he.end(),C.repeatTracker.add(e.attachmentId.Id),[3,29];case 27:return ye=r.sent(),he.endWithError(Z(ye)?"UserError":"ServerError",ye),[3,29];case 28:return ae.eventManager.off(z.a,we),[7];case 29:return[2]}})})}var ie=18e4;var oe=n(799),ce=n(1360);function ue(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return(t=e.viewState&&Object(oe.a)(e.viewState.attachmentId))&&Object(I.e)(t.model)?[4,ce.n.import()]:[3,2];case 1:return n.sent()(t.model,e.parentItemId),[2];case 2:return e.onBeforePreview&&e.onBeforePreview(),[4,ae(e.viewState,e.parentItemId,e.isDraft,!1,e.previewPaneSelectionSource,e.createImageGallery,{method:f.a.CopyMailReadingPaneContainer},e.instrumentationContext)];case 3:return n.sent(),[2]}})})}var se=n(5586);function de(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,function(){var o,c,u,s,d,v,b,m;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return K.a.run(),[4,l.x.import()];case 1:return o=r.sent(),[4,l.w.import()];case 2:return c=r.sent(),u=null,a instanceof HTMLElement?[4,se.b.import()]:[3,4];case 3:return s=r.sent(),u=s(a),[3,5];case 4:u=a,r.label=5;case 5:u||(u=l.G.viewState),d={downloadUrl:e.downloadUrl,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:e.id},v={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.id},o(v),r.label=6;case 6:return r.trys.push([6,9,,10]),[4,l.B.import()];case 7:return b=r.sent(),[4,z.j.import()];case 8:return m=r.sent(),l.G.pendingPreviewOperation&&v.id===l.G.pendingPreviewOperation.id||Q("Preview changed before loading finished"),i({method:f.a.CopyMailReadingPaneContainer},l.c.ReadingPane,null,null),m(u,e.previewUrl,t,d),b(l.G.shouldShow?null:l.e.Mail,{previewMode:S.b.Image,attachmentId:e.id,selectionSource:l.c.ReadingPane,isCloudy:!1,saveToCloudStatus:l.d.disabled,textPreviewReadMode:0},{editAllowed:!1,itemId:n,isDraft:!1},null),Object(l.E)(null),c(),[3,10];case 9:return r.sent(),[3,10];case 10:return[2]}})})}function le(e,t,n,a,o,c,u,s){var d;return void 0===s&&(s=l.e.Mail),Object(r.__awaiter)(this,void 0,void 0,function(){function f(){l.G.pendingPreviewOperation&&P.id===l.G.pendingPreviewOperation.id||Q("Preview changed before loading finished")}var v,b,m,h,p,w,g,y,I,P,_,j,C,T;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return K.a.run(),v=e(),[4,z.t.import()];case 1:return b=r.sent(),[4,l.C.import()];case 2:m=r.sent(),h=m.onPreviewOperationStart,p=m.onPreviewOperationFinished,w=l.G.viewState,g={downloadUrl:null,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:null,fileName:null},y=function(e,t){var n=new O.a("PreviewLinkInSxSE2E");return n.addCustomData({previewMethod:J(e),actionSource:l.c[t]}),n}(S.b.Wac,n),I=function(){y.addCustomData({autoHide:!0})},w.eventManager.on(z.a,I),P={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:null},h(P),r.label=3;case 3:return r.trys.push([3,10,11,12]),[4,m.canCloseSxS()];case 4:r.sent(),f(),i(a,n,t,o),b.setPreviewLoading(w,"",g),m.showSxS(l.G.shouldShow?null:s,{previewMode:S.b.Wac,attachmentId:null,selectionSource:n,isCloudy:!0,saveToCloudStatus:l.d.disabled,textPreviewReadMode:0},{editAllowed:!1,itemId:t,isDraft:!1},c),Object(l.E)(c,u),r.label=5;case 5:return r.trys.push([5,7,,8]),[4,v];case 6:return _=r.sent(),f(),_.jsApiInfo&&(g.fileName=_.jsApiInfo.fileName,function(e,t){var n,r=Object(N.c)(t);e.addCustomData({useJsApi:"true",officeFileType:Object(U.a)(r)}),e.addCosmosOnlyData(JSON.stringify({fileType:(null===(n=r)||void 0===n?void 0:n.substring(0,4))||""}))}(y,_.jsApiInfo.fileName)),b.setWacPreviewState(w,_.wacUrl,_.jsApiInfo,_.token,(new Date).getTime(),u,g),[3,8];case 7:throw j=r.sent(),(null===(d=C=j)||void 0===d?void 0:d.errorMessage)?(b.setPreviewError(w,C.errorMessage),C.error):(b.setPreviewError(w,j.message||""+j),j);case 8:return[4,m.waitForPreviewLoadOrThrowError()];case 9:return r.sent(),f(),p(),y.end(),[3,12];case 10:return T=r.sent(),y.endWithError(Z(T)?"UserError":"ServerError",T),[3,12];case 11:return w.eventManager.off(z.a,I),[7];case 12:return[2]}})})}n.d(t,"previewAttachment",function(){return ue}),n.d(t,"previewAttachmentInSxS",function(){return ae}),n.d(t,"previewImageInSxS",function(){return de}),n.d(t,"previewLinkInSxS",function(){return le})},5586:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(52),a=new r.c(function(){return Promise.all([n.e(79),n.e(628),n.e(4),n.e(12),n.e(471)]).then(n.bind(null,8335))}),i=new r.b(a,function(e){return e.getSxSViewStateFromElement}),o=Object(r.d)(a,function(e){return e.SxSLayerView});Object(r.d)(a,function(e){return e.SxSView})},6146:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),a=n(2414),i=n(5),o=n(3912),c=n(3243);function u(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var u,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(c.a)(e,t,n,!0)];case 1:return u=r.sent(),[3,3];case 2:throw s=r.sent(),{errorMessage:Object(i.a)(a.a),error:s};case 3:if(0===u.Status)return[2,{wacUrl:u.WacUrl,bootScriptUrl:u.BootScriptUrl,wopiSrcUrl:u.WopiSrcUrl,accessToken:u.AccessToken,token:u.Token}];throw{errorMessage:Object(o.a)(u.Status),error:new Error("GetWacAttachmentInfo failed with status: "+u.Status)}}})})}},6148:function(e,t,n){"use strict";function r(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",function(){return r})},6265:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return u});var r=n(52),a=n(3947);n.d(t,"a",function(){return a.a});var i=new r.c(function(){return Promise.all([n.e(3),n.e(8),n.e(596),n.e(18),n.e(296)]).then(n.bind(null,9295))}),o=new r.b(i,function(e){return e.addToCalendar}),c=(new r.b(i,function(e){return e.getIcsCalendarItem}),new r.b(i,function(e){return e.getIcsCalendarItemOrchestrator})),u=Object(r.d)(i,function(e){return e.IcsPreview})},7107:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),a=n(2232),i=n.n(a),o=n(62);function c(e,t,n,a){var c;return Object(r.__awaiter)(this,void 0,void 0,function(){var u,s,d,l,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:u={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."},r.label=1;case 1:return r.trys.push([1,3,,4]),a&&(s="getAttachmentTextPreview"+a,(t=t||{}).headers=t.headers||new Headers,t.headers.set("X-OWA-ActionName",s)),[4,i()({AttachmentId:e,ReadMode:n},t)];case 2:if((d=r.sent())&&0===d.Status)return[2,d.Content];switch(l=(null===(c=d)||void 0===c?void 0:c.Status)||1){case 2:u.errorMessage="The attachment has been moved or deleted.";break;case 3:u.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:u.errorMessage="Something went wrong while the document preview was being created. Please try again later."}return u.error=new Error("getAttachmentTextPreview failed with status: "+l),[3,4];case 3:return f=r.sent(),o.d.warn("getAttachmentTextPreview failed with error: "+f),u.error=f,[3,4];case 4:throw u}})})}},770:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub"}(r||(r={}))},809:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"h",function(){return c}),n.d(t,"g",function(){return u}),n.d(t,"f",function(){return s}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return f});var r=n(0),a=n(904),i="deeplink",o="compose",c="reply",u="replyall",s="read",d="group",l="/"+Object(r.__spread)(["mail"],Object(a.a)().split("/").slice(1)).join("/")+i+"/",f="/"+Object(r.__spread)(["calendar"],Object(a.a)().split("/").slice(1)).join("/")+i+"/"},814:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c});var r=n(821),a=n(4),i={tabs:[{id:"primaryTab",type:r.a.Primary,isShown:!0,isActive:!0,blink:!1}],tabBarWidth:0,isOverflowMenuShown:!1},o=Object(a.createStore)("tab",i),c=(o(),o().tabs[0])},820:function(e,t,n){"use strict";var r=n(809),a=n(50),i=n(832),o=n(39);function c(e,t){if(t){var n=t.displayName?t.displayName+"<"+t.smtpAddress+">":t.smtpAddress;return e?"&"+e+"="+n:n}return""}function u(e,t){return t?"&"+e+"="+t:""}function s(e){var t;if(!(null===(t=e.to)||void 0===t?void 0:t.smtpAddress))return"";var n=o.parse(Object(a.a)().search.substr(1));return n.mailtouri=function(e){var t;if(!(null===(t=e.to)||void 0===t?void 0:t.smtpAddress))return"";var n="mailto:"+c(null,e.to),r="";return r+=c("cc",e.cc),r+=c("bcc",e.bcc),r+=u("subject",e.subject),(r+=u("body",e.body))?n+"?"+r.slice(1):n}(e),Object(i.a)(r.e,r.b,"?"+o.stringify(n))}n.d(t,"a",function(){return s})},821:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.Compose=3]="Compose",e[e.FloatingChat=4]="FloatingChat"}(r||(r={}))},832:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(248);function a(e,t,n){var a={pathname:e+t,search:n};return r.format(a)}},838:function(e,t,n){"use strict";n.d(t,"b",function(){return i});var r=n(1089),a=n(4),i=Object(a.createStore)("readingpane",{conversationReadingPaneViewState:null,itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null}),o=i();r.a.registerReference(function(){return o.conversationReadingPaneViewState&&o.conversationReadingPaneViewState.conversationId.Id}),t.a=o},846:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(809),a=n(50),i=n(832);function o(e){return e?Object(i.a)(r.e,r.f+"/"+encodeURIComponent(e),Object(a.a)().search):""}},889:function(e,t,n){"use strict";var r=n(21),a=n(4),i={viewStates:new r.ObservableMap,primaryComposeId:null,complianceConfigurations:new r.ObservableMap,messageClassifications:new r.ObservableMap,newMessageCreationInProgress:!1},o=Object(a.createStore)("compose",i),c=o();n.d(t,"a",function(){return c}),n.d(t,"b",function(){return o})},909:function(e,t,n){"use strict";var r=n(52),a=n(1002),i={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"g",function(){return c}),n.d(t,"h",function(){return u}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"f",function(){return l}),n.d(t,"e",function(){return f}),n.d(t,"d",function(){return v}),n.d(t,"a",function(){return i});var o=new r.c(function(){return Promise.all([n.e(609),n.e(370)]).then(n.bind(null,14106))}),c=new r.a(o,function(e){return e.subscribe}),u=new r.a(o,function(e){return e.unsubscribe}),s=new r.b(o,function(e){return e.getChannelId}),d=new r.b(o,function(e){return e.getChannelReady}),l=new r.a(o,function(e){return e.setup}),f=new r.a(o,function(e){return e.initializeNotificationManager}),v=new r.b(o,function(e){return e.getNotificationEmitter});a.a},919:function(e,t,n){"use strict";var r=n(770),a={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function i(e){switch(e?e.toLowerCase():null){case a.ONE_DRIVE_PRO.toLowerCase():return 0;case a.GDRIVE.toLowerCase():return 5;case a.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case a.DROPBOX.toLowerCase():return 2;case a.BOX.toLowerCase():return 3;case a.WOPI_BOX.toLowerCase():return 7;case a.WOPI_EGNYTE.toLowerCase():return 8;case a.MAILBOX.toLowerCase():return 4;case a.FACEBOOK.toLowerCase():return 6;default:return null}}function o(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function c(e){return null==e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function u(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var a=e[n],i={fileType:r.a.Local,name:a.name,size:a.size,type:a.type,fileObject:a};t.push(i)}return t}function s(e,t,n){var a=[],i={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return a.push(i),a}var d=n(62);function l(e,t,n){var a;if(e.length!=t.length)return d.d.error("The sizes of subjects and latestItemIds are different"),null;for(var i=[],o=0;o<e.length;o++){var c={fileType:r.a.MailItem,name:e[o],size:(null===(a=n)||void 0===a?void 0:a[o])||0,itemId:t[o]};i.push(c)}return i}var f=n(762);function v(e){return e.map(function(e){return{fileType:r.a.Uri,name:e.name,type:Object(f.b)(e.url),size:0,uri:e.url}})}n.d(t,"b",function(){return i}),n.d(t,"e",function(){return u}),n.d(t,"g",function(){return l}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"h",function(){return v}),n.d(t,"f",function(){return s}),n.d(t,"a",function(){return r.a})},948:function(e,t,n){"use strict";var r=n(1197),a=n(821),i=n(0),o=n(814);function c(e){var t,n,r=Object(o.a)();try{for(var c=Object(i.__values)(r.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(s.type!==a.a.Primary&&s.data==e)return s}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return null}var u=n(1058),s=n(52),d=n(1157),l=n(1910),f=n(1285),v=n(4);Object(v.mutator)(f.a,function(e){var t,n;try{for(var r=Object(i.__values)(Object(o.a)().tabs),c=r.next();!c.done;c=r.next()){var u=c.value;if(u.type==a.a.FloatingChat&&u.data==e.chatConversationId)return void Object(d.a)(u,!0)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}Object(l.a)(a.a.FloatingChat,!0,!0,e.chatConversationId)});n(864);n.d(t,"e",function(){return m}),n.d(t,"f",function(){return h}),n.d(t,"g",function(){return p}),n.d(t,"h",function(){return w}),n.d(t,"a",function(){return a.a}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u.a}),n.d(t,"d",function(){return o.a}),n.d(t,"i",function(){return o.b}),n.d(t,"j",function(){return r.b});var b=new s.c(function(){return Promise.all([n.e(49),n.e(67),n.e(73),n.e(475)]).then(n.bind(null,14356))}),m=new s.a(b,function(e){return e.activateTab}),h=new s.a(b,function(e){return e.addTab}),p=new s.a(b,function(e){return e.closeTab}),w=new s.a(b,function(e){return e.setTabIsShown})},971:function(e,t,n){"use strict";var r;!function(e){e.InfoRestrictedAccess="infoRestrictedAccess"}(r||(r={}));var a=n(160);function i(e){switch(e){case 0:return r.InfoRestrictedAccess;default:return Object(a.a)(e)}}var o=n(40);function c(e){switch(e){case 0:return(t=Object(o.a)().AttachmentPolicy).ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked||t.ConditionalAccessPrintWithoutDownloadBlocked||t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked;default:return Object(a.a)(e)}var t}var u=[0],s=n(1543);function d(){return u.filter(c)}function l(e){return e&&e.length>0&&function(e){return e.some(function(e){return!((t=e).IsInline&&!function(e){return e.__type===s.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t})}(e)?u.filter(c):[]}var f=n(1755),v=n(5),b=n(827);function m(e){switch(e){case r.InfoRestrictedAccess:return{key:"access_control_info_bar",source:b.c.Compose,rank:b.b.Error,message:Object(v.a)(f.b),messageParts:[Object(v.a)(f.b),(t="https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done",{text:Object(v.a)(f.a),action:function(){window.open(t,"_blank")}})],color:b.a.Red};default:return Object(a.a)(e)}var t}var h,p=n(762);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.ConditionalAccess=4]="ConditionalAccess"}(h||(h={}));var w=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=h[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,r){e&&(e=e.toLowerCase());var a=this.getFileAccessLevel(e,t),i=!1,o=!1,c=!1,u="ReferenceAttachment:#Exchange"===r;return a!==h.Block&&n&&(this.isWacViewingEnabled(e)&&(i=!0),!this.directFileAccessEnabled&&u&&(i=!1),o=this.isForceBrowserViewingFirst(i),i&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(c="FileAttachment:#Exchange"===r?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),i||this.directFileAccessEnabled||(a=h.ConditionalAccess)),{directFileAccessEnabled:this.directFileAccessEnabled,level:a,useWac:i,forceBrowserViewingFirst:o,wacEdit:c}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=h.Undefined),n===h.Block)return h.Block;var r=this.mimeTypeToPolicyMap[t];return r===h.Block?h.Block:n===h.ForceSave||r===h.ForceSave?h.ForceSave:n===h.Allow||r===h.Allow?h.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach(function(t){e[t]=n})},e.prototype.createPolicyMap=function(e,t,n){var r={};return this.addPolicyIntoMap(r,n,h.Allow),this.addPolicyIntoMap(r,t,h.ForceSave),this.addPolicyIntoMap(r,e,h.Block),r},e}(),g=null,O=null;function S(){if(!g){var e=Object(o.a)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;g=new w(t,n),n&&(O=g)}return g}function y(e,t){var n=Object(p.b)(e.Name),r=e.ContentType;return S().getPolicyInfo(n,r,t,e.__type)}function I(e,t){var n=Object(p.b)(e.Name),r=e.ContentType;return function(){if(!O){var e=Object(o.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return S();O=new w(e.AttachmentPolicy,!0)}return O}().getPolicyInfo(n,r,t,e.__type)}function P(e,t,n,r){if(r)return!1;var a=y(e,!0),i=S();return a.level!==h.Block&&i.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"a",function(){return u}),n.d(t,"i",function(){return m}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"h",function(){return i}),n.d(t,"j",function(){return P}),n.d(t,"c",function(){return h}),n.d(t,"f",function(){return y}),n.d(t,"g",function(){return I}),n.d(t,"k",function(){return S})},972:function(e,t,n){"use strict";var r=n(1482),a=n(52),i=n(1017),o=n(1217),c=(n(1412),n(1323)),u=n(1191),s=n(889),d=n(948),l=n(62);function f(e,t,n){var r,a=Object(s.b)();if(e){switch(e.type){case d.a.SecondaryReadingPane:e.data.listViewType==n&&(r=Object(u.a)(t,n));break;case d.a.Compose:r=a.viewStates.get(e.data);break;case d.a.Primary:r=t?Object(u.a)(t,n,!0):null;break;default:r=null}return r}return l.d.error("There is no active tab. Something went very wrong."),null}var v=n(1413),b=n(4),m=Object(b.action)("onComposeAddinsInitialized",function(e,t){return{hostItemIndex:e,itemId:t}}),h=n(1485);function p(){var e=Object(d.c)(),t=Object(s.b)(),n=e?function(e,t){switch(e.type){case d.a.Primary:return t.primaryComposeId;case d.a.Compose:return e.data;default:return null}}(e,t):t.primaryComposeId,r=n?t.viewStates.get(n):null;return r&&!r.isInlineCompose?r:null}n.d(t,"u",function(){return g}),n.d(t,"m",function(){return O}),n.d(t,"h",function(){return S}),n.d(t,"k",function(){return y}),n.d(t,"o",function(){return I}),n.d(t,"r",function(){return P}),n.d(t,"y",function(){return _}),n.d(t,"x",function(){return j}),n.d(t,"p",function(){return C}),n.d(t,"s",function(){return T}),n.d(t,"w",function(){return A}),n.d(t,"t",function(){return E}),n.d(t,"q",function(){return R}),n.d(t,"j",function(){return x}),n.d(t,"n",function(){return D}),n.d(t,"l",function(){return M}),n.d(t,"v",function(){return k}),n.d(t,"i",function(){return F}),n.d(t,"d",function(){return i.c}),n.d(t,"a",function(){return i.b}),n.d(t,"g",function(){return o.b}),n.d(t,"f",function(){return c.a}),n.d(t,"c",function(){return u.a}),n.d(t,"b",function(){return f}),n.d(t,"z",function(){return v.a}),n.d(t,"B",function(){return m}),n.d(t,"C",function(){return h.a}),n.d(t,"e",function(){return p}),n.d(t,"A",function(){return r.a});var w=new a.c(function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(7),n.e(329)]).then(n.bind(null,13720))}),g=new a.a(w,function(e){return e.replyToMessage}),O=new a.a(w,function(e){return e.forwardMessage}),S=new a.a(w,function(e){return e.closeCompose}),y=new a.a(w,function(e){return e.discardCompose}),I=new a.a(w,function(e){return e.loadDraftToCompose}),P=new a.a(w,function(e){return e.openCompose}),_=new a.a(w,function(e){return e.trySendMessage}),j=new a.a(w,function(e){return e.trySaveAndCloseCompose}),C=new a.a(w,function(e){return e.moveComposeToTab}),T=new a.a(w,function(e){return e.recreateComposeFromViewState}),A=new a.a(w,function(e){return e.tryCreateResendDraft}),E=new a.a(w,function(e){return e.replyToApprovalMessage}),R=new a.a(w,function(e){return e.onEditDraftButtonClicked}),x=new a.b(w,function(e){return e.createReply}),D=new a.b(w,function(e){return e.getToCcRecipientsForReply}),M=new a.b(w,function(e){return e.findComposePlugins}),k=new a.b(w,function(e){return e.replyToMessageAndCreateViewState}),F=new a.b(w,function(e){return e.createAttachments});new a.b(w,function(e){return e.findComposeFromRecipientWell})}},0,[3,5,8,13,422,1,2,22,577,185,0,578,189,7,379,6,329,4,12,37,127,71,455,565,110,609,370,342,376,541]]);
//# sourceMappingURL=owa.AttachmentPreviewSxS.js.map
self.scriptsLoaded['owa.AttachmentPreviewSxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentPreviewSxS.js'] = (new Date()).getTime();