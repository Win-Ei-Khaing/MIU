self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[48],{1023:function(e,t,n){"use strict";var r=n(0),i=n(71),a=n(916),c=n(927),s=n(1085),o=n(4),u=Object(o.action)("resolvePendingPersonaOnRecipient",function(e,t,n){return{recipient:e,nextPersona:t,searchedString:n}});Object(o.mutator)(u,function(e){var t=e.recipient,n=e.nextPersona,r=e.searchedString;Object(a.a)(t.persona.EmailAddress)===r&&(t.isPendingResolution=!1,n&&(t.persona=n,t.isValid=!0,t.displayText=Object(s.a)(n.EmailAddress)))});var d=u,l=Object(o.action)("addRecipientsToRecipientWell",function(e,t){return{newRecipients:e,recipientWell:t}});t.a=l;Object(o.mutator)(l,function(e){var t,n=e.recipientWell;(t=n.recipients).splice.apply(t,Object(r.__spread)([n.recipients.length,0],e.newRecipients)),n.isDirty=!0}),Object(o.orchestrator)(l,function(e){var t=e.newRecipients,n=e.recipientWell;t.forEach(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return e.isPendingResolution?(t=Object(a.a)(e.persona.EmailAddress),(s=n.mailboxSmtpAddress)||(s=Object(i.j)()),[4,c.b.import().then(function(e){return e(s,t)})]):[2];case 1:return o=r.sent(),d(e,o,t),[2]}})})})})},1066:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=/^"?(.*?)"?\s*\(([^\(]*?)\)$/,i=/^"?(.*?)"?\s*<([^<]*?)>$/,a=/^"?(.*?)"?\s*\[([^\[]*?)\]$/,c=/^"?(.*?)"?\s*{([^\{]*?)}$/;function s(e){if("string"!=typeof e)return e;var t=e.trim(),n=t.match(r)||t.match(i)||t.match(a)||t.match(c);return n?n[1].length?{displayName:n[1],address:n[2]}:{address:n[2]}:{address:t}}},1085:function(e,t,n){"use strict";var r=n(1192),i=n(916),a=n(245);var c=function(e,t){var n=t||e.Name;if(!n)return!0;var i,c,s=Object(r.a)(n),o=-1!==n.indexOf("@")&&n!=e.EmailAddress,u=!Object(a.a)()&&("ExternalMailbox"===e.MailboxType||"LinkedIn"===e.MailboxType),d=!("OneOff"!==e.MailboxType&&"Unknown"!==e.MailboxType||(i=n,c=e.EmailAddress,i==c||i&&c&&i.toLowerCase()==c.toLowerCase()));return e.EmailAddress&&(s||o||u&&!o||d)};t.a=function(e,t){var n=t||e.Name,a=!n||Object(r.a)(n);return c(e,t)?a?Object(i.a)(e):n+" <"+Object(i.a)(e)+">":n}},1095:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients&&void 0!==e.findResultSet}n.d(t,"a",function(){return r})},1105:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return o});var r=n(52),i=new r.c(function(){return Promise.all([n.e(7),n.e(621),n.e(420)]).then(n.bind(null,2799))}),a=Object(r.d)(i,function(e){return e.FeedbackFooter}),c=new r.a(i,function(e){return e.removePendingRequestCorrelationId}),s=new r.a(i,function(e){return e.addPendingRequestCorrelationId}),o=new r.b(i,function(e){return e.showFeedbackDialog})},1106:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(808);function i(e){var t,n="";e&&(Object(r.a)()?(t=e).Groups&&t.Instrumentation&&(n=t.Instrumentation.TraceId):"Success"==(t=e).ResponseClass&&t.ResultSet&&(n=t.TransactionId));return n}},1110:function(e,t,n){"use strict";var r=n(0),i=n(1066),a=n(1273);var c=n(1200);function s(e){var t,n,s=Object(i.a)(e),o=Object(a.a)(s.address,s.displayName);if(null===o)return Object(r.__assign)(Object(r.__assign)({},c.a),{isValid:!1,isPendingResolution:!0,displayText:e,persona:{EmailAddress:(t=e,{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:t,Name:n||t})}});var u=Object(c.b)(o);return Object(r.__assign)(Object(r.__assign)({},u),{isPendingResolution:!0,persona:{EmailAddress:o}})}n.d(t,"a",function(){return s})},1116:function(e,t,n){"use strict";var r=n(69);t.a=Object(r.action)("setCommonWellItemSelectedState")(function(e,t){e.isSelected=t})},1117:function(e,t,n){"use strict";function r(e){var t=[];return e&&(t=e.map(function(e){return e.persona})),t}n.d(t,"a",function(){return r})},1178:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"d",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return f});var r=n(0),i=n(5),a=n(939),c=n(151),s=n(1545);function o(e,t,n,r){return l(f(e),t,n,r,function(t,n){Object(c.m)("RecipientCacheHitIndex",[Math.ceil(n/50),!Object(i.g)(e),t.sessionAdd])})}function u(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,s.b.import().then(function(r){return r(e,t,function(e){return b(n,e,i)})})];case 1:return[2,r.sent()]}})})}function d(e,t,n,r){return l(e,t,n,r)}function l(e,t,n,r,i){for(var c=[],s=0;c.length<t&&a.a.recipientCache&&s<a.a.recipientCache.length;){var o=a.a.recipientCache[s];if(e(o))b(n,o.EmailAddress,r)||(c.push(o),i&&i(o,s));s++}return c}function b(e,t,n){var r=!1;return e&&function(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}(t,e)&&(r=!0),n&&n.indexOf(t.MailboxType)>=0&&(r=!0),r}var f=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),i=0;i<r.length;i++)if(0==r[i].indexOf(e))return!0}return!1}}},1192:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=["\t","\n","\v","\f","\r"," ",""," "," "," "," "," "," "," "," "," "," "," "," "," ","\u2028","\u2029"," "," ","　","؜","​","‌","‍","‎","‏","\u2028","\u2029","‪","‫","‬","‭","‮"," ","⁠","⁦","⁧","⁨","⁩"],i=null,a=function(e){return null===i&&(i=new Set,r.forEach(function(e){return i.add(e)})),e.split("").every(function(e){return i.has(e)})}},1199:function(e,t,n){"use strict";n.d(t,"b",function(){return i});var r=n(4),i=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),a=i();t.a=a},1200:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return s});var r=n(0),i=n(1153),a=n(1085),c={isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:i.a.None,members:[]};function s(e,t){return Object(r.__assign)(Object(r.__assign)({},c),{isValid:!0,displayText:Object(a.a)(e,t)})}},1219:function(e,t,n){"use strict";var r=n(69);t.a=Object(r.action)("updateIsEditing")(function(e,t){e.isEditing=t})},1247:function(e,t,n){"use strict";var r=n(69);t.a=Object(r.action)("setForceResolveState")(function(e,t){e.inForceResolve=t})},1273:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),i=n(880);function a(e,t){if(Object(i.c)(e))return{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:e,Name:t||e};if(Object(i.b)(e)){var n=Object(r.__read)(e.split(":",2),2),a=n[0],c=n[1];return{MailboxType:"OneOff",RoutingType:a.toUpperCase(),EmailAddress:c,Name:t||c}}return null}},1308:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("onRecipientsChanged",function(e,t){return{recipientWellRecipients:e,recipientData:t}});t.a=i},1325:function(e,t,n){"use strict";var r=n(0),i=n(69),a=n(1656);t.a=Object(i.action)("processSubstrateSuggestionsResponse")(function(e,t,n,i,c){var s,o,u;if(!t||!t.Groups)throw new Error("Response groups should not be null");var d=[];i=i||20,i=n?i-e.length:i;var l=null===(u=t.Instrumentation)||void 0===u?void 0:u.TraceId;try{for(var b=Object(r.__values)(t.Groups),f=b.next();!f.done;f=b.next()){var p=f.value;if("People"===p.Type){p.Suggestions.forEach(function(e){if(d.length<i){var t=Object(a.a)(e,l,c);t&&d.push(t)}});break}}}catch(e){s={error:e}}finally{try{f&&!f.done&&(o=b.return)&&o.call(b)}finally{if(s)throw s.error}}n?e.push.apply(e,Object(r.__spread)(d)):e.splice.apply(e,Object(r.__spread)([0,e.length],d))})},1326:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("removePersonaFromWell",function(e,t,n){return void 0===n&&(n=!1),{targetRecipientWell:e,personaToRemove:t,shouldRemoveAllOccurrences:n}});t.a=i},1346:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(939);function i(){return null===r.a.recipientCache||0==r.a.recipientCache.length}},1348:function(e,t,n){"use strict";t.a={SearchPeopleIndex:{name:"SearchPeopleIndex"},AddRecipientFromFindControl:{name:"AddRecipientFromFindControl",customData:function(e,t){return{index:(e>23?23:e).toString(),source:t.toString()}}},SearchCacheFirst:{name:"SearchCacheFirst"}}},1352:function(e,t,n){"use strict";var r=n(5),i=n(896),a=n(954),c=n(7),s=n(104),o=n(62),u=n(69),d=n(319),l=Object(u.action)("localCacheTransactionCompleted")(function(e,t,n,u,l,b){var f;if(void 0===b&&(b=Object(c.Ob)()),null===(f=e)||void 0===f?void 0:f.hasSessionStarted){var p={TransactionRequestTime:Object(c.qb)(b),TransactionRequestDuration:Object(c.w)(Object(c.Ob)(),b),QueryString:Object(r.g)(t)?"":t,QueryStringLength:Object(s.b)(t)?0:t.length,FeatureData:null!=u?u:void 0,personaTypeList:l,ImpressionId:Object(d.a)(),Cvid:e.conversationId},O=JSON.stringify(p),j=JSON.stringify(n),v=Object(a.a)(e,"","LocalCacheTransactionCompleted",j,0,O);Object(i.a)(e,v,!1),o.d.info(Object(r.b)("{0} LocalCacheTransactionCompleted. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),b=n(1362);function f(e){if(e.findResultSet&&e.findResultSet.length>0){var t=[];e.findResultSet.forEach(function(e){t.push(b.a[e.PersonaTypeString])}),l(e.findPeopleFeedbackManager,e.queryString,(n=e.findResultSet,r=[],n&&n.forEach(function(e,t){r[t]=e.EmailAddress.EmailAddress}),r),null,t)}var n,r}n.d(t,"a",function(){return f})},1362:function(e,t,n){"use strict";t.a={Unknown:0,Person:1,DistributionList:2,ModernGroup:5,ImplicitGroup:10,ExplicitGroup:11,LinkedIn:12}},1446:function(e,t,n){"use strict";var r=n(0),i=n(1804),a=n(1247),c=n(1219),s=n(69),o=n(151);t.a=Object(s.action)("resolveAllUnresolvedRecipients")(function(e,t,n){var s,u;return Object(r.__awaiter)(this,void 0,void 0,function(){var d,l,b;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(a.a)(e,!0),e.queryString=e.queryString.trim(),e.recipients&&e.queryString?(null===(s=n)||void 0===s||s(),[4,Object(i.a)(e,!1,!0,!0)]):[3,2];case 1:return r.sent(),[3,3];case 2:for(d=-1,l=0;l<t.length;l++)if((null===(u=t[l].persona)||void 0===u?void 0:u.EmailAddress)&&!t[l].persona.EmailAddress.EmailAddress&&"PrivateDL"!=(b=t[l].persona).EmailAddress.MailboxType&&Object(o.m)("EmptyEmailAddress",[b.EmailAddress.MailboxType,b.EmailAddress.RoutingType]),!t[l].isValid){d=l;break}-1!=d?Object(c.a)(t[d],!0):Object(a.a)(e,!1),r.label=3;case 3:return[2]}})})})},1545:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n(52),i=new r.c(function(){return Promise.all([n.e(29),n.e(57),n.e(96),n.e(101)]).then(n.bind(null,2418))}),a=new r.b(i,function(e){return e.searchCacheTrie}),c=new r.a(i,function(e){return e.initializeSuggestionTrie})},1600:function(e,t,n){"use strict";var r=n(4),i=Object(r.createStore)("recipientcommon",{fallbackToFindPeople:!1})();t.a=i},1656:function(e,t,n){"use strict";var r=n(5),i=n(1199);function a(e,t,n){var a=e.EmailAddresses,u=e.DisplayName,d=e.Text,l=e.PDLItemId,b=e.ADObjectId,f=e.PersonaId,p=e.FeatureData,O=e.Id,j=e.ReferenceId,v=e.ImAddress,m=e.JobTitle,g=e.PeopleSubtype,h=a?a[0]:null;if(!n&&function(e){return Object(i.b)().sessionMaskedRecipients[e]}(h))return null;var S={EmailAddress:h,Name:Object(r.g)(u)?d:u,MailboxType:o(g),RoutingType:c(g),ItemId:l?{Id:l,__type:"ItemId:#Exchange"}:null};return{DisplayName:u,ADObjectId:b,FeatureData:p,Id:O,ImAddress:v,EmailAddress:S,EmailAddresses:[S],PersonaTypeString:s(g),PersonaId:{Id:f},Title:m,ReferenceId:j,TransactionId:t}}function c(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function s(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function o(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}n.d(t,"a",function(){return a})},1675:function(e,t,n){"use strict";function r(e){var t,n;return e?(null===(t=e.EmailAddress)||void 0===t?void 0:t.EmailAddress)||(null===(n=e.PersonaId)||void 0===n?void 0:n.Id):null}n.d(t,"a",function(){return r})},1706:function(e,t,n){"use strict";var r=n(0),i=n(1308),a=n(1707),c=n(1116),s=n(69);function o(e,t,n){e[0].isSelected&&n.recipients.length>0&&Object(c.a)(n.recipients[Math.max(0,t-1)],!0)}t.a=Object(s.action)("removeReadWriteRecipients")(function(e,t,n){var c,s;void 0===n&&(n=!0);var u=!1;try{for(var d=Object(r.__values)(t),l=d.next();!l.done;l=d.next()){var b=l.value,f=-1;if((f="number"==typeof b?b:e.recipients.indexOf(b))>=0){if(e.recipients[f].blockWellItemRemoval)return;Object(a.a)(f,e,o),u=!0}}}catch(e){c={error:e}}finally{try{l&&!l.done&&(s=d.return)&&s.call(d)}finally{if(c)throw c.error}}n&&u&&Object(i.a)(e)})},1707:function(e,t,n){"use strict";var r=n(0),i=n(4),a=Object(i.action)("removeRecipientFromRecipientWell",function(e,t,n,r){return{recipientIndex:e,recipientWellRecipients:t,onRecipientDeletedCallback:n,deletedRecipient:t.recipients[e],newRecipients:r}});Object(i.mutator)(a,function(e){var t;e.recipientWellRecipients.isDirty=!0,(t=e.recipientWellRecipients.recipients).splice.apply(t,Object(r.__spread)([e.recipientIndex,1],e.newRecipients||[]))}),Object(i.orchestrator)(a,function(e){e.onRecipientDeletedCallback([e.deletedRecipient],e.recipientIndex,e.recipientWellRecipients)}),t.a=a},1730:function(e,t,n){"use strict";function r(e,t){return null!=e&&null!=t&&(e==t||e.EmailAddress&&t.EmailAddress&&null!=e.EmailAddress.EmailAddress&&null!=t.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()==t.EmailAddress.EmailAddress.toLowerCase()||e.ADObjectId&&t.ADObjectId&&e.ADObjectId==t.ADObjectId||e.PersonaId&&t.PersonaId&&e.PersonaId==t.PersonaId)}n.d(t,"a",function(){return r})},1761:function(e,t,n){"use strict";var r=n(5),i=n(896),a=n(954),c=n(7),s=n(104),o=n(62),u=n(69);t.a=Object(u.action)("transactionFailed")(function(e,t,n,u,d,l){var b;if(void 0===l&&(l=null),null===(b=e)||void 0===b?void 0:b.hasSessionStarted){var f={TransactionRequestTime:Object(c.qb)(u),TransactionRequestDuration:Object(c.w)(Object(c.Ob)(),u),QueryString:Object(r.g)(t)?"":t,QueryStringLength:Object(s.b)(t)?0:t.length,ImpressionId:n};l&&Object.keys(l).forEach(function(e){f[e]=l[e]}),d&&(f.Context=d);var p=JSON.stringify(f),O=Object(a.a)(e,n,"TransactionFailed",null,0,p);Object(i.a)(e,O,!1),o.d.info(Object(r.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},1762:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("removeRecipientsFromRecipientWells",function(e,t){return{emailAddresses:e,recipientWells:t}});t.a=i},1804:function(e,t,n){"use strict";var r=n(0),i=n(1023),a=n(930),c=n(69),s=Object(c.action)("setDirectorySearchType")(function(e,t){e.directorySearchType=t}),o=n(929),u=n(775),d=n(1110);t.a=Object(c.action)("resolveQueryStringToRecipient")(function(e,t,n,c){return Object(r.__awaiter)(this,void 0,void 0,function(){var l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return s(e,n?u.a.Manual:u.a.None),(l=e.queryString.trim())?t||e.inForceResolve?(e.queryString="",Object(o.a)(e,!1),Object(i.a)([Object(d.a)(l)],e),[3,3]):[3,1]:[3,4];case 1:return Object(o.a)(e,!0),[4,Object(a.a)(e,e.queryString,n,c)];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:Object(o.a)(e,!1),r.label=5;case 5:return[2]}})})})},1805:function(e,t,n){"use strict";var r=n(0),i=n(69),a=(t.a=Object(i.action)("processFindPeopleResult")(function(e,t,n,i){if("Success"!=t.ResponseClass||!t.ResultSet)throw new Error("Response resultSet should not be null");i=i||20,i=n?i-e.length:i,i=t.ResultSet.length>i?i:t.ResultSet.length;for(var c=t.TransactionId,s=[],o=0;o<i;o++){var u=t.ResultSet[o];u.EmailAddress?s.push({EmailAddress:(d=u.EmailAddress,d.RoutingType&&"EX"===d.RoutingType.toUpperCase()?Object(r.__assign)(Object(r.__assign)({},d),{EmailAddress:d.OriginalDisplayName}):d),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName,TransactionId:c}):"ImplicitGroup"==u.PersonaTypeString&&s.push({EmailAddress:a(u),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,Members:u.Members,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName,TransactionId:c})}var d;n?e.push.apply(e,Object(r.__spread)(s)):e.splice.apply(e,Object(r.__spread)([0,e.length],s))}),function(e){return{EmailAddress:e.FeedbackId,OriginalDisplayName:e.FeedbackId,Name:e.DisplayName,MailboxType:"GroupMailbox",RoutingType:"SMTP"}})},808:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(40),i=n(65),a=n(1600);function c(){var e,t,n=Object(r.a)(),c=null===(t=null===(e=n)||void 0===e?void 0:e.SessionSettings)||void 0===t?void 0:t.IsExplicitLogon,s=Object(i.f)("rp-3SPeopleSuggestions")||Object(i.f)("rp-linkedInPeopleSuggestions");return!a.a.fallbackToFindPeople&&s&&!c&&n.SessionSettings.IsSubstrateSearchServiceAvailable}},896:function(e,t,n){"use strict";var r=n(5),i=n(69),a=n(1290),c=n.n(a),s=n(1291),o=n.n(s),u=n(191),d=n(62);function l(e){var t=o()({EntityFeedbackEntries:e});return c()({Header:Object(u.getJsonRequestHeader)(),Body:t}).then(function(e){!function(e){var t;if(null===(t=e)||void 0===t?void 0:t.Body){var n=e.Body;d.d.info(Object(r.b)("addEntityFeedback Error count: {0}",n.ErrorCount)),d.d.info(Object(r.b)("addEntityFeedback error details: {0}",n.ErrorDetails))}}(e)})}t.a=Object(i.action)("attemptToSubmitAddEntityFeedback")(function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(l(e.entityFeedbackEntries),d.d.info(Object(r.b)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))})},916:function(e,t,n){"use strict";function r(e){var t;if("SMTP"===e.RoutingType||void 0===e.RoutingType)return e.EmailAddress;var n="MAPIPDL"===e.RoutingType&&(null===(t=e.ItemId)||void 0===t?void 0:t.Id)||e.EmailAddress;return e.RoutingType+":"+n}n.d(t,"a",function(){return r})},917:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),i=n(1200);function a(e){var t=Object(i.b)(e.EmailAddress,e.DisplayName);return Object(r.__assign)(Object(r.__assign)({},t),{isPendingResolution:!1,persona:e})}},927:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n(52),i=new r.c(function(){return Promise.all([n.e(4),n.e(427)]).then(n.bind(null,2582))}),a=new r.b(i,function(e){return e.searchSuggestionsForSinglePersona}),c=new r.b(i,function(e){return e.searchSuggestions})},928:function(e,t,n){"use strict";var r=n(7),i=n(808);n.d(t,"c",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return b});var a="Cache",c="Mailbox",s="Directory",o=" Fallback";function u(e){e.peopleFeedbackState={live:null,cache:null,directory:null}}function d(e,t,n,a){if(Object(i.a)()&&e.peopleFeedbackState){var o={CorrelationId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};o.TimeStamp=Object(r.Ab)(t),o.QueryString=e.queryString,o.SuggestionSource=a?s:c,o.RawResponse="pending",n&&(o.CorrelationId=n),a?e.peopleFeedbackState.directory=o:e.peopleFeedbackState.live=o}}function l(e,t,n){var r;if(Object(i.a)()&&e.peopleFeedbackState){var a=n?JSON.stringify(n):"no response";(null===(r=e)||void 0===r?void 0:r.peopleFeedbackState)&&(t&&e.peopleFeedbackState.directory?e.peopleFeedbackState.directory.RawResponse=a:!t&&e.peopleFeedbackState.live&&(e.peopleFeedbackState.live.RawResponse=a))}}function b(e,t,n,c){if(Object(i.a)()&&e.peopleFeedbackState){var s={CorrelationId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};s.QueryString=e.queryString,s.TimeStamp=Object(r.Ab)(t),s.SuggestionSource=c?a+o:a,s.RawResponse=n?JSON.stringify(n):"no response",e.peopleFeedbackState.cache=s}}},929:function(e,t,n){"use strict";var r=n(69);t.a=Object(r.action)("setIsSearching")(function(e,t){e.isSearching!=t&&(e.isSearching=t)})},930:function(e,t,n){"use strict";var r=n(0),i=n(927),a=n(69),c=n(1023),s=n(1095),o=n(917),u=Object(a.action)("postProcessSuggestionsResult")(function(e,t,n){1==e.findResultSet.length&&n&&Object(s.a)(e)?Object(c.a)(e.findResultSet.map(o.a),e):e.findResultType=t}),d=n(1325),l=n(808);function b(e,t){Object(l.a)()?function(e,t){var n,i;try{for(var a=Object(r.__values)(t.Groups),c=a.next();!c.done;c=a.next()){var s=c.value;if("People"===s.Type){var o=s.Suggestions.filter(function(t){return null==e[t.EmailAddresses?t.EmailAddresses[0]:""]});s.Suggestions=o;break}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}(e,t):function(e,t){var n=t.ResultSet.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]});t.ResultSet=n}(e,t)}var f=n(1805),p=Object(a.action)("processResponseResults")(function(e,t,n,r,i){if(n){var a=new Map;e.forEach(function(e){a[e.EmailAddress.EmailAddress]=e}),b(a,t)}Object(l.a)()?Object(d.a)(e,t,n,r,i):Object(f.a)(e,t,n,r)}),O=n(928),j=n(929),v=n(995),m=n(1106),g=n(7),h=n(319),S=n(775),y=n(5),R=n(896),E=n(954),A=n(104),I=n(62),T=Object(a.action)("transactionCompleted")(function(e,t,n,r,i,a,c,s){var o;if(void 0===s&&(s=null),null===(o=e)||void 0===o?void 0:o.hasSessionStarted){var u={TransactionRequestTime:Object(g.qb)(i),TransactionRequestDuration:Object(g.w)(Object(g.Ob)(),i),QueryString:Object(y.g)(t)?"":t,QueryStringLength:Object(A.b)(t)?0:t.length,PersonaTypeList:c,ImpressionId:r,Cvid:e.conversationId};s&&Object.keys(s).forEach(function(e){u[e]=s[e]}),a&&(u.Context=a);var d=JSON.stringify(u),l=JSON.stringify(n),b=Object(E.a)(e,r,"TransactionCompleted",l,0,d);Object(R.a)(e,b,!1),I.d.info(Object(y.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),_=n(1362);function w(e,t,n){var r=[];e.findResultSet&&e.findResultSet.length>0&&e.findResultSet.forEach(function(e){r.push(_.a[e.PersonaTypeString])});var i,a;T(e.findPeopleFeedbackManager,e.queryString,(i=e.findResultSet,a=[],i&&i.forEach(function(e,t){a[t]=e.Id||e.EmailAddress.EmailAddress||e.EmailAddress.Name}),a),n,t,{Action:"Type Down"},r)}var P=Object(a.action)("autoSearchDirectory")(function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,c,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return a=Object(g.Ob)(),c=Object(h.a)(),Object(O.b)(e,a,c,!0),[4,i.a.import().then(function(n){return n(e.mailboxSmtpAddress,t,!0,c,e.findPeopleFeedbackManager)})];case 1:return s=r.sent(),Object(j.a)(e,!1),e.queryString.trim()==t&&(20,Object(v.a)(e,t),p(e.findResultSet,s,!1,20,!0),Object(O.d)(e,!0,s),w(e,a,Object(m.a)(s)),e.directorySearchType=S.a.Auto,0==e.findResultSet.length&&(e.findResultSet=[]),u(e,S.b.SearchDirectory,n)),[2]}})})}),C=n(4),F=Object(C.action)("addPendingRequest",function(e){return{correlationId:e}}),x=Object(C.action)("removePendingRequest",function(e){return{correlationId:e}}),k=n(939),D=n(1675),N=Object(a.action)("addToCache")(function(e){e&&0!=e.length&&null!==k.a.recipientCache&&e.forEach(function(e){if("LinkedIn"!=e.PersonaTypeString){var t=Object(D.a)(e);if(t&&!k.a.allKeys[t]){var n=Object(r.__assign)(Object(r.__assign)({},e),{sessionAdd:!0});k.a.recipientCache.push(n),k.a.allKeys[t]=!0}}})}),M=n(1761);function L(e,t,n){Object(M.a)(e.findPeopleFeedbackManager,e.queryString,n,t,{Action:"Type Down"})}var q=Object(a.action)("backfillCache")(function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,c,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=Object(h.a)(),F(n),a=Object(g.Ob)(),Object(O.b)(e,a,n,!1),c="",r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,i.a.import().then(function(r){return r(e.mailboxSmtpAddress,t,!1,n)})];case 2:return s=r.sent(),c=Object(m.a)(s),o=function(e){if(Object(l.a)()){var t=[];return Object(d.a)(t,e,!1),t}return e.ResultSet}(s),N(o),function(e){if(Object(l.a)()){var t=e;return!t||!t.Groups}var t=e;return"Success"!=t.ResponseClass||0==t.ResultSet.length}(s)||e.queryString!=t||(u=e.findResultSet.length>0,Object(O.d)(e,!1,s),p(e.findResultSet,s,u,5),w(e,a,c)),[3,5];case 3:return r.sent(),L(e,a,c),[3,5];case 4:return x(n),[7];case 5:return[2]}})})});var W=n(1348),G=n(1326),Q=n(1730),U=n(1706),J=(Object(C.orchestrator)(G.a,function(e){var t=e.targetRecipientWell,n=e.personaToRemove,r=e.shouldRemoveAllOccurrences,i=t.recipients.filter(function(e){return Object(Q.a)(e.persona,n)});if(i&&i.length>0){for(var a=r?i.length-1:0,c=[],s=0;s<=a;s++)i[s]&&!i[s].blockWellItemRemoval&&c.push(i[s]);c.length>0&&Object(U.a)(t,c)}}),n(1762)),V=(Object(C.orchestrator)(J.a,function(e){var t=e.recipientWells;t&&0!==t.length&&e.emailAddresses.forEach(function(e){var n={EmailAddress:e};t.filter(function(e){return!!e}).forEach(function(e){return Object(G.a)(e,n,!0)})})}),n(1308)),z=n(1446);Object(C.orchestrator)(c.a,function(e){e.newRecipients.forEach(function(e){e.isValid&&N([e.persona])})}),Object(C.orchestrator)(c.a,function(e){var t=e.recipientWell;t&&Object(s.a)(t)&&t.inForceResolve&&Object(z.a)(t,t.recipients)}),Object(C.orchestrator)(c.a,function(e){var t=e.recipientWell,n=e.newRecipients;Object(V.a)(t,n.map(function(e){return{isValid:e.isValid,newPersona:e.persona,newEmailAddress:e.persona.EmailAddress.EmailAddress}}))});var $=n(65),B=n(1105);Object(C.orchestrator)(F,function(e){H.pendingFindPeopleRequests++,Object($.f)("rp-findPeopleSuggestionFeedback")&&B.b.importAndExecute(e.correlationId)}),Object(C.orchestrator)(x,function(e){H.pendingFindPeopleRequests--,Object($.f)("rp-findPeopleSuggestionFeedback")&&B.c.importAndExecute(e.correlationId)});var H=Object(C.createStore)("readwriterecipientwell",{pendingFindPeopleRequests:0})(),K=n(151),X=Object(a.action)("setFindResultSet")(function(e,t){e.findResultSet=t});var Y=n(1352),Z=Object(a.action)("processCacheResult")(function(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,function(){var a;return Object(r.__generator)(this,function(c){return n&&(a=new Map,e.findResultSet.forEach(function(e){a[e.EmailAddress.EmailAddress]=e}),t=function(e,t){return t.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]})}(a,t),(t=Object(r.__spread)(e.findResultSet,t)).splice(5)),Object(j.a)(e,!1),X(e,t),Object(Y.a)(e),u(e,S.b.Cache,i),[2]})})}),ee=n(1178);function te(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,i,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object($.f)("rp-peopleSuggestionsTrie")?[4,Object(ee.d)(e,5,t)]:[3,2];case 1:return i=r.sent(),[3,3];case 2:i=Object(ee.a)(e,5,t),r.label=3;case 3:return 0==(n=i).length?[2,[]]:(a=n.map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId,PersonaTypeString:e.PersonaTypeString,FeatureData:e.FeatureData}}),[2,Promise.resolve(a)])}})})}var ne=n(1117),re=function(e,t,n,i,a){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var c,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return c=Object(g.Ob)(),[4,te(e,Object(ne.a)(t))];case 1:return s=r.sent(),Object(O.a)(n,c,s),Z(n,s,i,a),[2]}})})},ie=Object(a.action)("findPeopleCacheFirst")(function(e,t,n,i,a){return Object(r.__awaiter)(this,void 0,void 0,function(){var c,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return c=S.b.Cache,s=new K.a(W.a.SearchCacheFirst.name),e.directorySearchType=S.a.None,Object(j.a)(e,!0),[4,re(t,n,e,i,a)];case 1:if(r.sent(),Object(v.a)(e,t),!(e.findResultSet.length<5))return[3,7];r.label=2;case 2:return r.trys.push([2,6,,7]),e.findResultSet.length>0&&H.pendingFindPeopleRequests<3?(q(e,t),c=S.b.MixedCacheLive,[3,5]):[3,3];case 3:return 0!=e.findResultSet.length?[3,5]:[4,q(e,t)];case 4:r.sent(),c=S.b.FindPeople,r.label=5;case 5:return[3,7];case 6:return o=r.sent(),s.endWithError("ServerError",o),[3,7];case 7:return e.findResultSet.length>0?(u(e,c,a),[3,10]):[3,8];case 8:return[4,P(e,t,a)];case 9:r.sent(),c=S.b.SearchDirectory,r.label=10;case 10:return Object(j.a)(e,!1),s.addCustomData([c,t==e.queryString]),s.end(),[2]}})})}),ae=5;var ce=n(1346),se=n(71),oe=Object(a.action)("searchCacheFallback")(function(e,t,n,i,a,c){return Object(r.__awaiter)(this,void 0,void 0,function(){var s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return e.queryString.trim()!=t.trim()?[3,2]:(s=Object(g.Ob)(),[4,te(t,Object(ne.a)(n))]);case 1:o=r.sent(),Object(O.a)(e,s,o,!0),Object(v.a)(e,t),e.directorySearchType=S.a.None,o.length>0?Z(e,o,i,a):c&&(c.isCacheEmpty=!0),r.label=2;case 2:return[2]}})})});t.a=Object(a.action)("findReadWriteRecipient")(Object(a.select)({store:function(){return H}})(function(e,t,n,a,c,o,d,b){return Object(r.__awaiter)(this,void 0,void 0,function(){var f,y,R,E,A,I,T,_,C,k,D,N,M,q,G,Q,U,J;return Object(r.__generator)(this,function(V){switch(V.label){case 0:return n||Object(O.c)(e),f=function(e,t){return Object(s.a)(e)?e.recipients:t||[]}(e,c),y=!1,o&&o.length>0&&(R=function(e,t){var n=[];if(t){var r=0;for(e=e.toLowerCase();n.length<ae&&r<t.length;){var i=t[r].persona.EmailAddress;(i.EmailAddress&&0==i.EmailAddress.toLowerCase().indexOf(e)||i.Name&&0==i.Name.toLowerCase().indexOf(e))&&n.push({EmailAddress:i}),r++}}return n}(t,o))&&R.length>0&&(e.findResultSet=R,y=!0),!d&&!Object($.f)("rp-peopleSuggestionsCacheFirst")||n?[3,2]:[4,ie(e,t,f,y,a)];case 1:return V.sent(),[2];case 2:return E=!1,b.store.pendingFindPeopleRequests<3?(J=new K.a(W.a.SearchPeopleIndex.name),Object(j.a)(e,!0),A=e.currentRenderedQueryString,I=e.directorySearchType,Object($.f)("rp-optimizeAutoSearchDirectory")&&""!=A&&!n&&I==S.a.Auto&&A.length<t.length&&0==t.indexOf(e.currentRenderedQueryString)?[4,P(e,t,a)]:[3,4]):[3,15];case 3:return V.sent(),E=!0,J.addCustomData([!1,!0,!0,!1,!0,Object(l.a)()]),J.end(),[3,14];case 4:T={isTimedOut:!1,isCacheEmpty:!1},_=n||Object(ce.a)()?null:setTimeout(function(e,t,n,i,a,c){return function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return c.isTimedOut=!0,[4,oe(e,n,t,i,a,c)];case 1:return r.sent(),[2]}})})}}(e,f,t,y,a,T),1e3),C=Object(g.Ob)(),k="",D=Object(h.a)(),V.label=5;case 5:return V.trys.push([5,12,,14]),F(D),N=[],f.forEach(function(e){N.push(e.persona.EmailAddress.EmailAddress)}),Object(O.b)(e,C,D,n),[4,i.a.import().then(function(r){return r(e.mailboxSmtpAddress,t,n,D,e.findPeopleFeedbackManager,N)})];case 6:return M=V.sent(),x(D),clearTimeout(_),q=e.queryString==t,Object(O.d)(e,n,M),T.isTimedOut&&!T.isCacheEmpty||!q?[3,11]:(Object(v.a)(e,t),e.directorySearchType=n?S.a.Manual:S.a.None,G=n?20:5,p(e.findResultSet,M,y,G,n),k=Object(m.a)(M),w(e,C,k),e.findResultSet.length>0?(Object(j.a)(e,!1),Q=n?S.b.SearchDirectory:S.b.FindPeople,u(e,Q,a),[3,11]):[3,7]);case 7:return[4,oe(e,t,f,y,a)];case 8:return V.sent(),0!==e.findResultSet.length?[3,11]:Object(se.s)()?(e.directorySearchType=S.a.Auto,e.findResultSet=[],[3,11]):[3,9];case 9:return E=!0,[4,P(e,t,a)];case 10:V.sent(),V.label=11;case 11:return J.addCustomData([T.isTimedOut,q,n,T.isCacheEmpty,E,Object(l.a)()]),J.end(),[3,14];case 12:return U=V.sent(),x(D),J.endWithError("ServerError",U),L(e,C,k),[4,oe(e,t,f,y,a)];case 13:return V.sent(),[3,14];case 14:return[3,17];case 15:return J=new K.a("FindPeopleThresholdHit"),[4,oe(e,t,f,y,a)];case 16:V.sent(),J.end(),V.label=17;case 17:return Object(j.a)(e,!1),[2]}})})}))},939:function(e,t,n){"use strict";var r=n(4),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1})();t.a=i},954:function(e,t,n){"use strict";var r=n(5),i=n(69),a=Object(i.action)("increaseEntrySequenceNumber")(function(e){e&&e.entrySequenceNumber++}),c=n(104),s=n(62),o=n(7);function u(e,t,n,i,u,d,l,b){if(void 0===b&&(b=Object(o.Ob)()),!e)return s.d.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(c.b)(e.clientSessionId))return s.d.warn(Object(r.b)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var f={ClientEventTimeUtc:Object(o.sb)(b),ClientEventTimeLocal:Object(o.qb)(b),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:i,EntityAddSource:u,JsonPropertyBag:d,ScenarioName:l||e.entityScenarioName};return a(e),f}n.d(t,"a",function(){return u})},995:function(e,t,n){"use strict";var r=n(69);t.a=Object(r.action)("updateCurrentRenderedQueryString")(function(e,t){e.currentRenderedQueryString=t})}}]);
//# sourceMappingURL=owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js.map
self.scriptsLoaded['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = (new Date()).getTime();