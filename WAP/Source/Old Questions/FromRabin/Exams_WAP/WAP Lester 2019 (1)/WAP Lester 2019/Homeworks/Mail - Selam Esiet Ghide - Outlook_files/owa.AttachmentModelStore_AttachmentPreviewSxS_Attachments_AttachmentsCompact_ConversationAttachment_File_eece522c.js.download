self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentModelStore~AttachmentPreviewSxS~Attachments~AttachmentsCompact~ConversationAttachment~File~eece522c.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[12],{2677:function(e,t,n){"use strict";function r(e,t,n,r,o,s){var i=!1;return{task:function(){return new Promise(function(a,u){for(var c=0,l=0,d=0,f=function(){var p,h,v,b,m;i&&a(1),c<n&&d<t.length&&((p=d,h=t[p],v=h.start,b=h.end,m=e.slice(v,b),r(m,s(p),o)).then(function(){return c-=1,(l+=1)===t.length&&a(0),void f()}).catch(u),d+=1,c+=1)},p=0;p<n;p++)f()})},cancelTask:function(){return i=!0}}}var o=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function s(e,t,n){void 0===n&&(n=o),function(e){e.sliceSize=e.sliceSize||o.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||o.numberOfSlicesToParallelize}(n);var s=n.sliceSize,u=n.numberOfSlicesToParallelize,c=Math.ceil(e.size/s),l=function(e,t,n){for(var r=[],o=0,s=0;s<e;s++){var i=Math.min(o+t,n);r.push({start:o,end:i}),o=i}return r}(c,s,e.size),d=r(e,[l[0]],1,t,c,function(){return 0}),f=l.length>2?r(e,l.slice(1,l.length-1),u,t,c,function(e){return e+1}):a(),p=l.length>1?r(e,[l[l.length-1]],1,t,c,function(){return l.length-1}):a();return{onCompletePromise:d.task().then(i(f.task)).then(i(p.task)),cancel:function(){d.cancelTask(),f.cancelTask(),p.cancelTask()}}}function i(e){return function(t){return 0===t?e():Promise.resolve(t)}}function a(){var e=!1;return{task:function(){return e?Promise.resolve(1):Promise.resolve(0)},cancelTask:function(){return e=!0}}}n.d(t,"a",function(){return s})},988:function(e,t,n){"use strict";var r=n(0),o=n(2038),s=n.n(o),i=n(5),a=n(245),u=n(467),c=n(248),l=n(2039),d=n.n(l),f=n(1383),p=n.n(f);function h(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var o,s,i,a,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return o=p()({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),s=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider",(i=new Headers).append("X-OWA-ActionName",s),a={headers:i,datapoint:{customData:{actionSource:n},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0},[4,d()(o,a)];case 1:return[4,(u=r.sent()).json()];case 2:return[2,{token:r.sent(),response:u}]}})})}var v="_api/v2.0/drive",b=v+"/items",m="root",_="onedrive_implicit.access",w="Bearer ",O=function(e,t,n){return Object(r.__assign)({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e)},j=function(e){return"TokenRetrievalError"===e._typeSpec},g=[],k={},T=1,R=30,S="",y="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function x(e){k[e]=null}function P(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,h(e,t,n)];case 1:return o=r.sent(),function(e,t,n){g=g.filter(function(e){return e!==t});var r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){var o="Access token request failed for token key "+e+" with response code "+r.TokenResultCode,s=n.response.headers.get("x-tokenresult"),i=null!=s&&s.indexOf(y)>0;throw O(new Error(o),r.TokenResultCode,i)}var a=k[e]||{};a[t]=r,k[e]=a}(e,t,o),[2,o.token]}})})}function z(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var o,s;return Object(r.__generator)(this,function(r){return o=S,0===e&&n&&(s=Object(c.parse)(n),o=Object(i.b)("{0}//{1}/",s.protocol,s.hostname)),[2,I(e,o,t,null)]})})}function E(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(r){return[2,I(0,e,t,n)]})})}function I(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n||!function(e,t){var n=k[e];if(!n)return!1;var r=n[t];if(!r||!r.AccessTokenExpiry)return!1;var o=new Date(r.AccessTokenExpiry),i=s()(new Date(Date.now()),T);return null!=o&&i<o}(e,t)?[3,1]:(i=k[e],a=i[t],s()(new Date(Date.now()),R)>new Date(a.AccessTokenExpiry)&&-1===g.indexOf(t)&&(g.push(t),P(e,t,o)),[2,a.AccessToken]);case 1:return[4,P(e,t,o)];case 2:return[2,(a=r.sent()).AccessToken]}})})}function D(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(a.a)()&&1===e?[4,Object(u.getDelegationTokenForOwa)(_)]:[3,2];case 1:return o=r.sent(),[3,4];case 2:return[4,z(e,t,n)];case 3:o=r.sent(),r.label=4;case 4:return[2,w+o]}})})}var A="https://www.googleapis.com/drive/v3/files";function N(e,t,n){return void 0===n&&(n={forceTokenRefresh:!1,requestInit:{}}),Object(r.__awaiter)(this,void 0,void 0,function(){var o,s,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return o=n.forceTokenRefresh,s=n.requestInit||{},[4,D(t,o,e)];case 1:return i=r.sent(),s.headers||(s.headers=new Headers),s.headers.set("Authorization",i),[4,fetch(e,s)];case 2:return[2,r.sent()]}})})}function q(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,N(A+"?"+e,5,{forceTokenRefresh:t})];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o)}];case 3:return[2,{errorResponse:n,result:null}]}})})}function C(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,N(A+"/"+e+"?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension",5)];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:return n=r.sent(),[2,{errorResponse:null,result:JSON.parse(n)}];case 3:return[2,{errorResponse:t,result:null}]}})})}var F,M=n(160),U=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function B(){return Object.keys(U).map(function(e){return U[e]}).join(",")}function H(e,t,n,o,s,i,a){return void 0===i&&(i=F.None),Object(r.__awaiter)(this,void 0,void 0,function(){var u,l,d,f,p,h,v;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return s=s||m,u=function(e){switch(e){case 0:return U.name;case 1:return U.size;default:return U.lastModifiedDateTime}}(n),l=function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(M.a)(e)}}(o),d="expand=thumbnails(select=medium)&orderby=folder,"+u+" "+l+"&select="+B(),i!==F.None&&(d=d+"&filter="+function(e){switch(e){case F.None:return"";case F.Folder:return"("+U.folder+" ne null)";default:return Object(M.a)(e)}}(i)),a&&(d=d+"&$top="+a.maxEntries,a.skipToken&&(d=d+"&$skiptoken="+a.skipToken)),[4,N(e+"/"+b+"/"+s+"/children?"+d,t,{requestInit:{headers:new Headers({Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"})}})];case 1:return(f=r.sent()).ok?[4,f.text()]:[3,3];case 2:return p=r.sent(),h=JSON.parse(p),v=h["@odata.nextLink"]?function(e){var t=Object(c.parse)(e,!0);return t.query?t.query.$skiptoken:null}(decodeURI(h["@odata.nextLink"])):null,[2,{errorResponse:null,result:{items:h.value,skipToken:v}}];case 3:return[2,{errorResponse:f,result:null}]}})})}function J(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,function(){var s,i,a,u,c,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return o=o||m,s="expand=thumbnails(select=medium)&select="+B(),i=t+"/"+b+"/"+o+"/children?"+s,a={name:n,folder:{}},(u=new Headers).append("Content-Type","application/json"),u.append("Accept","application/json"),[4,N(i,e,{requestInit:{method:"POST",body:JSON.stringify(a),headers:u}})];case 1:return(c=r.sent()).ok?[4,c.text()]:[3,3];case 2:return l=r.sent(),[2,{errorResponse:null,result:JSON.parse(l)}];case 3:return[2,{errorResponse:c,result:null}]}})})}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(F||(F={}));var L=n(2677);var $=n(121),V=Object.freeze({folderInfo:{type:0,identifier:m},sliceSize:10485760,conflictBehavior:"rename",onProgress:function(){}});function G(e,t,n){var o=this,s=function(){return Promise.resolve({errorResponse:null,result:null})};return{uploadPromise:Object(r.__awaiter)(o,void 0,void 0,function(){var o,i,a,u,c,l,d,f,p,h,m,_,w,O,j,g,k,T;return Object(r.__generator)(this,function(R){switch(R.label){case 0:switch(function(e){Object.keys(V).forEach(function(t){e[t]=e[t]||V[t]})}(n),o=n.fileToUpload,i=o.fileName,a=o.fileBlob,u=n.folderInfo,c=u.type,l=u.identifier,d=n.conflictBehavior,f=n.sliceSize,p=n.onProgress,c){case 0:h=t+"/"+b+"/"+l+":/"+encodeURI(i)+":/createUploadSession";break;case 1:h=t+"/"+v+"/"+l+":/"+encodeURI(i)+":/createUploadSession";break;default:Object(M.a)(c)}return m={item:{"@name.conflictBehavior":d}},_=new Headers({"Content-Type":"application/json",Accept:"application/json"}),[4,N(h,e,{requestInit:{method:"POST",body:JSON.stringify(m),headers:_}})];case 1:return(w=R.sent()).ok?[4,w.text()]:[3,4];case 2:return O=R.sent(),j=JSON.parse(O),g=function(e,t,n,o){var s=this,i=e.uploadUrl,a=t.size,u=null,c=null,l=function(e,t,n,o,s,i){var a=this;return function(u,c){return Object(r.__awaiter)(a,void 0,void 0,function(){var a,l,d,f,p;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return a=function(e,t,n){var r=W(e,t,n),o=r.rangeStart,s=r.rangeEnd;return new Headers({"Content-Range":"bytes "+o+"-"+s+"/"+n,Accept:"application/json"})}(c,t,n),l=function(e){var r=W(e,t,n).rangeStart;return function(e){var t=e.loaded,s=r+t;o({loaded:s,total:n})}}(c),[4,(h=e,v=l,b={method:"PUT",body:u,headers:a},void 0===b&&(b={method:"POST"}),new Promise(function(e,t){var n=b.method,r=b.body,o=b.headers,s=new XMLHttpRequest;s.onreadystatechange=function(){4===s.readyState&&e({status:s.status,text:function(){return Promise.resolve(s.responseText)}})},s.ontimeout=function(){t(new Error("Request timed out"))},s.onerror=function(){t(new Error("Request failed"))},s.onabort=function(){t(new Error("Request aborted"))},v&&(s.upload.onprogress=v),s.open(n,h,!0),new Headers(o).forEach(function(e,t){s.setRequestHeader(t,e)}),r?s.send(r):s.send()}))];case 1:return 201!==(d=r.sent()).status&&200!==d.status?[3,3]:[4,d.text()];case 2:f=r.sent(),p=JSON.parse(f),s(p),r.label=3;case 3:if(!Object($.a)(d.status))throw i(d),new Error("Unable to upload file");return[2]}var h,v,b})})}}(i,n,a,o,function(e){u=e},function(e){c=e}),d=Object(L.a)(t,l,{sliceSize:n,numberOfSlicesToParallelize:1}),f=d.onCompletePromise,p=d.cancel,h=Object(r.__awaiter)(s,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:e=null,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,f];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,{errorResponse:c,result:null}];case 4:switch(e){case 0:return u?[2,{errorResponse:null,result:u}]:[2,{errorResponse:c,result:null}];case 1:throw new Error("Upload was cancelled");default:return[2,Object(M.a)(e)]}return[2]}})});return{uploadPromise:h,cancel:function(){return Object(r.__awaiter)(s,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:p(),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,h];case 2:return e.sent(),[3,5];case 3:return[4,X(i)];case 4:return[2,e.sent()];case 5:return[2]}})})}}}(j,a,f,p),k=g.uploadPromise,T=g.cancel,s=T,[4,k];case 3:return[2,R.sent()];case 4:return[2,{errorResponse:w,result:null}]}})}),cancel:function(){return Object(r.__awaiter)(o,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,s()];case 1:return[2,e.sent()]}})})}}}function W(e,t,n){var r=e*t;return{rangeStart:r,rangeEnd:Math.min(r+t,n)-1}}function X(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,fetch(e,{method:"DELETE"})];case 1:return t=n.sent(),Object($.a)(t.status)?[2,{errorResponse:null,result:null}]:[2,{errorResponse:t,result:null}]}})})}function Q(e,t){switch(e){case 0:return t;case 1:return null;default:Object(M.a)(e)}return null}function K(e){return"file"===e[".tag"]}function Y(e){return"folder"===e[".tag"]}function Z(e){return"deleted"===e[".tag"]}function ee(e){return"folder"===e.type}var te="https://api.dropboxapi.com/2/files";function ne(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,o,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return e.path=e.path||"",t=te+"/list_folder",n={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},[4,N(t,2,{requestInit:n})];case 1:return(o=r.sent()).ok?[4,o.text()]:[3,3];case 2:return s=r.sent(),[2,{errorResponse:null,result:JSON.parse(s).entries}];case 3:return[2,{errorResponse:o,result:null}]}})})}var re,oe="https://api.box.com/2.0",se=2e3;function ie(e,t){return void 0===t&&(t=se),Object(r.__awaiter)(this,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,N(oe+"/folders/"+(e=e||"0")+"/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit="+t+"&offset=0",3)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o).entries}];case 3:return[2,{errorResponse:n,result:null}]}})})}!function(e){e.Uploaded="uploaded",e.Tagged="tagged"}(re||(re={}));var ae=re,ue="https://graph.facebook.com/v2.7",ce=200;function le(e,t){return void 0===t&&(t=ce),Object(r.__awaiter)(this,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,N(ue+"/me/photos/?fields=id,name,images,from,link,album,place,created_time&type="+e.toString()+"&limit="+t,6)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o).data}];case 3:return[2,{errorResponse:n,result:null}]}})})}var de=n(1301),fe=n.n(de),pe=n(1300),he=n.n(pe),ve=n(747),be=n.n(ve),me=n(737),_e=n(825),we=n.n(_e),Oe=n(842),je=n.n(Oe),ge=n(191),ke=n(62);function Te(e,t){var n=function(e,t){return he()({ParentFolderIds:[be()({Id:e})],ItemShape:je()({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return fe()({Header:Object(ge.getJsonRequestHeader)(),Body:n})}function Re(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,o,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=we()({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),[4,Te(e=e||Object(me.a)("inbox"),n)];case 1:return o=r.sent(),(s=o.Body.ResponseMessages.Items[0])&&"Success"===s.ResponseClass&&s.RootFolder.Items?[2,{errorResponse:null,result:s.RootFolder.Items}]:(ke.d.warn("Find Item Response of get mail messages failed with "+s),[2,{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},result:null}])}})})}n.d(t,"k",function(){return D}),n.d(t,"j",function(){return z}),n.d(t,"p",function(){return E}),n.d(t,"e",function(){return x}),n.d(t,"v",function(){return j}),n.d(t,"m",function(){return q}),n.d(t,"l",function(){return C}),n.d(t,"o",function(){return H}),n.d(t,"d",function(){return F}),n.d(t,"f",function(){return J}),n.d(t,"w",function(){return G}),n.d(t,"c",function(){return"https://api.onedrive.com"}),n.d(t,"a",function(){return"_api/v2.0/shares"}),n.d(t,"q",function(){return Q}),n.d(t,"t",function(){return K}),n.d(t,"u",function(){return Y}),n.d(t,"s",function(){return Z}),n.d(t,"h",function(){return ne}),n.d(t,"r",function(){return ee}),n.d(t,"g",function(){return ie}),n.d(t,"b",function(){return ae}),n.d(t,"i",function(){return le}),n.d(t,"n",function(){return Re})}}]);
//# sourceMappingURL=owa.AttachmentModelStore~AttachmentPreviewSxS~Attachments~AttachmentsCompact~ConversationAttachment~File~eece522c.js.map
self.scriptsLoaded['owa.AttachmentModelStore~AttachmentPreviewSxS~Attachments~AttachmentsCompact~ConversationAttachment~File~eece522c.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentModelStore~AttachmentPreviewSxS~Attachments~AttachmentsCompact~ConversationAttachment~File~eece522c.js'] = (new Date()).getTime();