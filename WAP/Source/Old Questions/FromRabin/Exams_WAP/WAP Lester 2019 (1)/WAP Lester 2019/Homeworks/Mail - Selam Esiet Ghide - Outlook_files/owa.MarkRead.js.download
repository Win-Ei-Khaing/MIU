self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MarkRead.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[358],{1057:function(e,t,n){"use strict";n.d(t,"k",function(){return r}),n.d(t,"m",function(){return o}),n.d(t,"y",function(){return i}),n.d(t,"w",function(){return a}),n.d(t,"a",function(){return c}),n.d(t,"r",function(){return u}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"g",function(){return f}),n.d(t,"h",function(){return l}),n.d(t,"i",function(){return b}),n.d(t,"j",function(){return O}),n.d(t,"f",function(){return v}),n.d(t,"e",function(){return m}),n.d(t,"n",function(){return j}),n.d(t,"d",function(){return p}),n.d(t,"l",function(){return y}),n.d(t,"v",function(){return I}),n.d(t,"p",function(){return g}),n.d(t,"x",function(){return h}),n.d(t,"q",function(){return R}),n.d(t,"t",function(){return _}),n.d(t,"u",function(){return A}),n.d(t,"o",function(){return w}),n.d(t,"s",function(){return S});var r="multipart/signed",o="application/pkcs7-mime",i="application/x-pkcs7-mime",a=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",d="0800",f=57,l=78,b=16,O=11,v="IPM.Note.SMIME.MultipartSigned",m="IPM.Note.SMIME",j="smime-",p="image",y="OwaToSmime",I="SmimeToOwa",g="en-US",h=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],R="https://ow2.res.office365.com/owasmime/20.19.814.2/owasmime.msi",_="OwaSmimeEdgeExtension.appxbundle",A="https://ow2.res.office365.com/owasmime/20.19.814.2/OwaSmimeEdgeExtension.appxbundle",w="https://ow2.res.office365.com/owasmime/20.19.814.2/SmimeOutlookWebChrome.msi",S="https://ow2.res.office365.com/owasmime/20.19.814.2/SmimeOutlookWebChrome.msi"},10584:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"MarkAllItemsAsReadRequest:#Exchange"},e)}},10585:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),o=n(10586);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("MarkAllItemsAsRead",e,t)}},10586:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"MarkAllItemsAsReadJsonRequest:#Exchange"},e)}},10587:function(e){e.exports={a:"EAb",b:"FAb"}},1120:function(e,t,n){"use strict";var r=n(21),o=n(4),i={folderTable:new r.ObservableMap,rootFolder:null},a=Object(o.createStore)("publicFolderFavoriteStore",i)();t.a=a},1236:function(e,t,n){"use strict";var r=n(4),o=n(131),i=n(732),a=n(21),c=Object(r.createStore)("mailboxInfoStore",new a.ObservableMap),u=n(40);function s(e){if(!e)return Object(o.e)();if(!c().has(e)){var t=function(e){var t,n,r,a=Object(i.B)(),c=a&&a.get(e);c&&c.treeType===i.l?(t=c.principalSMTPAddress,n=c.principalSMTPAddress,r=Object(o.c)()+c.principalSMTPAddress):(t=Object(o.d)(),n=Object(u.a)().SessionSettings.UserEmailAddress,r=Object(o.b)());return{type:o.a.UserMailbox,deprecatedMailboxId:t,primarySmtpAddress:n,routingKey:r,returnModernConversationItems:!1,requestOptions:Object(i.v)(e)}}(e);d(e,t)}return c().get(e)}var d=Object(r.mutatorAction)("addMailboxInfoToStore",function(e,t){c().set(e,t)}),f=n(1135),l=n(857),b=n(1971);function O(e){return e?v(e.tableQuery):Object(o.e)()}function v(e){var t,n=Object(l.b)(e),r=null===(t=e)||void 0===t?void 0:t.folderId;return null!=n?Object(f.m)(n):m(r)}function m(e){return Object(i.P)(e)?Object(b.a)(e):s(e)}n.d(t,"a",function(){return O}),n.d(t,"c",function(){return v}),n.d(t,"b",function(){return m})},1237:function(e,t,n){"use strict";var r=n(131),o=n(731),i=n(740),a=n(737),c=n(732);function u(e,t){return!Object(o.s)()&&t&&t.type===r.a.UserMailbox&&!Object(i.y)(e)&&e!=Object(a.a)("recoverableitemsdeletions")&&!Object(c.L)(e,c.l)}var s=n(52),d=n(1591);n.d(t,"e",function(){return l}),n.d(t,"a",function(){return d.a}),n.d(t,"b",function(){return d.b}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d.c});var f=new s.c(function(){return n.e(494).then(n.bind(null,13938))}),l=new s.a(f,function(e){return e.undo})},1321:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ItemChange:#Exchange"},e)}},1343:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(246);function o(e){var t=new Headers;return Object(r.g)(e,t),{headers:t}}},1378:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SetItemField:#Exchange"},e)}},1426:function(e,t,n){"use strict";var r=n(4),o=Object(r.action)("ON_GET_NUDGES_COMPLETED",function(e,t){return{nudgedRows:e,tableView:t}}),i=Object(r.action)("ON_NUDGE_REMOVED",function(e){return{rowKey:e}}),a=Object(r.createStore)("nudgeStore",{nudgedRows:[]}),c=a();Object(r.mutator)(o,function(e){c.nudgedRows=e.nudgedRows}),Object(r.mutator)(i,function(e){for(var t=c.nudgedRows.length-1;t>=0;t--)c.nudgedRows[t].rowKey===e.rowKey&&c.nudgedRows.splice(t,1)});var u=n(65);function s(e,t){return!!Object(u.f)("tri-spotlight")&&a().nudgedRows.some(function(n){return n.rowKey===e&&n.tableViewId===t&&0===n.daysAgo})}function d(e){return c.nudgedRows.filter(function(t){return!s(t.rowKey,t.tableViewId)&&t.tableViewId===e}).length}var f=n(2741),l=n(5);function b(e){var t=c.nudgedRows.filter(function(t){return t.rowKey===e})[0];switch(t.reason){case 0:return Object(l.b)(Object(l.a)(f.a),t.daysAgo);case 1:return Object(l.b)(Object(l.a)(f.b),t.daysAgo)}}function O(e){var t=c.nudgedRows.filter(function(t){return t.conversationId===e});return t.length>0?t[0].rowKey:null}function v(e){var t=c.nudgedRows.filter(function(t){return t.itemId===e});return t.length>0?t[0].rowKey:null}function m(e,t){return!s(e,t)&&c.nudgedRows.some(function(n){return n.rowKey===e&&n.tableViewId===t||"testNudgeRowKey"==e})}var j=n(731);function p(e,t){return m(e,t.id)&&!j.b.getIsPinned(e,t)}function y(e){return!!Object(u.f)("tri-spotlight")&&a().nudgedRows.some(function(t){return(t.conversationId===e||t.itemId===e)&&0===t.daysAgo})}n.d(t,"d",function(){return d}),n.d(t,"a",function(){return b}),n.d(t,"c",function(){return v}),n.d(t,"b",function(){return O}),n.d(t,"h",function(){return p}),n.d(t,"f",function(){return m}),n.d(t,"k",function(){return s}),n.d(t,"g",function(){return y}),n.d(t,"e",function(){return a}),n.d(t,"i",function(){return o}),n.d(t,"j",function(){return i})},1542:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SortResults:#Exchange"},e)}},1581:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(990);function o(e,t){return e.map(function(e){return Object(r.getInstrumentationContext)(e,t)}).filter(function(e){return e})}},1586:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"Message:#Exchange"},e)}},1591:function(e,t,n){"use strict";var r,o=n(4),i=Object(o.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null})(),a=n(973),c=n(69),u=n(49);n.d(t,"a",function(){return s}),n.d(t,"b",function(){return d}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return l});var s=Object(c.action)("addActionToUndoStack")(Object(c.select)({store:function(){return i}})(function(e,t,n){null!==e&&(r=e,n.store.hasUndoableAction=!0,n.store.undoableActionFolderId=t)})),d=Object(c.action)("clearLastUndoableAction")(Object(c.select)({store:function(){return i}})(function(e){r=null,e.store.hasUndoableAction=!1,e.store.undoableActionFolderId=null})),f=Object(c.select)({store:function(){return i}})(function(e){return e.store.hasUndoableAction}),l=Object(u.c)("undo",{name:"TnS_Undo",customData:function(e){return[e]}})(function(e){i.undoableActionFolderId?a.a.clearMapForFolder(i.undoableActionFolderId):a.a.removeAll();null!==r&&(r(),d())})},1602:function(e){e.exports={a:"rla"}},1694:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n(1057);function o(e){return e&&0===e.indexOf(r.f)}function i(e){return e&&0===e.indexOf(r.e)&&!o(e)}function a(e){return e&&0===e.indexOf(r.e)}function c(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1782:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentPreviewsRequest:#Exchange"},e)}},1834:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return f});var r=n(0),o=n(758),i=n(1373),a=n(861),c=n(40),u=n(1072);function s(e){var t,n,c,s=(null===(c=e)||void 0===c?void 0:c.itemIds)?e.itemIds.length:0;if(0==s)return[null,!1,!1];var d=null,f=2==Object(a.c)().type||!Object(a.b)();if(1==s){if(!(d=o.a.items.get(e.itemIds[0])))return[null,!1,!1];f=f||d.ParentFolderId&&d.ParentFolderId.Id==Object(a.b)()}else{var l=null;try{for(var b=Object(r.__values)(e.itemIds),O=b.next();!O.done;O=b.next()){var v=O.value,m=o.a.items.get(v);if(!m)return[null,!1,!1];if(m.ParentFolderId&&m.ParentFolderId.Id==Object(a.b)()){d=m,f=!0;break}Object(u.a)(m.ParentFolderId.Id,"sentitems")&&(l=m)}}catch(e){t={error:e}}finally{try{O&&!O.done&&(n=b.return)&&n.call(b)}finally{if(t)throw t.error}}d||(d=l||o.a.items.get(e.itemIds[0]))}return[d,f,Object(i.a)(d.ParentFolderId.Id)]}function d(e,t,n){var r=Object(c.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||r)&&t&&!n)}function f(e){var t=o.a.conversationNodes.get(e),n=Object(r.__read)(s(t),3),i=n[0],a=n[1];return d(i,n[2],a)?i:null}},1909:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),o=n(2221);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("UpdateItem",e,t)}},1946:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("GET_FOLDER_DATA",function(e){return{folderId:e}})},1950:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateItemRequest:#Exchange"},e)}},1971:function(e,t,n){"use strict";var r=n(731),o=n(732);function i(){var e=Object(r.B)();return e&&0==e.tableQuery.type&&Object(o.P)(e.tableQuery.folderId)}function a(){var e=Object(r.B)();return e&&0==e.tableQuery.type&&Object(o.P)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var c=n(4),u=n(131),s=n(1343),d=n(1120),f=n(40),l=n(21),b=Object(c.createStore)("publicFolderUtilsStore",new l.ObservableMap);function O(e){if(!b().has(e)){var t=d.a.folderTable.get(e),n=null!=t.ReplicaList?t.ReplicaList[0]:Object(f.a)().SessionSettings.DefaultPublicFolderMailbox,r={type:null,deprecatedMailboxId:e,primarySmtpAddress:t.principalSMTPAddress,routingKey:Object(u.c)()+n,returnModernConversationItems:null,requestOptions:Object(s.a)(n)};v(e,r)}return b().get(e)}var v=Object(c.mutatorAction)("addPublicFolderMailboxInfoToStore",function(e,t){b().set(e,t)});n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return O})},2082:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(732);function o(e){return Object(r.L)(e,r.l)}},2137:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c}),n.d(t,"a",function(){return u});var r=n(52),o=n(2222);n.d(t,"d",function(){return o.a});var i=new r.c(function(){return n.e(327).then(n.bind(null,4592))}),a=new r.a(i,function(e){return e.onKeyboardUpDown}),c=new r.a(i,function(e){return e.onOpenEmail}),u=new r.a(i,function(e){return e.onKeyboardToggleSelect})},2221:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateItemJsonRequest:#Exchange"},e)}},2222:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(4),o=Object(r.action)("USERMAIL_INTERACTION",function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}})},2257:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(4),o=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),i=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},2372:function(e,t,n){"use strict";var r=n(4511),o=n(0),i=n(3371),a=n(3372);function c(e,t,n,r,c){return e.then(function(e){if(Object(i.a)(t,n,c),e.ResponseMessages){var u=function(e,t){var n,r;try{for(var i=Object(o.__values)(e),c=i.next();!c.done;c=i.next()){var u=c.value;if(u&&"Success"!=u.ResponseClass){Object(a.a)(t);var s=new Error("ResponseCode="+u.ResponseCode+", Stacktrace="+u.StackTrace);return s.fetchErrorType="ServerFailure",s}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return null}(e.ResponseMessages.Items,r);return u?Promise.reject(u):Promise.resolve()}return Promise.reject(new Error("processUpdateItemActionResponseMessage empty response"))}).catch(function(e){return Object(i.a)(t,n,c),Object(a.a)(r),Promise.reject(e)})}var u=n(3727);n.d(t,"d",function(){return r.a}),n.d(t,"e",function(){return c}),n.d(t,"a",function(){return u.a}),n.d(t,"b",function(){return i.a}),n.d(t,"c",function(){return a.a})},2388:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),o=n(1782);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetAttachmentPreviews",e,t)}},2390:function(e){e.exports={a:"ioa"}},2610:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},2655:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1586),o=n.n(r),i=n(743),a=n.n(i),c=n(1378),u=n.n(c);function s(e,t){var n;return u()({Path:a()({FieldURI:e}),Item:o()((n={},n[e]=t,n))})}},2741:function(e){e.exports={a:"T5a",b:"U5a"}},2752:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),o=n(874),i=n(3817),a=n.n(i);function c(e,t,n){if(void 0===t&&(t=Object(o.getJsonRequestHeader)()),!e||!e.ConversationActions||0===e.ConversationActions.length)throw new Error("ApplyConversationAction requestBody is invalid!");n=n||{};var i=Object(r.__assign)({},n),c=i.headers?new Headers(i.headers):new Headers;return c.set("X-OWA-ActionSource","ApplyConversationAction_"+e.ConversationActions[0].Action),i.headers=c,a()({Header:t,Body:e},i).then(function(e){return e.Body.ResponseMessages.Items[0]}).catch(function(e){return Promise.reject(e)})}},2753:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ApplyConversationActionRequest:#Exchange"},e)}},2754:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConversationAction:#Exchange"},e)}},3329:function(e){e.exports={a:"GAb"}},3371:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(973);function o(e,t,n){n&&r.a.removeRowsFromTombstone(e,t)}},3372:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(2009);function o(e){e&&Object(r.a)(e)}},3727:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),o=n(740);function i(e){var t,n;if(!e)return Promise.reject(a("500","Server returned a null response!"));var i=Array.isArray(e)?e:[e];try{for(var c=Object(r.__values)(i),u=c.next();!u.done;u=c.next()){var s=u.value;if(s&&!Object(o.d)(s))return Promise.reject(a(s.ResponseCode,s.StackTrace))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return Promise.resolve()}function a(e,t){var n=new Error("ResponseCode="+e+", Stacktrace="+t);return n.fetchErrorType="ServerFailure",n}},3728:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(747),o=n.n(r),i=n(778),a=n.n(i);function c(e){return e?a()({BaseFolderId:o()({Id:e})}):null}},3817:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(129),o=n(3818);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("ApplyConversationAction",e,t)}},3818:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ApplyConversationActionJsonRequest:#Exchange"},e)}},3913:function(e,t,n){"use strict";function r(e){return e?new Date(e).toISOString():null}n.d(t,"a",function(){return r})},3914:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(885);function o(e,t){var n={};return e.forEach(function(e){Object(r.a)(e,t).itemIds.forEach(function(e){n[e]||(n[e]=!0)})}),Object.keys(n)}},4224:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(731),i={markConversationAsRead:{name:function(e,t,n,r,o,i,a){var c="TnS_MarkConversation";return c+=n?"Read":"Unread",r||(c+="Background"),c},options:function(e,t,n,r,o,i,a){return r?{isCore:!0}:{}},customData:function(e,t,n,r,i,a,c){return[i,e.length,Object(o.l)(t),Object(o.I)(t)]},cosmosOnlyData:function(e,t,n,i,a,c,u){var s,d,f=[],l=Object(o.A)(e,t);try{for(var b=Object(r.__values)(l),O=b.next();!O.done;O=b.next()){var v=O.value;f.push(o.b.getItemIds(v,t))}}catch(e){s={error:e}}finally{try{O&&!O.done&&(d=b.return)&&d.call(b)}finally{if(s)throw s.error}}return JSON.stringify({itemIds:f,conversationIds:e})}},markItemReadUnread:{name:function(e,t,n,r,o,i){var a="TnS_MarkItem";return a+=n?"Read":"Unread",r||(a+="Background"),a},options:function(e,t,n,r,o,i){return r?{isCore:!0}:{}},customData:function(e,t,n,r,i,a){var c=e?e.tableQuery.type:null,u=e?Object(o.l)(e):null,s=e?Object(o.I)(e):null;return[c,t.length,u,s]},cosmosOnlyData:function(e,t,n,r,o,i){return JSON.stringify({itemIds:t})},actionSource:function(e,t,n,r,o){return o}}},a=n(758);var c=n(69),u=n(4),s=Object(u.createStore)("markread",{markAsReadTimerTask:null,suppressedItemIdsMap:{}})(),d=Object(c.action)("AddMarkReadSuppressedItemIds")(Object(c.select)({store:function(){return s}})(function(e,t){e.forEach(function(e){return t.store.suppressedItemIdsMap[e]=!0})})),f=Object(c.action)("RemoveMarkReadSuppressedItemIds")(Object(c.select)({store:function(){return s}})(function(e,t){e.forEach(function(e){return delete t.store.suppressedItemIdsMap[e]})})),l=Object(c.action)("ClearMarkReadSuppressedMap")(Object(c.select)({store:function(){return s}})(function(e){e.store.suppressedItemIdsMap={}}));function b(e){for(var t=0;t<e.length;t++)if(!s.suppressedItemIdsMap[e[t]])return!1;return!0}var O=n(2655),v=n(40),m=n(1321),j=n.n(m),p=n(745),y=n.n(p),I=n(1909),g=n.n(I),h=n(1950),R=n.n(h),_=n(191);function A(e,t,n){var r=function(e,t){var n="AlwaysSend"!=Object(v.a)().UserOptions.ReadReceipt,r=Object(O.a)("IsRead",t),o=[];return e.forEach(function(e){return o.push(j()({Updates:[r],ItemId:y()({Id:e})}))}),R()({ItemChanges:o,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:n})}(e,t);return g()({Header:Object(_.getJsonRequestHeader)(),Body:r},n).then(function(e){return e.Body.ResponseMessages.Items[0]})}var w=n(5446),S=n(2137),M=n(1855),T=n(869),k=n(62),C=n(49),E=n(2372),x=Object(C.c)("markItemsAsReadBasedOnItemIds",i.markItemReadUnread)(function(e,t,n,i,c,u){return Object(r.__awaiter)(this,void 0,void 0,function(){var s,l,b,O;return Object(r.__generator)(this,function(r){return 0==(s=function(e,t){var n=[];return e.forEach(function(e){var r=a.a.items.get(e);Object(o.M)(r)&&r.IsRead!=t&&n.push(e)}),n}(t,n)).length?[2,Promise.resolve()]:(n?f(s):i?d(s):k.d.warn("Invalid scenario to implicitly mark item as unread."),l=e?e.id:null,Object(M.a)(s,n,i,l),w.a.import().then(function(t){t(e?e.tableQuery:null,!1,n,c,s)}),n?i?Object(S.d)("MarkAsRead",u):Object(S.d)("MarkAsReadImplicit",u):Object(S.d)("MarkAsUnread",u),b=Object(T.b)(e).requestOptions,O=e?Object(o.A)(s,e):[],[2,P(e,O,s,n,b)])})})});function P(e,t,n,r,o){return A(n,r,o).then(function(e){return Object(E.a)(e)}).catch(function(n){var r=e?e.serverFolderId:null;return Object(E.b)(t,r,!0),Promise.reject(n)})}var F=Object(c.action)("autoMarkItemAsRead")(function(e,t){Object(o.f)(t)&&(b([e])||(x(t,[e],!0,!1,null,[]),l()))}),U=Object(c.action)("onItemPartDeselected")(function(e,t){t&&"OnSelectionChange"==Object(v.a)().UserOptions.PreviewMarkAsRead&&F(e,t)}),D=n(3913),V=n(3728),K=n(2753),N=n.n(K),B=n(2754),q=n.n(B),L=n(2752);function Q(e,t,n){var r=Object(V.a)(n),o=e.map(function(e){return function(e,t,n){return q()({Action:"SetReadState",ConversationId:y()({Id:e.conversationId}),IsRead:t,ConversationLastSyncTime:Object(D.a)(e.conversationLastSyncTimeStamp),SuppressReadReceipts:!0,ContextFolderId:n})}(e,t,r)});return N()({ConversationActions:o,ReturnMovedItemIds:!1})}var H=n(1854),G=n(1477);var J=Object(C.c)("markConversationsAsReadBasedOnConversationIds",i.markConversationAsRead)(function(e,t,n,i,a,c,u){var s=function(e,t,n){var r=[];return e.forEach(function(e){var i=Object(o.F)(e,t);i&&i.unreadCount>0===n&&r.push(e)}),r}(u,t.id,n);if(0==s.length)return Promise.resolve();if(1==e.length&&1==t.selectedRowKeys.size){var f=o.b.getRowIdString(s[0],t),b=Object(o.F)(Object(r.__spread)(t.selectedRowKeys.keys())[0],t.id);if(f==b.id){var O=b.itemIds;n?l():i?d(O):k.d.warn("Invalid scenario to implicitly mark conversation as unread.")}}Object(H.a)(e,t.id,n,i),w.a.import().then(function(r){r(t.tableQuery,!1,n,a,e)}),n?i?Object(S.d)("MarkAsRead",c):Object(S.d)("MarkAsReadImplicit",c):Object(S.d)("MarkAsUnread",c);var v=Object(T.b)(t).requestOptions;return Object(o.e)(t)?function(e,t,n,i){var a=[];return t.forEach(function(t){a.push.apply(a,Object(r.__spread)(o.b.getItemIds(t,e)))}),P(e,t,a,n,i)}(t,s,n,v):function(e,t,n,r,i){var a=Object(G.a)(e),c=function(e,t,n,r){var o=Q(e,t,n);return Object(L.a)(o,void 0,r)}(t.map(function(t){return Object(o.h)(t,e.id)}),n,a,i),u=Object(o.Q)(e,n,r);return Object(E.d)(c,t,a,e,u)}(t,s,n,i,v)});var W=n(885),z=Object(c.action)("autoMarkConversationAsRead")(Object(c.select)({items:function(){return a.a.items}})(function(e,t,n){var r=Object(o.A)([e],t),i=Object(W.a)(r[0],t.id);if(i&&Object(o.f)(t)){var a=i.itemIds;b(a)||(0==Object.keys(s.suppressedItemIdsMap).length?J([e],t,!0,!1,null,[],r):a.forEach(function(e){!b([e])&&n.items.get(e)&&x(t,[e],!0,!1,null,[])}),l())}}));function $(e,t){if("OnSelectionChange"===Object(v.a)().UserOptions.PreviewMarkAsRead){var n=o.b.getRowIdString(e,t);switch(t.tableQuery.listViewType){case 0:z(n,t);break;case 1:F(n,t)}}}var X=n(864),Y=Object(c.action)("onReadingPaneClosed")(function(e,t){Object(X.p)()||k.d.error("onReadingPaneClosed should only be called in single line view."),$(e,t)}),Z=Object(c.action)("onSingleSelectionChanged")(function(e,t,n){Object(X.p)()||n&&$(e,t)}),ee=Object(u.action)("MARK_ITEMS_READ_BASED_ON_NODE_IDS",function(e,t,n,r,o){return{nodeIds:e,tableViewId:t,isReadValueToSet:n,isExplicit:r,actionSource:o}}),te=Object(c.action)("markItemAsReadFromReadingPane")(function(e,t,n,r,i){var c=[],u=null;if(t){if(1==t.tableQuery.listViewType)c=Object(o.A)([e],t);else{var s=a.a.items.get(e).ConversationId.Id;c=Object(o.A)([s],t)}u=Object(o.k)(t)}x(t,[e],n,!0,i,r).then(function(){t&&Object(E.b)(c,u)}).catch(function(e){t&&(Object(E.b)(c,u),Object(E.c)(t))})}),ne=n(1581),re=Object(c.action)("markConversationsAsReadFromTable")(function(e,t,n,r){var i=Object(o.y)(e,t.id),a=Object(ne.a)(e,t);return J(i,t,n,!0,r,a,e)}),oe=Object(c.action)("markItemsReadFromTable")(function(e,t,n,r,i){var a=Object(o.y)(e,t.id),c=Object(ne.a)(e,t),u=x(t,a,n,r,i,c),s=Object(o.k)(t),d=Object(o.Q)(t,n,r);u.then(function(t){Object(E.b)(e,s,d)}).catch(function(n){Object(E.b)(e,s,d),Object(E.c)(t)})}),ie=n(2257),ae=Object(c.action)("toggleRowReadState")(function(e,t,n){var r=o.O.tableViews.get(t),i=o.b.getUnreadCount(e,r)>0;switch(r.tableQuery.listViewType){case 0:re([e],r,i,n);break;case 1:oe([e],r,i,!0,n)}Object(ie.b)()}),ce=Object(c.action)("onNavigateAwayViaUpDown")(function(e,t){$(e,t)}),ue=Object(u.action)("onKeyboardMarkAsRead",function(e,t,n,r,o,i){return{tableView:e,selectedNodeIds:t,isInVirtualSelectAllMode:n,rowKeysToActOn:r,exclusionList:o,isReadValueToSet:i}}),se=Object(u.action)("markReadOnTableViewChange",function(e,t){return{oldTableView:e,newTableView:t}}),de=n(151),fe=n(772),le=n(7),be=n(732),Oe=n(5),ve=n(4830),me=n(3329),je=n(2390),pe=n(1602),ye=n(1637),Ie=n(3914),ge=n(10584),he=n.n(ge),Re=n(10585),_e=n.n(Re);var Ae=n(6149),we=n(2082),Se=n(1237),Me=n(10587),Te=Object(c.action)("markAsReadInTable")(function(e,t,n,i,a,c,u){var s=this;if(a.length&&n)throw new Error("If in virtual select all mode, rowKeysToActOn should be empty.");if(t.length&&!n)throw new Error("If not in virtual select all mode, exclusionList should be empty.");var d=c.tableQuery.folderId,f=be.p.folderTable.get(d),l=n&&f&&f.UnreadCount>=Ae.b||Object(o.q)(c)&&a.length>=Ae.b,b=Object(o.o)(Object(o.l)(c),Object(o.p)(c.id),c.tableQuery.type,f&&Object(be.w)(f)),O=u?Object(Oe.a)(ve.a):Object(Oe.a)(me.a),m=i?O:Object(Oe.a)(je.a),j=i?Object(Oe.b)(Object(Oe.a)(Me.a),b):Object(Oe.b)(Object(Oe.a)(Me.b),b);Object(fe.b)(m,j,!l,{delayCallbackAfterAnimation:!0,okText:Object(Oe.a)(pe.a)}).then(function(u){return Object(r.__awaiter)(s,void 0,void 0,function(){var s,f,l,b;return Object(r.__generator)(this,function(r){if(u===fe.a.ok)if(Se.b(),n)s=Object(v.a)().UserOptions.ReadReceipt,f="DoNotAutomaticallySend"==s||"NeverSend"==s||Object(we.a)(d),l=Object(o.L)(d)?Object(le.m)(o.O.inboxPausedDateTime):null,function(e,t,n){var r="TnS_MarkAllAs";r+=t?"Read":"Unread",Object(de.m)(r,[e,Object(o.l)(n),n.isInCheckedMode])}(e,i,c),w.a.import().then(function(t){t(c.tableQuery,!0,i,e)}),Object(ye.a)(c,i,t),b=Object(Ie.a)(t,c.id),function(e,t,n,r,o,i){var a=null!=n?n.map(function(e){return y()({Id:e})}):void 0;_e()({Header:Object(_.getJsonRequestHeader)(),Body:he()({ReadFlag:t,SuppressReadReceipts:r,FromFilter:null,FolderIds:[e],ItemIdsToExclude:a,ClientLastSyncTime:i&&i.toISOString()})},o).then(function(e){return e.Body.ResponseMessages.Items[0]})}(Object(o.j)(c),i,b,f,Object(T.b)(c).requestOptions,l);else switch(c.tableQuery.listViewType){case 0:re(a,c,i,e);break;case 1:oe(a,c,i,!0,e)}return[2]})})})});var ke=n(905),Ce=Object(c.action)("setAutoMarkAsReadTimer")(Object(c.select)({markAsReadDelaytime:function(){return Object(v.a)().UserOptions.MarkAsReadDelaytime},store:function(){return s},userOptions:function(){return Object(v.a)().UserOptions}})(function(e,t,n){var r=Object(ke.a)();if(r&&Object(o.f)(r)){var i=n.markAsReadDelaytime,a=n.store;"Delayed"==n.userOptions.PreviewMarkAsRead&&(a.markAsReadTimerTask=setTimeout(function(){xe(e,r,t)},1e3*i))}})),Ee=Object(c.action)("clearAutoMarkAsReadTimer")(Object(c.select)({store:function(){return s}})(function(e){e.store.markAsReadTimerTask&&(clearTimeout(e.store.markAsReadTimerTask),e.store.markAsReadTimerTask=null)})),xe=Object(c.action)("setMarkAsReadTimer:timeout")(function(e,t,n){if(Ee(),n)F(e,t);else switch(t.tableQuery.listViewType){case 0:z(e,t);break;case 1:F(e,t)}}),Pe=n(4925),Fe=(Object(u.orchestrator)(ee,function(e){var t=Object(Pe.a)(e.nodeIds),n=o.O.tableViews.get(e.tableViewId);x(n,t,e.isReadValueToSet,e.isExplicit,e.actionSource,null)}),n(893)),Ue=n(1834),De=n(1753);Object(u.orchestrator)(Fe.q,function(e){var t=Object(Ue.b)(e.nodeIdToSelect);t&&(De.a.importAndExecute(),De.k.importAndExecute(t.ItemId.Id,!0))});Object(u.orchestrator)(ue,function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.isInVirtualSelectAllMode,o=e.rowKeysToActOn,i=e.exclusionList,a=e.isReadValueToSet;n.length>0?ee(n,t.id,a,!0,"Keyboard"):Te("Keyboard",i,r,a,o,t)}),Object(u.orchestrator)(se,function(e){var t=e.oldTableView,n=e.newTableView;Object(X.p)()||1!==t.selectedRowKeys.size||"Unread"===Object(o.I)(n)||$(Object(r.__spread)(t.selectedRowKeys.keys())[0],t)});n.d(t,"onItemPartDeselected",function(){return U}),n.d(t,"onReadingPaneClosed",function(){return Y}),n.d(t,"onSingleSelectionChanged",function(){return Z}),n.d(t,"markItemsAsReadBasedOnNodeIds",function(){return ee}),n.d(t,"markItemAsReadFromReadingPane",function(){return te}),n.d(t,"toggleRowReadState",function(){return ae}),n.d(t,"onNavigateAwayViaUpDown",function(){return ce}),n.d(t,"onKeyboardMarkAsRead",function(){return ue}),n.d(t,"markReadOnTableViewChange",function(){return se}),n.d(t,"markAsReadInTable",function(){return Te}),n.d(t,"clearAutoMarkAsReadTimer",function(){return Ee}),n.d(t,"setAutoMarkAsReadTimer",function(){return Ce})},4511:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3371),o=n(3372),i=n(3727);function a(e,t,n,a,c){return e.then(function(e){return Object(r.a)(t,n,c),Object(i.a)(e)}).catch(function(e){return Object(r.a)(t,n,c),Object(o.a)(a),Promise.reject(e)})}},4830:function(e){e.exports={a:"HAb"}},4925:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),o=n(1834);function i(e){var t,n,i=[];try{for(var a=Object(r.__values)(e),c=a.next();!c.done;c=a.next()){var u=c.value,s=Object(o.b)(u);s&&i.push(s.ItemId.Id)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}},5446:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c});var r=n(52),o=new r.c(function(){return n.e(285).then(n.bind(null,8905))}),i=new r.b(o,function(e){return e.addMarkAsReadDiagnostics}),a=new r.b(o,function(e){return e.addUnreadCountNotificationDiagnostics}),c=new r.b(o,function(e){return e.addUnreadCountSubscriptionDiagnostics})},6149:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var r=1e4,o=25},869:function(e,t,n){"use strict";var r=n(1236),o=n(731);function i(){return Object(r.a)(Object(o.B)())}n.d(t,"b",function(){return r.a}),n.d(t,"c",function(){return r.c}),n.d(t,"a",function(){return i})},973:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",function(){return s}),n.d(r,"remove",function(){return d}),n.d(r,"removeAll",function(){return f}),n.d(r,"getCount",function(){return l}),n.d(r,"getTombstonedReasons",function(){return b}),n.d(r,"clearMapForFolder",function(){return O}),n.d(r,"removeRowsFromTombstone",function(){return v});var o=n(0),i=n(4),a=Object(i.createStore)("tombstone",{folderTombstoneMap:{}}),c=(a(),n(151)),u=n(69),s=Object(u.action)("tombstoneOperations.add")(function(e,t,n){var r=a().folderTombstoneMap;t in r||(r[t]={});var o=r[t];e.forEach(function(e){var t=o[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):o[e]=[3]:o[e]=[n]})}),d=Object(u.action)("tombstoneOperations.remove")(function(e,t,n){var r=a().folderTombstoneMap;if(t in r){var o=r[t],i=o[e],c=i?i.indexOf(n):-1;if(-1==c)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");i.splice(c,1),0==i.length&&delete o[e],0==Object.keys(o).length&&delete r[t]}}),f=Object(u.action)("tombstoneOperations.removeAll")(function(){a().folderTombstoneMap={},Object(c.n)("TnS_RemoveAllFromTombstone")}),l=function(e,t){var n=a().folderTombstoneMap;if(!(e in n))return 0;var r=0,o=n[e];return Object.values(o).forEach(function(e){e==t&&r++}),r},b=function(e,t){var n=a().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},O=Object(u.action)("tombstoneOperations.clearMapForFolder")(function(e){var t=a().folderTombstoneMap;t[e]&&(Object(c.n)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])}),v=Object(u.action)("tombstoneOperations.removeRowsFromTombstone")(function(e,t){var n,r,i=a().folderTombstoneMap;if(t in i){var c=i[t];try{for(var u=Object(o.__values)(e),s=u.next();!s.done;s=u.next()){var d=s.value;d in c&&delete c[d]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}0==Object.keys(c).length&&delete i[t]}});t.a=r}},0,[1,2,22,577,185,0,578,189,7,379,3,8,13,16,361,10,79,4,12,131,37,127,342,376,541]]);
//# sourceMappingURL=owa.MarkRead.js.map
self.scriptsLoaded['owa.MarkRead.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MarkRead.js'] = (new Date()).getTime();