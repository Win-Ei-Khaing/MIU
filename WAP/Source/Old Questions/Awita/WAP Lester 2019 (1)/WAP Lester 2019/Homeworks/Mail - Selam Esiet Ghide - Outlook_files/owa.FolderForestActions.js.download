self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FolderForestActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[255],{10659:function(e){e.exports={c:"OEb",a:"PEb",b:"QEb"}},14123:function(e,t,r){"use strict";r.r(t);var o=r(0),n=r(2968),a=r(2061),i=r(2967),c=r(1724),d=r(2444),s=r(2060),l=r(2445),u=r(151),b=r(771),f=r(732),v=r(1316),F=r(861),O=r(2879),j=r(2808);function h(e){return!0===j.a.prefetchedFolderIds.get(e)}var p=r(65),y=r(49),m=r(2100),g=r(731),I=r(737),P=r(7),w=Object(y.c)("selectPersona",c.a.selectPersona)(function(e){var t;if(Object(m.a)("üèÉ‚Äç SelectPersonaToPersonaHeaderRender"),e!==Object(F.c)().id){var r=Object(p.f)("tri-favorites-roaming"),o=void 0;if(r){var n=Object(b.getStore)().outlookFavorites.get(e);o=n?Object(b.convertFavoritePersonaDataToFavoritePersonaNode)(n):void 0}else o=Object(b.getStore)().favoritesPersonaNodes.get(e);if(!o)return Object(s.a)("ResetInbox"),Promise.resolve();var a=!1;Object(v.isFavoritingInProgress)(o.personaId)||Object(v.isFavoritingInProgress)(o.mainEmailAddress)||f.p.folderTable.has(o.searchFolderId)||(a=!0,o.searchFolderId=void 0,o.isSearchFolderPopulated=!1);var i=!o.isSearchFolderPopulated,c=o.searchFolderId&&h(o.searchFolderId),j=Object(u.o)();if(j&&j.addCustomData({isSearchFallback:i,searchFolderNotFound:a,isPrefetchedFuf:!!c}),t=Object(l.a)(o,"FavoritesPersonaNode"),r||v.lazyOnFavoritePersonaSelected.importAndExecute(o.id),o.searchFolderId&&(Object(O.b)(o.searchFolderId),Object(g.L)(Object(I.a)("inbox")))){var y=f.p.folderTable.get(o.searchFolderId).TotalCount;Object(u.m)("TnS_PauseSelectPersona",[y-f.p.folderTable.get(o.searchFolderId).pausedTotalCount,Object(P.m)(g.O.inboxPausedDateTime),g.O.inboxPausedLength?g.O.inboxPausedLength:-1],{isCore:!0}),f.p.folderTable.get(o.searchFolderId).pausedTotalCount=y}}return Object(d.a)(),t}),T=Object(y.c)("selectPrivateDistributionList",c.a.selectPrivateDistributionList)(function(e){var t;if(e!=Object(F.c)().id){var r=Object(b.getStore)().outlookFavorites.get(e);if(!r)return Object(s.a)("ResetInbox"),Promise.resolve();var o=Object(b.convertFavoritePdlDataToFavoritePdlNode)(r),n=!1;Object(v.isFavoritingInProgress)(o.data.favoriteId)||f.p.folderTable.has(o.data.searchFolderId)||(n=!0,o.data.searchFolderId=void 0,o.data.isSearchFolderPopulated=!1);var a=!o.data.isSearchFolderPopulated,i=o.data.searchFolderId&&h(o.data.searchFolderId),c=Object(u.o)();c&&c.addCustomData({isSearchFallback:a,searchFolderNotFound:n,isPrefetchedFuf:!!i}),t=Object(l.a)(o,"FavoritesPrivateDistributionList"),o.data.searchFolderId&&Object(O.b)(o.data.searchFolderId)}return Object(d.a)(),t}),_=r(4),S=Object(_.action)("SELECT_PREVIOUS_NODE_INTERNAL",function(e){return{actionSource:e}}),E=r(1022),k=(Object(_.orchestrator)(S,function(e){return Object(o.__awaiter)(void 0,void 0,void 0,function(){var t,r,c,d;return Object(o.__generator)(this,function(o){switch(t=e.actionSource,r=E.v,c=r.previousNode,(d=c||Object(F.c)()).type){case 1:w(d.id);break;case 5:T(d.id);break;case 0:case 6:Object(a.a)(d.id,d.treeType,t,d.type);break;case 4:Object(n.a)(d.id);break;case 2:Object(i.a)(d.id,d.treeType);break;default:throw new Error("exitSearchOrchestrator: Unknown node type")}return[2]})})}),r(10659)),N=r(5),x=r(772),U=r(2744),M=r(191),q=r(2443),C=r.n(q),D=r(747),L=r.n(D),R=r(2442),z=r.n(R);var A=r(1237),V=r(69),B=Object(V.action)("deleteFolder")(function(e,t,r,n){return Object(o.__awaiter)(this,void 0,void 0,function(){var a,i;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return a=e.folderTable.get(t),A.b(),Object(f.db)(e,a),i=Object(f.t)(a.FolderId.Id),Object(U.a)(i),r?Object(f.q)(e,i):Object(f.Z)(e,a,n),[4,(c=t,d=r,C()({Header:Object(M.getJsonRequestHeader)(),Body:z()({DeleteType:d?"SoftDelete":"MoveToDeletedItems",FolderIds:[L()({Id:c})]})}).then(function(e){return e.Body.ResponseMessages.Items[0]}))];case 1:return o.sent(),[2]}var c,d})})}),H=r(4769),Q=r(2241),J=Object(V.action)("deleteFolderInFolderForest")(Object(V.select)({favoritesFolderNodesV1:function(){return b.favoritesStore.favoritesFolderNodes},favoritesFolderNodesV2:function(){return b.favoritesStore.outlookFavorites},folders:function(){return f.p}})(function(e,t,r,n,i){var c=this,d=i.favoritesFolderNodesV1,s=i.favoritesFolderNodesV2,l=i.folders,u=Object(f.t)(e),b=l.folderTable.get(e),O=n?Object(N.a)(k.c):Object(N.a)(k.a);Object(x.b)(Object(N.a)(k.b),Object(N.b)(O,b.DisplayName)).then(function(i){return Object(o.__awaiter)(c,void 0,void 0,function(){return Object(o.__generator)(this,function(c){return i===x.a.ok?(u.forEach(function(e){!function(e,t,r,n){Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(o){switch(o.label){case 0:return Object(p.f)("tri-favorites-roaming")?r.has(e)?[4,v.lazyRemoveFavoriteFolder.import()]:[3,2]:[3,3];case 1:o.sent()(e,n),o.label=2;case 2:return[3,5];case 3:return t.has(e)?[4,v.lazyRemoveFavoriteFolder.import()]:[3,5];case 4:o.sent()(e,n),o.label=5;case 5:return[2]}})})}(e,d,s,t),e==Object(F.b)()&&Object(a.a)(Object(I.a)("inbox"),"primaryFolderTree","ResetInbox")}),Object(f.L)(e,f.l)?[2,Q.c.importAndExecute(r,e,f.j,!0)]:[2,B(l,e,n,r)]):[2]})})}),H.c.importAndExecute(e)}));var K=r(1571),$=Object(V.action)("toggleFavoriteFolder")(function(e,t){return Object(o.__awaiter)(this,void 0,void 0,function(){var r,n;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return r=Object(K.f)(e),n=r||e.FolderId.Id,Object(b.isFolderInFavorites)(n)?(n==Object(F.b)()&&Object(a.a)(Object(I.a)("inbox"),"primaryFolderTree","ResetInbox"),[4,v.lazyRemoveFavoriteFolder.import()]):[3,2];case 1:return o.sent()(n,t),[3,4];case 2:return[4,v.lazyAddFavoriteFolder.import()];case 3:o.sent()(n,t),o.label=4;case 4:return[2]}})})}),G=r(1222),Z=Object(V.action)("selectFolderNode")(function(e,t){var r=e||Object(F.c)();switch(r.type){case 1:G.f.importAndExecute(r.id);break;case 5:G.h.importAndExecute(r.id);break;case 0:Object(G.o)(r.id,r.treeType,t);break;case 4:Object(G.m)(r.id);break;case 2:Object(G.q)(r.id,r.treeType);break;default:throw new Error("selectFolderNode: Unknown node type")}}),W=r(3667),X=r(3666),Y=r(40),ee=r(62),te=Object(V.action)("initializeFrequentlyUsedFolders")(function(){var e=Object(Y.a)().UserOptions,t=!1,r=Object(j.b)();r.isInitialized||(e.FrequentlyUsedFolders&&e.FrequentlyUsedFolders.forEach(function(e){try{var o=JSON.parse(e);r.frequentlyUsedFolders.push(o)}catch(e){ee.d.warn("Unable to parse frequently used folders"),t=!0}}),r.isInitialized=!0,t&&Object(X.a)())}),re=r(1260),oe=r(1878),ne=r(905),ae=r(1294),ie=r(2830),ce=r(221),de=r.n(ce),se=r(2676),le=r(1638),ue=r(1032),be=r(2964),fe=r(212);function ve(e){if("UserCategory"!=e.filterType)throw new Error("getQueryTypeForFilteredFolder should only be called for 'UserCategory' viewfilter type");var t=Object(fe.i)(e.filterValue,Object(fe.m)());return t?Object(re.b)(t):null}var Fe=Object(V.action)("prefetchFrequentlyUsedFolders")(function(){te(),setTimeout(Oe,1e4)});function Oe(){var e=Object(j.b)(),t=Math.min(5,e.frequentlyUsedFolders.length),r=[];de()(function(){for(var n=0;n<t;n++){var a=e.frequentlyUsedFolders[n].FolderId,i=null;if(pe(a)){var c=he(a);if(!c||"UserCategory"!=c.filterType)continue;i=ve(c)}else i=Object(re.c)(a,Object(g.w)(a),je(a),-1,null,null,Object(le.a)(a));if(i){var d=Object(ae.c)(i),s=Object(ne.a)();if(s&&s.id!=d.id&&Object(se.a)()&&-1==Object(se.b)(d)){var l=Object(oe.a)(d,!0,ie.a);r.push(l),Object(W.a)(a)}}}!function(e){var t=Object(j.b)();Object(u.m)("prefetchFrequentlyUsedFolders_count",{total:e,personaTotal:t.frequentlyUsedFolders.slice(0,e).filter(function(e){return Object(b.isFolderPersonaFavoriteSearchFolder)(e.FolderId)}).length,allPrefetched:t.prefetchedFolderIds.size,personaPrefetched:Object(o.__spread)(t.prefetchedFolderIds.keys()).filter(function(e){return Object(b.isFolderPersonaFavoriteSearchFolder)(e)}).length})}(t),Promise.all(r).then(function(){!function(){var e,t,r=0,n=0,a=0,i=0,c=0,d=0,s=Object(I.a)("inbox"),l=g.O.tableViews.values();try{for(var b=Object(o.__values)(l),f=b.next();!f.done;f=b.next()){var v=f.value,F=v.tableQuery,O=F.folderId;if(0!=F.type)return;d++,Object(ue.l)(F)&&c++;for(var j=0,h=0;h<v.rowKeys.length;h++){var p=v.rowKeys[h],y=g.b.getIsPinned(p,v);if(!y)break;j++}O===s&&"All"===F.viewFilter&&(n+=j),r+=j,j>=20?a++:j>=10&&i++}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=b.return)&&t.call(b)}finally{if(e)throw e.error}}Object(u.m)("TnS_PinnedRowsCount",{total:r,inbox:n,tfc:d,pfc:c,ftwenty:a,ften:i})}()})})}function je(e){return Object(b.isFolderPersonaFavoriteSearchFolder)(e)?"persona":Object(b.isFolderPrivateDLFavoriteSearchFolder)(e)?"privatedistributionlist":"mail"}function he(e){var t=e.split(be.a);return 2==t.length?{filterType:t[0],filterValue:t[1]}:null}function pe(e){return["SystemCategory","Hashtag","UserCategory"].reduce(function(t,r){return t||e.slice(0,r.length)==r},!1)}r.d(t,"deleteFolderInFolderForest",function(){return J}),r.d(t,"selectPersona",function(){return w}),r.d(t,"selectPrivateDistributionList",function(){return T}),r.d(t,"toggleFavoriteFolder",function(){return $}),r.d(t,"selectFolderNode",function(){return Z}),r.d(t,"selectPreviousNodeInternal",function(){return S}),r.d(t,"prefetchFrequentlyUsedFolders",function(){return Fe})},2100:function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return a});var o="undefined"!=typeof window&&window.hasOwnProperty("Performance")&&Performance.prototype.getEntriesByName;function n(e){var t,r,n,a;t=e+" - start",o&&(null===(a=null===(r=performance)||void 0===r?void 0:(n=r).mark)||void 0===a||a.call(n,t))}function a(e){var t,r,n,a,i,c;if(o){try{null===(n=null===(t=performance)||void 0===t?void 0:(r=t).measure)||void 0===n||n.call(r,e,e+" - start")}catch(e){return}var d=performance&&performance.getEntriesByName(e);return null===(c=null===(a=performance)||void 0===a?void 0:(i=a).clearMarks)||void 0===c||c.call(i,e+" - start"),d&&d.length>0?d.slice(-1)[0]:void 0}}},3548:function(e,t,r){"use strict";r.d(t,"b",function(){return n});var o=r(4),n=Object(o.createStore)("mruFolderCache",{mruFolders:[],isInitialized:!1}),a=n();t.a=a},4523:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(129);t.default=function(e){return o.makeServiceRequest("GetFolderMruConfiguration",{},e)}},4769:function(e,t,r){"use strict";var o=r(52),n=r(4523),a=r.n(n);var i=r(3548),c=r(737),d=r(69),s=Object(d.action)("getMoveToMruList")(function(){a()().then(function(e){return e}).then(function(e){return function(e){if(null==e.FolderMruEntries||0==e.FolderMruEntries.length)i.a.mruFolders.push(Object(c.a)("inbox")),i.a.mruFolders.push(Object(c.a)("deleteditems")),i.a.mruFolders.push(Object(c.a)("archive"));else for(var t=0;t<e.FolderMruEntries.length;t++){var r=e.FolderMruEntries[t].EwsFolderIdEntry;i.a.mruFolders.push(r)}i.a.isInitialized=!0}(e)})});r.d(t,"b",function(){return u}),r.d(t,"c",function(){return b}),r.d(t,"a",function(){return s});var l=new o.c(function(){return r.e(366).then(r.bind(null,14266))}),u=new o.a(l,function(e){return e.addFolderIdToMoveToMruList}),b=new o.a(l,function(e){return e.removeFolderIdFromMoveToMruList})}},0,[3,5,8,13,422,604,21,25,38,334,1,2,22,577,185,0,578,189,7,379,16,361,10,626,444,6,355,79,4,12,131,37,127,73,358,49,353,609,370,238,342,366,376,541,716]]);
//# sourceMappingURL=owa.FolderForestActions.js.map
self.scriptsLoaded['owa.FolderForestActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FolderForestActions.js'] = (new Date()).getTime();