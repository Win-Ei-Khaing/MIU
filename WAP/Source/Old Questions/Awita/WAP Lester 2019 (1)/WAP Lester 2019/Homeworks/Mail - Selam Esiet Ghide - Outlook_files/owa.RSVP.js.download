self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.RSVP.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[418],{4753:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(4),o=Object(i.action)("parseGetItemResponseAction",function(e,t){return{items:e,clientItemIds:t}}),a=Object(i.action)("tryPrefetchMeetingMessage",function(e,t,n){return{mailboxInfo:e,listViewType:t,shouldDelayPrefetch:n}}),s=Object(i.action)("removeMeetingMessagesFromStore",function(e){return{itemIds:e}}),d=n(3097),c=n(151),u=n(731),l=n(740),m=n(6150),I=n(842),f=n.n(I),g=n(743),b=n.n(g),h=n(221),R=n.n(h),v=n(62),j=[b()({FieldURI:"Start"}),b()({FieldURI:"End"}),b()({FieldURI:"AssociatedCalendarItemId"}),b()({FieldURI:"RecurrenceId"}),b()({FieldURI:"Recurrence"}),b()({FieldURI:"ConflictingMeetings"}),b()({FieldURI:"CalendarItemType"}),b()({FieldURI:"IsResponseRequested"}),b()({FieldURI:"Organizer"}),b()({FieldURI:"ItemClass"}),b()({FieldURI:"MeetingRequestType"}),b()({FieldURI:"ItemParentId"}),b()({FieldURI:"Sender"}),b()({FieldURI:"ConversationId"}),b()({FieldURI:"IsDelegated"}),b()({FieldURI:"ReceivedRepresenting"}),b()({FieldURI:"ResponseType"})];function O(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,a,s,d,I,g,b;return Object(r.__generator)(this,function(r){switch(r.label){case 0:(i=new c.a("LoadMeetingMessage")).addCustomProperty("count",e.length),a=e.map(function(e){return e.Id}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.q)(a,f()({BaseShape:"IdOnly",AdditionalProperties:j}),null)];case 2:return s=r.sent(),(d=s.filter(function(e){return Object(l.d)(e)})).length>0?(I=[],d.forEach(function(e){return I=I.concat(e.Items)}),g=e.filter(function(e){return I.some(function(t){return t.ItemId.Id===e.Id})}),o(I,g),i.end()):i.endWithError("ServerError"),d.length!==s.length&&v.d.warn("[loadingmeetingmessage] some items failed in: "+a),[3,4];case 3:return b=r.sent(),i.endWithError("ServerError",Error(b)),v.d.warn("[loadingmeetingmessage] all items failed in: "+a),[3,4];case 4:return function(e,t){t.forEach(function(t){if(1===e){var n=l.H.items.get(t.itemId);if(!n)return;if(Object(m.a)(t.itemId))return;v.d.warn("[loadingmeetingmessage] reverting shouldShowRSVP on item: "+t.itemId),n.shouldShowRSVP=!1}else{var r=Object(u.F)(t.rowKey,t.tableViewId);if(!r)return;if(Object(m.a)(t.itemId))return;v.d.warn("[loadingmeetingmessage] reverting shouldShowRSVP on tableConversationRelation for item: "+t.itemId),r.shouldShowRSVP=!1}})}(n,t),[2]}})})}Object(i.orchestrator)(a,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,i,o,a,s;return Object(r.__generator)(this,function(c){return t=e.listViewType,n=e.mailboxInfo,i=e.shouldDelayPrefetch,o=n.deprecatedMailboxId,a=d.b(o),d.c(o),a&&0!==a.length?(s=a.map(function(e){return{Id:e.itemId,mailboxInfo:n}}),i?R()(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return O(s,a,t),[2]})})}):O(s,a,t),[2]):[2]})})}),Object(i.mutator)(o,function(e){for(var t=e.items,n=e.clientItemIds,i=function(e){var i=t[e],o=n[e],a=Object(u.E)().meetingMessageItems.get(o.Id);if(a){Object.keys(a).forEach(function(e){i[e]&&(a[e]=i[e])})}else{var s=Object(r.__assign)(Object(r.__assign)({},i),{MailboxInfo:o.mailboxInfo,SmartTimeData:null,SmartTaskData:null,SmartTimeExtendedProperty:null,smartPillFeedbackSubmitted:!1});Object(u.E)().meetingMessageItems.set(o.Id,s)}},o=0;o<t.length;o++)i(o)}),Object(i.mutator)(s,function(e){var t=e.itemIds,n=Object(u.E)();t.forEach(function(e){n.meetingMessageItems.has(e)&&setTimeout(function(){n.meetingMessageItems.delete(e)},1e3)})}),n.d(t,"tryPrefetchMeetingMessage",function(){return a}),n.d(t,"removeMeetingMessagesFromStore",function(){return s})},6150:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(731);function i(e){var t=Object(r.E)().meetingMessageItems.get(e);if(!t)return null;var n=t;return n.Start&&n.End&&n.CalendarItemType?n:null}}},0,[0,1,2,578,189,541]]);
//# sourceMappingURL=owa.RSVP.js.map
self.scriptsLoaded['owa.RSVP.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.RSVP.js'] = (new Date()).getTime();