self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OwsGateway.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[392],{1052:function(t,e,n){"use strict";n.d(e,"c",function(){return i}),n.d(e,"b",function(){return a}),n.d(e,"a",function(){return u});var r=n(34),o=n(50);function i(){var t=Object(r.getCookie)("targetServer"),e="DefaultAnchorMailbox"+(t?"_"+t.toLocaleLowerCase():"");return Object(r.getCookie)(e)}function a(){var t="",e=Object(o.a)().pathname.split("/").filter(function(t){return t.length});return e.length>=2&&e[1].match(/.+@.+/)&&(t=e[1]),t}function u(){var t=a();return t||(t=i()),t}},1086:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(50),o=n(17),i=n(347);function a(t){var e=Object(r.a)(),n=Object(i.a)()+Object(o.a)("/owa",e.pathname)+"/",a=e.search&&e.search.length>0;n+=a?e.search:"?";for(var u=Object.keys(t),c=a,s=0;s<u.length;s++)c?n+="&":c=!0,n+=u[s]+"="+t[u[s]];return n}},121:function(t,e,n){"use strict";var r=n(336);n.d(e,"a",function(){return r.a})},1555:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,o=n(17),i=n(50);function a(){return r||(r=Object(o.a)("/people",Object(i.a)().pathname)+"/"),r}},161:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,o=!1;function i(e){r--,delete t[e]}this.put=function(e,n,o,a){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var u=t[e];u?clearTimeout(u.timeout):r++;var c={value:n,expire:o+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){i(e),a&&a(e,n)}.bind(this),o)),t[e]=c,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(e),n},this.clear=function(){for(var i in t)clearTimeout(t[i].timeout);r=0,t=Object.create(null),o&&(e=0,n=0)},this.get=function(i){var a=t[i];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return o&&e++,a.value;o&&n++,r--,delete t[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){o=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),o=Date.now(),i=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(i)if(t[a])continue;var u=r[a],c=u.expire-o;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,u.value,c)}return this.size()}}t.exports=new r,t.exports.Cache=r},251:function(t,e,n){"use strict";var r=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout(function(){t.tryRunTask()},this.taskDelay)},t.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.runTask=function(){var t=this,e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(function(){t.onTaskComplete()}).catch(function(){t.onTaskComplete()}),this.scheduleTask()},t}();n.d(e,"a",function(){return r})},298:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"TokenRequest:#Exchange"},t)}},3111:function(t,e,n){"use strict";n.d(e,"f",function(){return w}),n.d(e,"d",function(){return T}),n.d(e,"c",function(){return R}),n.d(e,"e",function(){return C}),n.d(e,"b",function(){return I}),n.d(e,"a",function(){return S});var r=n(0),o=n(65),i=n(121),a=n(3),u=n(797),c=n(1052),s=n(41),f=n(223),l=n.n(f),d=n(216),p=n.n(d),h=n(467),b=n(62),O=n(71),m=n(220),v=n(410),j=n(253),k=2048,g=null;function w(t,e,n,i,a,c,s,f,l){return Object(r.__awaiter)(this,void 0,void 0,function(){var d,p,b,O,m,v,j,k;return Object(r.__generator)(this,function(g){switch(g.label){case 0:return d="object"==typeof n&&n.customHeaders||s,p=d?Object.keys(d).reduce(function(t,e){return t[e.toLowerCase()]=d[e],t},{}):void 0,b="object"==typeof n?Object(r.__assign)(Object(r.__assign)({},n),{customHeaders:p}):{returnFullResponse:n,correlationId:a,requestObject:c,customHeaders:p,throwServiceError:f,includeCredentials:l},"authorization",b.customHeaders&&b.customHeaders.authorization?[3,3]:(m=Object(u.m)(),v=Object(r.__read)(Object(h.getAccessTokenforResourceAsLazy)(m),2),j=v[0],k=v[1],j?[3,2]:[4,k]);case 1:j=g.sent(),g.label=2;case 2:O=j,void 0===b.includeCredentials&&(b.includeCredentials=!Object(o.f)("auth-authzHeaderNoCookies")),g.label=3;case 3:return[2,y(t,e,O,b,i)]}})})}function y(t,e,n,f,d){var h,w,y;return Object(r.__awaiter)(this,void 0,void 0,function(){var T,R,C,I,S,_,x,N,P,U,q,E,A,D,z,H,M,L,F,G,J,B,V,X;return Object(r.__generator)(this,function(r){return T=f.returnFullResponse,R=f.correlationId,C=f.requestObject,I=f.customHeaders,S=f.throwServiceError,_=f.sendPayloadAsBody,x=f.isThrottled,N=f.includeCredentials,P=/\/(.+?)\//.exec((null===(w=null===(h=window)||void 0===h?void 0:h.location)||void 0===w?void 0:w.pathname)||""),U=P&&P.length>0&&" "+P[1]||"",(q=new Headers).append("X-OWA-CANARY",Object(s.getOwaCanaryCookie)()),q.append("X-MS-AppName","owa-react"+U),E={n:l()().toString()},R&&(q.append("client-request-id",R),E.cri=R),I&&Object.keys(I).forEach(function(t){q.append(t,I[t])}),(A=Object(m.getCorrelationVector)())&&(q.append(m.correlationVectorHeaderName,A),E.cv=A),n&&("Authorization",Object(o.f)("fwk-devTools")&&(3==(D=n.split(".")).length&&0!==D[2].length||b.d.error("BearerTokenIncomplete "+D.length)),q.append("Authorization","Bearer  "+n)),"x-anchormailbox",I&&I["x-anchormailbox"]||(z=Object(c.b)(),Object(o.f)("fwk-puidBasedRouting")&&0===z.length&&(H=Object(O.f)(),(null===(y=H)||void 0===y?void 0:y.SessionSettings)&&(M=H.SessionSettings.ExternalDirectoryTenantGuid,(L=H.SessionSettings.UserPuid)&&M&&(z="PUID:"+L+"@"+M))),0===z.length&&(z=Object(c.a)()),z&&z.length>0&&q.append("X-AnchorMailbox",z)),F={method:e,credentials:!1!==N?"same-origin":"omit"},C&&(q.append("Content-Type","application/json"),G=JSON.stringify(C),J=t.search(/ows\/|owa\//i)>=0,Object(o.f)("fwk-emptyPost")&&J&&"POST"==e&&!_&&(B=encodeURIComponent(G)).length<k?q.append("X-OWA-UrlPostData",B):F.body=G),F.headers=q,V=function(t,e){var n=function(t,e){var n=Object(u.v)(t,e),r=n.split("/");r.length>0&&("ows"==r[0]||"OutlookGateway"==r[0])&&(r[0]=Object(u.f)(r[0],window.location.pathname),n=r.join("/"));return Object(u.a)(n)}(Object(o.f)("fwk-proxyOwsPrime")?"/OutlookGateway/":"/",t),r=Object(u.m)()+n;if(Object(o.f)("fwk-devTools")&&Object(a.d)(j.b)&&(Object(a.a)(j.a)==t||!Object(a.d)(j.a))&&(null==g&&(g=confirm("A query param '"+j.b+"' is set to redirect some of calls to '"+Object(a.a)(j.b)+"'.\n\nThose calls contain PII. If this is not intentional, click 'Cancel' below or remove the queryparam and reload the page.")),g)){var i=t.split("/");i.length>0&&"ows"==i.shift()&&(t=i.join("/")),r=Object(a.a)(j.b)+"/"+t}return Object(u.t)(r,e)}(t,E),X=x?p()(V,F):fetch(V,F),Object(v.a)(F,f,X,d,V),[2,X.then(function(n){if(T)return n;if(Object(i.a)(n.status))return n.text().then(function(t){return t?JSON.parse(t):{}});throw new Error(e+" request to "+t+" failed, http error:"+n.status)}).catch(function(t){if(b.d.warn(t),S)throw{stack:t.stack,message:t.message,correlationVector:A,correlationId:f.correlationId};return[]})]})})}function T(t,e,n,r,o,i,a,u,c,s){return w(t,"POST",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:o,throwServiceError:i,sendPayloadAsBody:a,includeCredentials:u,datapoint:s},c)}function R(t,e,n,r,o,i,a,u){return w(t,"PATCH",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:o,throwServiceError:i,isThrottled:a,includeCredentials:u})}function C(t,e,n,r,o,i,a,u){return w(t,"PUT",r,a,n,e,o,i,u)}function I(t,e,n,r,o,i,a){return w(t,"GET",n,a,e,void 0,r,o,i)}function S(t,e,n,r,o,i,a,u){return w(t,"DELETE",{returnFullResponse:r,correlationId:n,requestObject:e,customHeaders:o,throwServiceError:i,isThrottled:a,includeCredentials:u})}},319:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a});var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function i(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function a(t){return r.test(t)}},336:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",function(){return r})},339:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(129),o=n(298);e.default=function(t,e){return void 0===t||t.__type||(t=o.default(t)),r.makeServiceRequest("GetAccessTokenforResource",t,e)}},347:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(50);function o(){var t=Object(r.a)(),e=t.origin;return e||(e=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),e}},355:function(t,e,n){"use strict";function r(t,e){var n=t;if(e){var r=e.split("/").filter(function(t){return t.length});if(r.length>=2){var o=parseInt(r[1]);isNaN(o)||(n+="/"+o)}}return n}n.d(e,"a",function(){return r})},677:function(t,e,n){"use strict";n.r(e);var r=n(3111);n.d(e,"makeOwsPrimeRequest",function(){return r.f}),n.d(e,"makePostRequest",function(){return r.d}),n.d(e,"makePatchRequest",function(){return r.c}),n.d(e,"makePutRequest",function(){return r.e}),n.d(e,"makeGetRequest",function(){return r.b}),n.d(e,"makeDeleteRequest",function(){return r.a})},797:function(t,e,n){"use strict";var r=n(355),o=(n(925),n(17)),i=n(9);function a(t,e){var n=t;if(e){var r=e.split("/").filter(function(t){return t.length});r.length>=2&&r[1].match(/.+@.+/)&&(n=Object(i.a)(n,r[1]))}return Object(i.b)(n)}var u=n(54),c=n(50);function s(t){return Object(i.b)(Object(i.c)(Object(i.a)(Object(u.a)(Object(c.a)())||"",t)))}var f,l,d,p=n(1086);function h(t,e){var n=-1!==t.indexOf("?");return(t+=n?"&":"?")+Object.keys(e).map(function(t,n){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}function b(){return f||(f=Object(o.a)("/calendar",Object(c.a)().pathname)+"/"),f}function O(){return l||(l=Object(o.a)("/mail",Object(c.a)().pathname)+"/"),l}function m(){return d||(d=Object(o.a)("/files",Object(c.a)().pathname)+"/"),d}var v,j,k,g=n(1555);function w(t){return v&&j===t||(j=t,v=t?Object(o.a)("/people/group/owner",Object(c.a)().pathname)+"/":Object(o.a)("/people/group/member",Object(c.a)().pathname)+"/"),v}function y(){return k||(k=Object(o.a)("/people/group/deleted",Object(c.a)().pathname)+"/"),k}var T=n(40);function R(){var t,e=Object(T.a)().UserOptions;return(null===(t=e)||void 0===t?void 0:t.ReactOptinSettings)&&e.ReactOptinSettings.CalendarEnabled||!1}function C(t){if(R())return b()+"deeplink/compose/"+encodeURIComponent(t);var e={viewmodel:"IComposeCalendarItemViewModelFactory",ItemID:encodeURIComponent(t),ispopout:"1"};return Object(p.a)(e)}function I(t){return window.location.origin+b()+"showPeek/item/"+encodeURIComponent(t)}function S(t){if(R())return b()+"item/"+encodeURIComponent(t);var e={viewmodel:"ICalendarItemDetailsViewModelFactory",ItemID:encodeURIComponent(t),ispopout:"1"};return Object(p.a)(e)}var _=n(0),x=n(248),N=n(904),P=n(39),U=Object(N.a)().split("/").slice(1).join("/")+"deeplink/";function q(t,e,n,r){var o=Object(c.a)().search;if(n&&((r=r||{}).minus=""),r){var i=Object(P.parse)((o||"").substr(1));Object.keys(r).forEach(function(t){return i[t]=r[t]}),o="?"+function(t){return Object.entries(t).map(function(t){var e=Object(_.__read)(t,2),n=e[0],r=e[1];return r?encodeURIComponent(n)+"="+encodeURIComponent(r):encodeURIComponent(n)}).join("&")}(i)}var a={pathname:"/"+t+"/"+U+e,search:o};return x.format(a)}var E="deeplink";function A(t){var e=t||window.location;return(e?e.pathname:"").split("/").indexOf(E)>=0}var D,z="https://to-do.microsoft.com";function H(){var t,e,n,r=Object(T.a)(),o=r.UserOptions,i=null===(t=r.SessionSettings)||void 0===t?void 0:t.UserPrincipalName,a=z;return(null===(n=null===(e=o)||void 0===e?void 0:e.ReactOptinSettings)||void 0===n?void 0:n.TasksRedirectUrl)&&(a=o.ReactOptinSettings.TasksRedirectUrl,i&&(a=h(o.ReactOptinSettings.TasksRedirectUrl,{auth_upn:i}))),a}function M(){return D||(D=Object(o.a)("/spaces",Object(c.a)().pathname)+"/"),D}var L=n(347);n.d(e,"j",function(){return r.a}),n.d(e,"r",function(){return o.a}),n.d(e,"f",function(){return a}),n.d(e,"l",function(){return s}),n.d(e,"v",function(){return i.a}),n.d(e,"a",function(){return i.b}),n.d(e,"o",function(){return p.a}),n.d(e,"t",function(){return h}),n.d(e,"e",function(){return b}),n.d(e,"k",function(){return O}),n.d(e,"g",function(){return m}),n.d(e,"p",function(){return g.a}),n.d(e,"i",function(){return w}),n.d(e,"h",function(){return y}),n.d(e,"b",function(){return C}),n.d(e,"c",function(){return I}),n.d(e,"d",function(){return S}),n.d(e,"q",function(){return q}),n.d(e,"u",function(){return A}),n.d(e,"s",function(){return H}),n.d(e,"n",function(){return M}),n.d(e,"m",function(){return L.a})},904:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r,o=n(54),i=n(50),a=n(17);function u(){if(!r){var t=Object(o.a)(Object(i.a)());r=(r=Object(a.a)("/"+t,Object(i.a)().pathname.replace(/\/$/,""))+"/").replace(/^\//,"")}return r}},925:function(t,e,n){"use strict";function r(t){if(t){var e=t.split("/").filter(function(t){return t.length});if(e.length>=2&&!isNaN(parseInt(e[1])))return!0}return!1}n.d(e,"a",function(){return r})}},0,[565,110]]);
//# sourceMappingURL=owa.OwsGateway.js.map
self.scriptsLoaded['owa.OwsGateway.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OwsGateway.js'] = (new Date()).getTime();