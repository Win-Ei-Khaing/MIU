self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.CLP.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[148],{11449:function(e,t,n){var r=n(11450),i=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},11450:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._31IkFpp5b72Rv6tTM5wjsx{color:"[theme:neutralSecondary, default:#666666]"}html[dir=ltr] ._31IkFpp5b72Rv6tTM5wjsx{padding-left:12px;padding-right:8px}html[dir=rtl] ._31IkFpp5b72Rv6tTM5wjsx{padding-right:12px;padding-left:8px}._35yiavnkrHXl4okJM1d7bN{font-size:12px}html[dir=ltr] ._2dJK6zp7Pb1DJHdwx-4zHt{margin-right:4px}html[dir=rtl] ._2dJK6zp7Pb1DJHdwx-4zHt{margin-left:4px}',""]),t.locals={subjectLabel:"_31IkFpp5b72Rv6tTM5wjsx",subjectLabelText:"_35yiavnkrHXl4okJM1d7bN",labelIcon:"_2dJK6zp7Pb1DJHdwx-4zHt"}},11451:function(e){e.exports={g:"znb",f:"Anb",e:"Bnb",c:"Cnb",d:"Dnb",b:"Enb",a:"Fnb"}},121:function(e,t,n){"use strict";var r=n(336);n.d(t,"a",function(){return r.a})},1229:function(e,t,n){"use strict";var r=n(0),i=n(1908),a=n(4);var o=Object(a.mutatorAction)("removeInfoBarMessages",function(e,t){(Array.isArray(t)?t:t?[t]:e.infoBarIds?Object(r.__spread)(e.infoBarIds):[]).forEach(function(t){return function(e,t){var n=e.infoBarIds&&e.infoBarIds.indexOf(t);n>=0&&e.infoBarIds.splice(n,1);var r=e.infoBarHostKey;i.b[r]&&(delete i.b[r][t],0===Object.keys(i.b[r]).length&&delete i.b[r])}(e,t)})});t.a=o},1306:function(e,t,n){"use strict";var r=n(0),i=n(1908),a=n(69),o=Object(a.action)("addInfoBarMessage")(function(e,t,n){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=Object(r.__spread)(e.infoBarIds);var a=e.infoBarHostKey;n&&(i.b[a]||(i.b[a]={}),i.b[a][t]=n)});t.a=o},1633:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(1),i=n(141),a=n(1550),o=0;function c(e){var t=document.createElement("div");t.id="owa-modal-"+o++,document.body.appendChild(t);var n,c=!1,u=function(){c||(c=!0,i.unmountComponentAtNode(t),document.body.removeChild(t))};return[new Promise(function(o,c){n=c,i.render(r.createElement(a.a,{child:r.createElement(e,{onDismiss:function(e){u(),o(e)}}),type:a.b.None,onError:function(){u(),c()}}),t)}),function(){u(),n()}]}},1908:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var r={};function i(e,t){var n,i=e.infoBarHostKey;return null===(n=r[i])||void 0===n?void 0:n[t]}},2243:function(e,t,n){"use strict";function r(e){if(!e)return e;var t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-")}function i(e){if(!e)return e;var t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/")}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i})},2280:function(e,t,n){"use strict";n.d(t,"b",function(){return i});var r=n(4),i=Object(r.createStore)("CLPUserLabels",{userLabels:[],learnMoreUrl:""});t.a=i()},2558:function(e,t,n){"use strict";function r(e,t,n,r){var a=i(e,t,n,r);return a?a.Value:null}function i(e,t,n,r){var i;if(!e||!e.ExtendedProperty)return null;for(var a=0;a<e.ExtendedProperty.length;a++){var o=e.ExtendedProperty[a],c=null,u=null,l=null;if((null===(i=o)||void 0===i?void 0:i.ExtendedFieldURI)&&(c=o.ExtendedFieldURI.PropertyTag,u=o.ExtendedFieldURI.PropertyName,l=o.ExtendedFieldURI.PropertyId),t&&c==t)return o;if(n&&u==n)return o;if(r&&l==r)return o}return null}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i})},3147:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"f",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return f}),n.d(t,"g",function(){return b}),n.d(t,"h",function(){return L});var r=n(0),i=n(151),a=n(7),o=n(40);function c(e,t){var n,a=v(e.selectedCLPLabel,"Change"),o=e.originalCLPLabel,c=e.selectedCLPLabel,u=Object(r.__assign)(Object(r.__assign)({},a),{IsLabelChanged:!0,LabelIdBefore:o?o.id:null,IsProtectionChanged:!(!o||!c)&&o.isEncryptingLabel!=c.isEncryptingLabel,ProtectedBefore:null===(n=o)||void 0===n?void 0:n.isEncryptingLabel,UserJustification:t});i.i.importAndExecute(u)}function u(e){var t=v(e,"Discover");i.i.importAndExecute(t)}function l(e){var t;(null===(t=e)||void 0===t?void 0:t.value)&&e.value.length>0&&Object(i.m)("LoadCLPLabelOnBoot",{labelCount:e.value.length})}function s(e){e&&Object(i.m)("LoadCLPLabelComposeUsage",{isDefaultLabel:e.isDefault,isEncryptingLabel:e.isEncryptingLabel})}function d(e,t){t&&e?Object(i.m)("LoadCLPLabelChange",{isDowngrade:e.settingOrder>t.settingOrder,isOriginalLabelDefault:e.isDefault}):e&&Object(i.m)("LoadCLPLabelUnselect",{isOriginalLabelDefault:e.isDefault,isOriginalLabelEncrypting:e.isEncryptingLabel})}function f(e){401!=e.status&&Object(i.m)("CLPAutoLabelEnabled")}function b(){Object(i.m)("CLPAutoLabelRecommendedApplied")}function L(){Object(i.m)("CLPAutoLabelRecommendedDismissed")}function v(e,t){var n=Object(o.a)().SessionSettings,r=n.ExternalDirectoryTenantGuid,i=n.UserEmailAddress;return{CreationTime:Object(a.sb)(Object(a.Ob)()),Version:"1.1",Operation:t,OrganizationId:r,UserId:i,ApplicationId:"00000002-0000-0ff1-ce00-000000000000",ApplicationName:"Outlook Web",DataState:"Use",LabelId:e?e.id:null,Protected:e?e.isEncryptingLabel:null}}},3254:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e.Manual="manual",e.Automatic="automatic",e.Default="default"}(r||(r={}))},336:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",function(){return r})},3732:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"e",function(){return o}),n.d(t,"d",function(){return c});var r="msip_labels",i="X-MS-Exchange-Organization-ModifySensitivityLabel",a="00000000-0000-0000-0000-000000000000",o="Standard",c="Privileged"},3927:function(e,t,n){"use strict";n.d(t,"b",function(){return c});var r=n(2280),i=n(4152),a=n(104),o=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/g;function c(e){return Object(a.b)(e)?null:function e(t,n){if(!n)return null;for(var r=0;r<n.length;r++){var i=n[r];if(i.id==t)return i;var a=e(t,i.children);if(a)return a}return null}(e,Object(r.b)().userLabels)}t.a=function(e){var t=Object(i.a)();if(!e)return t;for(var n=e.split(";"),r={},a=0;a<n.length;a++){var u=n[a];if(u){var l=u.match(o);if(l&&0!=l.length){var s=l[0];r[s]?r[s].push(u):r[s]=[u]}}}var d=Object.keys(r);for(a=0;a<d.length;a++){var f=c(d[a]);if(f){t.selectedLabel=f,delete r[d[a]];break}}return Object.values(r).forEach(function(e){t.nonTenantLabelString+=e.join(";")+";"}),t}},4152:function(e,t,n){"use strict";function r(){return{nonTenantLabelString:"",selectedLabel:null}}n.d(t,"a",function(){return r})},4233:function(e,t,n){"use strict";n.r(t);var r=n(5097),i=n(4),a=Object(i.action)("setJustificationSent",function(e,t){return{clpViewState:e,justificationSent:t}});Object(i.mutator)(a,function(e){var t=e.clpViewState,n=e.justificationSent;t.justificationSent=n});var o=Object(i.action)("setSelectedCLPLabel",function(e,t,n){return{labelToSet:e,infoBarViewState:t,clpViewState:n}}),c=n(6263),u=n(1306),l=n(1229),s=n(3254);Object(i.orchestrator)(o,function(e){var t=e.infoBarViewState,n=e.clpViewState,r=e.labelToSet,i=t.infoBarIds;n.selectedCLPLabel&&r.id==n.selectedCLPLabel.id?(Object(c.a)(n,null,s.a.Default),i.indexOf("CLPLabel")>=0&&Object(l.a)(t,"CLPLabel")):r.isDefault?(Object(c.a)(n,r,s.a.Default),i.indexOf("CLPLabel")>=0&&Object(l.a)(t,"CLPLabel")):(Object(c.a)(n,r,s.a.Manual),i.indexOf("CLPLabel")<0&&Object(u.a)(t,"CLPLabel"))});var d=n(1),f=n(503),b=n(22),L=n(673),v=n(11449),g=Object(b.a)(function(e){var t=e.subjectHeaderLabel;return t?d.createElement(L.a,{content:t.tooltip,hostClassName:v.subjectLabel},d.createElement(f.a,{iconName:t.isEncryptingLabel?"Lock":"MarkAsProtected",className:v.labelIcon}),d.createElement("span",{className:v.subjectLabelText},t.infobarDisplayText)):null}),p=n(4541),m=n(0),O=n(468),j=n.n(O),P=n(1081),h=n(842),C=n.n(h),y=n(2558),I=n(758),S=n(3927),_=Object(i.mutatorAction)("updateItemCLPInfoInMailStore",function(e,t){var n;e&&(e.itemCLPInfo=t,(null===(n=t)||void 0===n?void 0:n.selectedLabel)&&(e.MSIPLabelGuid=t.selectedLabel.id))}),E=n(5466),x=n(65);function A(e,t){Object(x.f)("cmp-clp")&&(r.a?r.a.then(function(){w(e,t)}):w(e,t))}function w(e,t){if(e&&!e.itemCLPInfo){var n="";n=t?t.Value:Object(E.a)(e),_(e,Object(S.a)(n))}}var D=n(3732),R=n(4152);function M(e){return Object(m.__awaiter)(this,void 0,void 0,function(){var t;return Object(m.__generator)(this,function(n){return(t=I.a.items.get(e))?t.itemCLPInfo?[2,Promise.resolve(t.itemCLPInfo)]:[2,T(e).then(function(e){return A(t,e),t.itemCLPInfo})]:[2,Promise.resolve(Object(R.a)())]})})}function T(e){return Object(m.__awaiter)(this,void 0,void 0,function(){return Object(m.__generator)(this,function(t){return[2,Object(P.a)([e],C()({BaseShape:"IdOnly",AdditionalProperties:[j()({PropertyName:D.c,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})]}),null).then(function(e){var t,n,r;return(null===(r=null===(n=null===(t=e)||void 0===t?void 0:t[0])||void 0===n?void 0:n.Items)||void 0===r?void 0:r[0])?Object(y.b)(e[0].Items[0],null,D.c):null})]})})}var k=n(3147),B=n(11451),J=n(5),U=n(103),N=n(675),H=n(178),F=n(349),V=n(353),z=n(254),q=n(1520),K=n(696),G=function(e){function t(t){var n=e.call(this,t)||this;return n.confirmDialog=function(){n.props.onDismiss({success:!0,downgradeJustification:n.state.downgradeJustification})},n.closeDialog=function(){n.props.onDismiss({success:!1,downgradeJustification:null})},n.onChoiceChange=function(e,t){if("OTHERS"!=t.key)return n.setState({downgradeJustification:t.value||""}),void(n.isPresetJustification=!0);n.isPresetJustification=!1},n.onTextFieldChange=function(e,t){n.isPresetJustification||n.setState({downgradeJustification:t||""})},n.isPresetJustification=!0,n.state={downgradeJustification:""},n}return Object(m.__extends)(t,e),t.prototype.render=function(){var e=this,t=[{key:"LABEL_NOT_APPLY",text:Object(J.a)(B.g),value:"Previous label no longer applies"},{key:"LABEL_NOT_CORRECT",text:Object(J.a)(B.f),value:"Previous label was incorrect"},{key:"OTHERS",text:Object(J.a)(B.e),onRenderField:function(t,n){return d.createElement("div",null,n(t),t.checked&&d.createElement(K.a,{multiline:!0,rows:3,onChange:e.onTextFieldChange}))},styles:{choiceFieldWrapper:{width:"100%"},field:{marginBottom:"10px"}}}],n=!this.state.downgradeJustification;return d.createElement(N.a,{hidden:!1,onDismiss:this.closeDialog,dialogContentProps:{type:H.a.normal,title:Object(J.a)(B.c),subText:Object(J.a)(B.d)}},d.createElement(q.a,{options:t,onChange:this.onChoiceChange}),d.createElement(F.a,null,d.createElement(V.a,{onClick:this.confirmDialog,disabled:n,text:Object(J.a)(B.b)}),d.createElement(z.a,{onClick:this.closeDialog,text:Object(J.a)(B.a)})))},t=Object(m.__decorate)([U.observer],t)}(d.Component),X=n(1633);function W(e,t,n,r){var i=n.originalCLPLabel;return r&&i&&e.settingOrder<=i.settingOrder&&!n.justificationSent?Object(m.__read)(Object(X.a)(G),1)[0].then(function(r){var i=r.success,c=r.downgradeJustification;return i&&c?(a(n,!0),o(e,t,n),Object(k.e)(n,c),Object(k.c)(n.selectedCLPLabel,e),Promise.resolve(!0)):Promise.resolve(!1)}):(o(e,t,n),Object(k.c)(n.selectedCLPLabel,e),Promise.resolve(!0))}var $=n(112),Y=n(40),Q=n(319),Z=n(2243),ee=n(121),te="/ows/beta/CLPAutoLabeling";var ne=n(62),re=Object(i.mutatorAction)("updateAutoLabelViewState",function(e,t,n){e[t]=n});var ie=n(2280);var ae=["automatic","recommended"];function oe(e,t,n,r){if(i=function(e,t){var n=!1;return t.children&&t.children.length>0&&(n=t.children.reduce(i,!1)),e||t.isAutoLabelingOn||n},ie.a.userLabels.reduce(i,!1)){var i,a=t.autoLabelViewState;if(!a.shouldKeepGettingAutoLabel)return re(a,"inProgressAutoLabelRequest",null),void re(a,"pendingAutoLabelRequest",null);var o=a.contentOfExistingAutoLabel;if(a.inProgressAutoLabelRequest)re(a,"pendingAutoLabelRequest",{itemId:n,content:r});else{if(!r||""==r)return;r!=o&&(re(a,"inProgressAutoLabelRequest",{itemId:n,content:r}),function(e){return Object(m.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,a,o,c,u,l;return Object(m.__generator)(this,function(s){switch(s.label){case 0:return t=Object(Z.a)(e.Id),n=Object(Y.a)().SessionSettings,(r=n?n.ExternalDirectoryUserGuid:null)&&t?(i=Object(Q.a)(),[4,Object($.b)(te+"/"+r+"/"+t,i,!0,null,!1,!0)]):[3,6];case 1:return a=s.sent(),o={status:a.status},Object(ee.a)(a.status)?[4,a.json()]:[3,3];case 2:return c=s.sent(),(u=c.result)&&(o.automatic=u.automatic,o.recommended=u.recommended),[3,5];case 3:return l=o,[4,a.text()];case 4:l.errorMessage=s.sent(),s.label=5;case 5:return[2,Promise.resolve(o)];case 6:return[2,Promise.resolve(null)]}})})}(n).then(function(n){!function(e,t,n){var r=t.autoLabelViewState;if(Object(k.a)(n),n)switch(n.status){case 200:!function(e,t,n){var r=t.autoLabelViewState,i=r.inProgressAutoLabelRequest;ae.forEach(function(e){var t,i=null;(null===(t=n[e])||void 0===t?void 0:t.sensitivityLabel)&&(i=Object(S.b)(n[e].sensitivityLabel.id)),re(r,e,i)});var a=r.automatic,o=r.recommended;(function(e,t){if(e.labelApplyMethod==s.a.Manual||!t)return!1;var n=e.selectedCLPLabel&&e.selectedCLPLabel.settingOrder<t.settingOrder;return!e.selectedCLPLabel||n})(t,a)&&(!function(e){var t=e.autoLabelViewState.automatic;Object(c.a)(e,t,s.a.Automatic)}(t),Object(u.a)(e,"CLPAutoLabelAutomatic"));(function(e,t){return!e.selectedCLPLabel||t&&e.selectedCLPLabel.settingOrder<t.settingOrder})(t,o)&&function(e,t){var n=t.automatic,r=t.recommended;n&&r&&n.id==r.id?Object(l.a)(e,"CLPAutoLabelRecommended"):r?Object(u.a)(e,"CLPAutoLabelRecommended"):Object(l.a)(e,"CLPAutoLabelRecommended")}(e,r);i&&re(r,"contentOfExistingAutoLabel",i.content)}(e,t,n);break;case 400:case 401:case 404:case 429:case 500:!function(e,t){t&&ne.d.warn(Object(J.b)("GetAutoLabelRequest failed with code of: {0}; Error Message: {1}",t.status,t.errorMessage));re(e,"shouldKeepGettingAutoLabel",!1)}(r,n);break;default:return}re(r,"inProgressAutoLabelRequest",null);var i=r.pendingAutoLabelRequest;if(i){var a=i.itemId,o=i.content;oe(e,t,a,o)}}(e,t,n)}))}}}var ce=oe;n.d(t,"CLPSubjectHeaderLabel",function(){return g}),n.d(t,"loadCLPUserLabels",function(){return p.a}),n.d(t,"loadItemCLPInfo",function(){return M}),n.d(t,"logReadCLPLabel",function(){return k.f}),n.d(t,"showJustificationModal",function(){return W}),n.d(t,"updateItemCLPInfo",function(){return A}),n.d(t,"triggerCLPAutoLabeling",function(){return ce})},4541:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("loadCLPUserLabels")},4946:function(e,t,n){"use strict";var r=n(4),i=n(2280);t.a=Object(r.mutatorAction)("initializeCLPStore",function(e){var t=Object(i.b)();t.userLabels=e.userLabels,t.learnMoreUrl=e.learnMoreUrl})},5097:function(e,t,n){"use strict";var r=n(4),i=n(4541),a=n(4946),o=n(112),c=n(40),u=function(e){if(!e||!e.value)return{userLabels:[],learnMoreUrl:""};var t=e.value,n=Object(c.a)().SessionSettings.UserLanguage,r={},i="";return t.forEach(function(e){"true"==e.Setting_enabled&&(!i&&e.PolicySetting_customurl&&(i=e.PolicySetting_customurl),r[e.Id]=function(e,t){var n=e["DisplayName_"+t]||e.DisplayName_Fallback;return{id:e.Id,parentId:e.ParentId,displayName:n,infobarDisplayText:n,tooltip:e.Setting_tooltip,settingOrder:parseInt(e.Setting_order),isDefault:"true"==e.PolicySetting_default,isEncryptingLabel:!!e.RightsProtectMessage_Disabled&&"false"==e.RightsProtectMessage_Disabled,isAutoLabelingOn:e.AutoLabeling_SensitiveTypeIds&&e.AutoLabeling_SensitiveTypeIds.length>0,children:[]}}(e,n))}),Object.keys(r).forEach(function(e){var t=r[e];if(t.parentId){var n=r[t.parentId];n&&(t.infobarDisplayText=n.displayName+"\\"+t.displayName,n.children.push(t)),delete r[e]}}),{userLabels:l(Object.values(r)),learnMoreUrl:i}};function l(e){return e?(e.sort(s),e.forEach(function(e){e.children&&e.children.sort(s)}),e):null}function s(e,t){return e.settingOrder-t.settingOrder}var d=n(65),f=n(3147),b=n(245);n.d(t,"a",function(){return L});var L=null;Object(r.orchestrator)(i.a,function(){Object(d.f)("cmp-clp")&&!Object(b.a)()&&(L=Object(o.b)("/compliancepolicy/api/v1.0/user/label").then(function(e){Object(a.a)(u(e)),Object(f.d)(e),L=null}))})},5466:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2558),i="msip_labels";function a(e){return e&&e.ExtendedProperty?Object(r.a)(e,null,i):null}},6263:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.mutatorAction)("internalSetSelectedCLPLabel",function(e,t,n){e.selectedCLPLabel=t,e.labelApplyMethod=n})}}]);
//# sourceMappingURL=owa.CLP.js.map
self.scriptsLoaded['owa.CLP.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.CLP.js'] = (new Date()).getTime();