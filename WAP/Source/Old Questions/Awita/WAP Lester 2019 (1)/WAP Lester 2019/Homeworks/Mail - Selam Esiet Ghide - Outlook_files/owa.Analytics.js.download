self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Analytics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[121],{1045:function(t,e,n){"use strict";e.a=function(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}},1049:function(t,e,n){"use strict";var r=n(301),i=1/0,o=1.7976931348623157e308;e.a=function(t){return t?(t=Object(r.a)(t))===i||t===-i?(t<0?-1:1)*o:t==t?t:0:0===t?t:0}},1069:function(t,e,n){"use strict";var r=n(1045),i=n(879),o=n(900),a=n(912);e.a=function(t,e,n){t=Object(a.a)(t),e=Object(i.a)(e);var s=t.length,c=n=void 0===n?s:Object(r.a)(Object(o.a)(n),0,s);return(n-=e.length)>=0&&t.slice(n,c)==e}},112:function(t,e,n){"use strict";n.d(e,"d",function(){return o}),n.d(e,"c",function(){return a}),n.d(e,"e",function(){return s}),n.d(e,"b",function(){return c}),n.d(e,"a",function(){return u});var r=n(52),i=(n(253),new r.c(function(){return Promise.all([n.e(4),n.e(392)]).then(n.bind(null,677))})),o=(new r.a(i,function(t){return t.makeOwsPrimeRequest}).importAndExecute,new r.a(i,function(t){return t.makePostRequest}).importAndExecute),a=new r.a(i,function(t){return t.makePatchRequest}).importAndExecute,s=new r.a(i,function(t){return t.makePutRequest}).importAndExecute,c=new r.a(i,function(t){return t.makeGetRequest}).importAndExecute,u=new r.a(i,function(t){return t.makeDeleteRequest}).importAndExecute},116:function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return a});var r=n(3),i=n(34);function o(){var t=Object(i.getCookie)("DefaultAnchorMailbox");return null==t||0==t.trim().length}function a(){var t=Object(r.b)(window.location);return Object.keys(t).indexOf("anonymous")>=0}},194:function(t,e,n){"use strict";var r=n(250).a.Symbol;e.a=r},211:function(t,e,n){"use strict";e.a=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},250:function(t,e,n){"use strict";var r=n(340),i="object"==typeof self&&self&&self.Object===Object&&self,o=r.a||i||Function("return this")();e.a=o},253:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i});var r="owsserver",i="owsapi"},301:function(t,e,n){"use strict";var r=n(211),i=n(329),o=NaN,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,d=parseInt;e.a=function(t){if("number"==typeof t)return t;if(Object(i.a)(t))return o;if(Object(r.a)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Object(r.a)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var n=c.test(t);return n||u.test(t)?d(t.slice(2),n?2:8):s.test(t)?o:+t}},326:function(t,e,n){"use strict";e.a=function(t){return null!=t&&"object"==typeof t}},327:function(t,e,n){"use strict";var r=n(194),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r.a?r.a.toStringTag:void 0;var c=function(t){var e=o.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=a.call(t);return r&&(e?t[s]=n:delete t[s]),i},u=Object.prototype.toString;var d=function(t){return u.call(t)},f="[object Null]",l="[object Undefined]",p=r.a?r.a.toStringTag:void 0;e.a=function(t){return null==t?void 0===t?l:f:p&&p in Object(t)?c(t):d(t)}},329:function(t,e,n){"use strict";var r=n(327),i=n(326),o="[object Symbol]";e.a=function(t){return"symbol"==typeof t||Object(i.a)(t)&&Object(r.a)(t)==o}},340:function(t,e,n){"use strict";(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.a=n}).call(this,n(31))},5199:function(t,e){var n=function(){function t(){this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}return t.hashStr=function(t,e){return void 0===e&&(e=!1),this.onePassHasher.start().appendStr(t).end(e)},t.hashAsciiStr=function(t,e){return void 0===e&&(e=!1),this.onePassHasher.start().appendAsciiStr(t).end(e)},t.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(t.stateIdentity),this},t.prototype.appendStr=function(e){var n,r,i=this._buffer8,o=this._buffer32,a=this._bufferLength;for(r=0;r<e.length;r+=1){if((n=e.charCodeAt(r))<128)i[a++]=n;else if(n<2048)i[a++]=192+(n>>>6),i[a++]=63&n|128;else if(n<55296||n>56319)i[a++]=224+(n>>>12),i[a++]=n>>>6&63|128,i[a++]=63&n|128;else{if((n=1024*(n-55296)+(e.charCodeAt(++r)-56320)+65536)>1114111)throw"Unicode standard supports code points up to U+10FFFF";i[a++]=240+(n>>>18),i[a++]=n>>>12&63|128,i[a++]=n>>>6&63|128,i[a++]=63&n|128}a>=64&&(this._dataLength+=64,t._md5cycle(this._state,o),a-=64,o[0]=o[16])}return this._bufferLength=a,this},t.prototype.appendAsciiStr=function(e){for(var n,r=this._buffer8,i=this._buffer32,o=this._bufferLength,a=0;;){for(n=Math.min(e.length-a,64-o);n--;)r[o++]=e.charCodeAt(a++);if(o<64)break;this._dataLength+=64,t._md5cycle(this._state,i),o=0}return this._bufferLength=o,this},t.prototype.appendByteArray=function(e){for(var n,r=this._buffer8,i=this._buffer32,o=this._bufferLength,a=0;;){for(n=Math.min(e.length-a,64-o);n--;)r[o++]=e[a++];if(o<64)break;this._dataLength+=64,t._md5cycle(this._state,i),o=0}return this._bufferLength=o,this},t.prototype.getState=function(){var t=this._state;return{buffer:String.fromCharCode.apply(null,this._buffer8),buflen:this._bufferLength,length:this._dataLength,state:[t[0],t[1],t[2],t[3]]}},t.prototype.setState=function(t){var e,n=t.buffer,r=t.state,i=this._state;for(this._dataLength=t.length,this._bufferLength=t.buflen,i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],e=0;e<n.length;e+=1)this._buffer8[e]=n.charCodeAt(e)},t.prototype.end=function(e){void 0===e&&(e=!1);var n,r=this._bufferLength,i=this._buffer8,o=this._buffer32,a=1+(r>>2);if(this._dataLength+=r,i[r]=128,i[r+1]=i[r+2]=i[r+3]=0,o.set(t.buffer32Identity.subarray(a),a),r>55&&(t._md5cycle(this._state,o),o.set(t.buffer32Identity)),(n=8*this._dataLength)<=4294967295)o[14]=n;else{var s=n.toString(16).match(/(.*?)(.{0,8})$/),c=parseInt(s[2],16),u=parseInt(s[1],16)||0;o[14]=c,o[15]=u}return t._md5cycle(this._state,o),e?this._state:t._hex(this._state)},t._hex=function(e){var n,r,i,o,a=t.hexChars,s=t.hexOut;for(o=0;o<4;o+=1)for(r=8*o,n=e[o],i=0;i<8;i+=2)s[r+1+i]=a.charAt(15&n),n>>>=4,s[r+0+i]=a.charAt(15&n),n>>>=4;return s.join("")},t._md5cycle=function(t,e){var n=t[0],r=t[1],i=t[2],o=t[3];r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+e[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&i)+e[1]-389564586|0)<<12|o>>>20)+n|0)&n|~o&r)+e[2]+606105819|0)<<17|i>>>15)+o|0)&o|~i&n)+e[3]-1044525330|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+e[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&i)+e[5]+1200080426|0)<<12|o>>>20)+n|0)&n|~o&r)+e[6]-1473231341|0)<<17|i>>>15)+o|0)&o|~i&n)+e[7]-45705983|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+e[8]+1770035416|0)<<7|n>>>25)+r|0)&r|~n&i)+e[9]-1958414417|0)<<12|o>>>20)+n|0)&n|~o&r)+e[10]-42063|0)<<17|i>>>15)+o|0)&o|~i&n)+e[11]-1990404162|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+e[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&i)+e[13]-40341101|0)<<12|o>>>20)+n|0)&n|~o&r)+e[14]-1502002290|0)<<17|i>>>15)+o|0)&o|~i&n)+e[15]+1236535329|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+e[1]-165796510|0)<<5|n>>>27)+r|0)&i|r&~i)+e[6]-1069501632|0)<<9|o>>>23)+n|0)&r|n&~r)+e[11]+643717713|0)<<14|i>>>18)+o|0)&n|o&~n)+e[0]-373897302|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+e[5]-701558691|0)<<5|n>>>27)+r|0)&i|r&~i)+e[10]+38016083|0)<<9|o>>>23)+n|0)&r|n&~r)+e[15]-660478335|0)<<14|i>>>18)+o|0)&n|o&~n)+e[4]-405537848|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+e[9]+568446438|0)<<5|n>>>27)+r|0)&i|r&~i)+e[14]-1019803690|0)<<9|o>>>23)+n|0)&r|n&~r)+e[3]-187363961|0)<<14|i>>>18)+o|0)&n|o&~n)+e[8]+1163531501|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+e[13]-1444681467|0)<<5|n>>>27)+r|0)&i|r&~i)+e[2]-51403784|0)<<9|o>>>23)+n|0)&r|n&~r)+e[7]+1735328473|0)<<14|i>>>18)+o|0)&n|o&~n)+e[12]-1926607734|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+e[5]-378558|0)<<4|n>>>28)+r|0)^r^i)+e[8]-2022574463|0)<<11|o>>>21)+n|0)^n^r)+e[11]+1839030562|0)<<16|i>>>16)+o|0)^o^n)+e[14]-35309556|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+e[1]-1530992060|0)<<4|n>>>28)+r|0)^r^i)+e[4]+1272893353|0)<<11|o>>>21)+n|0)^n^r)+e[7]-155497632|0)<<16|i>>>16)+o|0)^o^n)+e[10]-1094730640|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+e[13]+681279174|0)<<4|n>>>28)+r|0)^r^i)+e[0]-358537222|0)<<11|o>>>21)+n|0)^n^r)+e[3]-722521979|0)<<16|i>>>16)+o|0)^o^n)+e[6]+76029189|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+e[9]-640364487|0)<<4|n>>>28)+r|0)^r^i)+e[12]-421815835|0)<<11|o>>>21)+n|0)^n^r)+e[15]+530742520|0)<<16|i>>>16)+o|0)^o^n)+e[2]-995338651|0)<<23|r>>>9)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+e[0]-198630844|0)<<6|n>>>26)+r|0)|~i))+e[7]+1126891415|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+e[14]-1416354905|0)<<15|i>>>17)+o|0)|~n))+e[5]-57434055|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+e[12]+1700485571|0)<<6|n>>>26)+r|0)|~i))+e[3]-1894986606|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+e[10]-1051523|0)<<15|i>>>17)+o|0)|~n))+e[1]-2054922799|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+e[8]+1873313359|0)<<6|n>>>26)+r|0)|~i))+e[15]-30611744|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+e[6]-1560198380|0)<<15|i>>>17)+o|0)|~n))+e[13]+1309151649|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+e[4]-145523070|0)<<6|n>>>26)+r|0)|~i))+e[11]-1120210379|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+e[2]+718787259|0)<<15|i>>>17)+o|0)|~n))+e[9]-343485551|0)<<21|r>>>11)+i|0,t[0]=n+t[0]|0,t[1]=r+t[1]|0,t[2]=i+t[2]|0,t[3]=o+t[3]|0},t.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),t.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),t.hexChars="0123456789abcdef",t.hexOut=[],t.onePassHasher=new t,t}();e.Md5=n,n.hashStr("hello")},695:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n(183),o=n(71),a=n(64),s=n(2),c=n(8),u=function(t){function e(e){var n,r,i=t.call(this,null,null,{isCore:!0})||this;i.addData(a.b.bootType,e),i.addData("FEServer",Object(s.k)()),i.addData("RefUrl",Object(s.s)());var u=Object(c.f)();u&&i.addData("pltnav",u.time);var d=Object(o.f)();return(null===(n=d)||void 0===n?void 0:n.UserOptions)&&((null===(r=d.UserOptions.ReactOptinSettings)||void 0===r?void 0:r.MailGraduatedFromBeta)&&i.addCustomProperty("graduated","1"),i.addCustomProperty("optin",""+d.UserOptions.ClientTypeOptInState)),i}return Object(r.__extends)(e,t),e.prototype.getEventType=function(){return"Owa_PageLoadTime"},e}(i.a);function d(t,e){return t&&t>0&&e&&e>0?Math.floor(t-e):-1}var f=function(t){function e(e,n,r){var i=t.call(this,e,null)||this;return n&&(n.headers&&i.addData(a.b.correlationVectors,n.headers.get("ms-cv")),n.datapoint&&(n.datapoint.mailbox&&i.addData("MailboxType",n.datapoint.mailbox),n.datapoint.customData&&i.addCustomData(n.datapoint.customData))),"number"==typeof r&&i.addData(a.b.attemptCount,r,!0),i.addData(a.b.throughAFD,Object(s.x)()),i}return Object(r.__extends)(e,t),e.prototype.getEventType=function(){return"client_network_request"},e.prototype.addResponseDiagnostics=function(t){var e;t&&(t.headers&&(this.addData(a.b.requestIds,t.headers.get("request-id")),this.addData(a.b.afdId,t.headers.get("x-msedge-ref")),this.addData(a.b.contentEncoding,t.headers.get("content-encoding")),this.addData(a.b.responseContentLength,t.headers.get("content-length"),!0),this.logTimeDifferenceForHeaders(t.headers,"x-frontend-begin","x-frontend-end",a.c.FETimeElapsed),this.logTimeDifferenceForHeaders(t.headers,"x-backend-begin","x-backend-end",a.c.BETimeElapsed)),this.addData(a.b.status,t.status)),(null===(e=window.performance)||void 0===e?void 0:e.now)&&(this.parsingTime=window.performance.now())},e.prototype.addErrorDiagnostics=function(t){this.options=this.options||{},this.options.isCore=!0;var e=typeof t;"object"==e?(this.addData(a.a.errorMsg,t.message),this.addData(a.a.errorDetails,t.stack)):"string"==e&&this.addData(a.a.errorMsg,t)},e.prototype.addResourceTimings=function(t,e){this.addData(a.d.Type,t),this.parsingTime&&this.addTiming(a.b.responseRecieved,d(this.parsingTime,e.ST)),this.addTiming(a.d.WorkerStart,e.WS),this.addTiming(a.d.RedirectStart,e.RdS),this.addTiming(a.d.RedirectEnd,e.RdE),this.addTiming(a.d.FetchStart,e.FS),this.addTiming(a.d.DomainLookupStart,e.DS),this.addTiming(a.d.DomainLookupEnd,e.DE),this.addTiming(a.d.ConnectStart,e.CS),this.addTiming(a.d.SecureConnectionStart,e.SCS),this.addTiming(a.d.ConnectEnd,e.CE),this.addTiming(a.d.RequestStart,e.RqS),this.addTiming(a.d.ResponseStart,e.RpS),this.addTiming(a.d.ResponseEnd,e.RpE),this.addData(a.d.NextHopProtocol,e.P)},e.prototype.addTiming=function(t,e){this.addData(t,e,!0)},e.prototype.logTimeDifferenceForHeaders=function(t,e,n,r){var i=t.get(e),o=t.get(n),a=i?new Date(i):void 0,s=o?new Date(o):void 0;if(a&&s){var c=Math.abs(s.getTime()-a.getTime());this.addCustomProperty(r,c)}},e}(i.a),l=n(49),p=n(65),h=n(1069);function g(t){Object(p.f)("an-log-assets")&&t.forEach(function(t){if(t&&(Object(h.a)(t.name,".js")||Object(h.a)(t.name,".json"))){var e=t.name.split("/"),n=e[e.length-1],r=new f(n);r.addResourceTimings("Asset",t),mt(r)}})}function v(t,e){if(t){var n=t.fetchStart||t.startTime;return{name:e||t.name,ST:n,WS:d(t.workerStart,n),RdS:d(t.redirectStart,n),RdE:d(t.redirectEnd,n),FS:d(t.fetchStart,n),DS:d(t.domainLookupStart,n),DE:d(t.domainLookupEnd,n),CS:d(t.connectStart,n),SCS:d(t.secureConnectionStart,n),CE:d(t.connectEnd,n),RqS:d(t.requestStart,n),RpS:d(t.responseStart,n),RpE:d(t.responseEnd,n),P:t.nextHopProtocol}}}var b,m={},O={};function y(t){return new Promise(function(e){var n=T(t);if(!Object(l.f)()||-1==n)return e(void 0);m[n]=function(t,e){if(t)return function(n){t(n),e(n)};return e}(m[n],e),w(),clearTimeout(b),b=setTimeout(function(){var t,e;w();try{for(var n=Object(r.__values)(Object.keys(m)),i=n.next();!i.done;i=n.next()){S(i.value)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}O={}},2e3)})}function w(){var t,e,n;n=window.performance.getEntriesByType("resource"),O=n.reduce(function(t,e){var n=T(e.name);return n>-1&&(t[n]=e),t},O||{}),g(n.map(function(t){return v(t)})),window.performance.clearResourceTimings?window.performance.clearResourceTimings():window.performance.webkitClearResourceTimings&&window.performance.webkitClearResourceTimings();try{for(var i=Object(r.__values)(Object.keys(m)),o=i.next();!o.done;o=i.next()){var a=o.value,s=O[a];s&&S(a,s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}function S(t,e){m[t](v(e)),delete m[t],delete O[t]}var j=/n=([\d]+)/;function T(t){var e=j.exec(t);return e&&parseInt(e[1])||-1}function E(t,e,n,r,i){var o=new f(e,i,r);return t.then(function(t){var e;return o.addResponseDiagnostics(t),(null===(e=i)||void 0===e?void 0:e.datapoint)&&(i.datapoint.headersCustomData&&t&&o.addCustomData(i.datapoint.headersCustomData(t.headers)),i.datapoint.jsonCustomData)?t.clone().json().then(function(t){o.addCustomData(i.datapoint.jsonCustomData(t))}):Promise.resolve()}).catch(function(t){o.addErrorDiagnostics(t)}).then(function(){return y(n)}).then(function(t){t&&o.addResourceTimings("ServiceAction",t),mt(o)})}var _=n(431),D=n(3),A=n(286),C=function(t){var e=t.eventName;if(e&&Object(D.d)("dp")&&(!Object(D.a)("dp")||e.toLowerCase().indexOf(Object(D.a)("dp").toLowerCase())>-1)||Object(_.a)().traceDatapoints)Object(A.a)(t.properties),Object(A.b)(t)},L=function(){var t=navigator,e=t.connection||t.mozConnection||t.webkitConnection;return e?{type:e.type,effectiveType:e.effectiveType,downlink:e.downlink,rtt:e.rtt,saveData:e.saveData}:null},x=null,I=!1;"undefined"!=typeof location&&(I=location.hostname&&location.hostname.indexOf("live.com")>-1);var k=function(){if(!x){var t=Object(o.f)();t&&(x=t.IsConsumerChild?"c_child":t.SessionSettings.IsPremiumConsumerMailbox?"c_premium":t.SessionSettings.IsShadowMailbox?"c_shadow":I?"c_standard":"business")}return x},R=n(177);function P(t){return R.AWTLogManager.getLogger(t)}function M(t){return{name:t,properties:{}}}function F(t){var e;return Object(D.e)()||(null===(e=t)||void 0===e?void 0:e.isTesting)||Object(s.y)()}function N(t,e,n,r,i){var o,a={Features:JSON.stringify(Object(p.b)()),ServiceVersion:Object(s.v)(),Dag:Object(s.i)(),BootType:i,UserAgent:window.navigator.userAgent};if(n){var c=n.UserOptions,u=n.ViewStateConfiguration,d={WindowWidth:window.innerWidth,WindowHeight:window.innerHeight};window.screen&&(d.ScreenWidth=window.screen.availWidth,d.ScreenHeight=window.screen.availHeight),a.Settings=JSON.stringify({ReadingPanePosition:c.GlobalReadingPanePositionReact,ListViewType:c.GlobalListViewTypeReact,FocusedEnabled:c.IsFocusedInboxEnabled,FocusedInboxBits:u.FocusedInboxBitFlags,ListViewBits:u.ListViewBitFlags,FolderViewBits:u.GlobalFolderViewState,PreviewText:c.ShowPreviewTextInListView,SenderOnTop:c.ShowSenderOnTopInListView,InlinePreviews:c.ShowInlinePreviews,HoverActions:u.MailTriageOnHoverActions,Ponts:c.NewEnabledPonts,Theme:(c.ThemeStorageId||"")+"|"+c.IsDarkModeTheme,MasterCategories:(n.MasterCategoryList.MasterList||[]).length,IsEdu:null===(o=r)||void 0===o?void 0:o.IsEdu,NetworkInfo:L(),Dimensions:d,AdMarket:n.AdMarket,DisplayDensity:c.DisplayDensityMode,ConsumerAdsExperiment:c.ConsumerAdsExperimentMode,Domain:n.SessionSettings.TenantDomain}),a.Dates=JSON.stringify({OwaLogon:c.FirstOWALogon,MailLogon:c.FirstOWAReactMailLogon,PeopleLogon:c.FirstOWAReactPeopleLogon,CalendarLogon:c.FirstOWAReactCalendarLogon,MiniLogon:c.FirstOWAReactMiniLogon,MailboxCreate:n.MailboxCreateDate})}var f=function(t){var e={name:"session",type:"session",properties:t};return e.priority=R.AWTEventPriority.High,e}(a);W(f),F(t)||P(e).logEvent(f)}function W(t){var e=Object(o.f)().SessionSettings;t.properties.BEServer=Object(s.d)(),t.properties.MBXGuid=e.MailboxGuid,t.properties.Forest=Object(s.j)(),t.properties.Puid=e.UserPuid,t.properties.ClientId=Object(s.g)(),t.properties.Ring=Object(s.o)(),t.properties.UserType=k(),t.properties.App=Object(s.c)(),t.properties.Layout=Object(s.n)(),t.properties.TenantGuid=e.ExternalDirectoryTenantGuid,t.properties["Session.Id"]=Object(s.w)(),t.properties.PhysicalRing=Object(s.r)(),t.properties.Host=Object(s.l)(),t.properties.HostedScenario=Object(s.m)()}var U=n(5199),H=n(279),B=["https://swc.cdn.skype.com","https://acdn.adnxs.com/","https://s.aolcdn.com"];var V,q="client_error",G="diagnostics",$=function(t){function e(e){var n,r,i,o=this,a=e.stack||e.message,s=a?U.Md5.hashStr(a):-1;(o=t.call(this,s)||this).isExternal=(r=e.message,i=e.stack,B.some(function(t){return r&&r.indexOf(t)>-1||i&&i.indexOf(t)>-1}));try{o.addData("message",e.message),o.addData("background",Object(H.b)()),o.addIfNotNull("name",e.name),o.addIfNotNull("stack",e.stack||new Error(e.message).stack),o.addIfNotNull("file",e.filename),o.addIfNotNull("line",e.lineno,!0),o.addIfNotNull("col",e.colno,!0),o.addIfNotNull("httpstatus",e.httpStatus,!0),o.addIfNotNull(G,e.diagnosticInfo),(null===(n=window)||void 0===n?void 0:n.navigator)&&"boolean"==typeof window.navigator.onLine&&o.addData("online",window.navigator.onLine)}catch(t){o.addData(G,t.message)}return o}return Object(r.__extends)(e,t),e.prototype.getEventType=function(){return this.isExternal?"client_error_external":q},e.prototype.addIfNotNull=function(t,e,n){e&&this.addData(t,e,n)},e}(i.a);function z(t){return void 0===V&&(V=Math.floor(1e4*Math.random())),V<100*t}var J=n(356),K=n(62),X=n(112),Z=n(245),Y="EUII";function Q(t,e){var n,r,i,a,c,u,d;if(Object(p.f)("fwk-sigs")){var f=null===(n=Object(o.f)())||void 0===n?void 0:n.SessionSettings,l=(null===(r=e)||void 0===r?void 0:r.customProperties)?e.customProperties:{},h={SignalType:t,Locale:null===(i=f)||void 0===i?void 0:i.UserCulture,Compliance:(null===(a=e)||void 0===a?void 0:a.compliance)||Y,StartTime:((null===(c=e)||void 0===c?void 0:c.start)||new Date).toISOString(),EndTime:(new Date).toISOString(),Application:{AadAppId:"00000002-0000-0ff1-ce00-000000000000",AppName:"OWA",AppVer:Object(s.h)(),Workload:"EXO"},Actor:{AadTenantId:null===(u=f)||void 0===u?void 0:u.ExternalDirectoryTenantGuid,ActorIdType:Object(Z.a)()?"MSA":"AAD",ActorId:f&&tt(f),ActorType:"User"},Device:{},CustomProperties:l};(null===(d=e)||void 0===d?void 0:d.itemId)&&(h.Item={ItemType:"Message",ItemId:e.itemId}),Object(X.d)("/api/v2.0/me/signals",h,null,!1,{Prefer:'exchange.behavior="SignalAccessV2,OpenComplexTypeExtensions,EhamJitProvisioning",outlook.data-source="Substrate"'},!1,!0,!0,"SigsUpload",{customData:{Type:t}})}}function tt(t){return(Object(Z.a)()?"":"PUID:")+t.UserPuid}var et=n(385),nt=window.owaBackfilledErrors;var rt,it=n(127),ot=n(410),at=n(392),st=n(125),ct=n(116);n.d(e,"getInitializeAnalyticsPromse",function(){return dt}),n.d(e,"defaultAnalyticsOptions",function(){return ft}),n.d(e,"initializeAnalytics",function(){return lt}),n.d(e,"getOTelAddinsLogger",function(){return pt}),n.d(e,"flush",function(){return ht}),n.d(e,"shouldLogDatapoint",function(){return bt}),n.d(e,"logDatapoint",function(){return mt}),n.d(e,"logCLPAriaDataPoint",function(){return wt}),n.d(e,"getResourceTimingForUrl",function(){return y}),n.d(e,"logSigsDatapoint",function(){return Q});var ut=new Promise(function(t){rt=t});function dt(){return ut}var ft={ariaTenantTokens:[],isTesting:!1,maxErrorsPerSession:100,flightControls:null,verboseWhiteListEvents:[]};function lt(t){var e,n;return Object(r.__awaiter)(this,void 0,void 0,function(){var i,a,d,f,h,b,m;return Object(r.__generator)(this,function(O){switch(O.label){case 0:if(!((null===(e=t)||void 0===e?void 0:e.ariaTenantTokens)&&t.ariaTenantTokens.length>0))return[3,8];t=Object(r.__assign)(Object(r.__assign)({},ft),t),(Object(p.f)("ring-dogfood")||Object(p.f)("an-no-sample-ppe"))&&delete t.flightControls,y=t.ariaTenantTokens[0],R.AWTLogManager.setTransmitProfile(R.AWT_NEAR_REAL_TIME),R.AWTLogManager.initialize(y),i=R.AWTLogManager.getSemanticContext(),a=Object(o.f)(),i&&(i.setAppVersion(Object(s.h)()),a&&(i.setUserTimeZone(a.UserOptions.TimeZone),i.setUserLanguage(a.SessionSettings.UserCulture))),rt(t),O.label=1;case 1:return O.trys.push([1,,6,7]),Object(ct.b)()?(h=null,[3,4]):[3,2];case 2:return[4,Object(at.a)()];case 3:h=O.sent(),O.label=4;case 4:return d=h,[4,Object(s.e)()];case 5:return f=O.sent(),[3,7];case 6:return t.ariaTenantTokens.forEach(function(e){N(t,e,a,d,f)}),mt(new u(f)),[7];case 7:!function(t){for(var e=0;nt&&e<nt.length;e++)t.apply(null,nt[e]);window.owaErrorHandler=t,nt=[]}(K.b),(null===(n=window.performance)||void 0===n?void 0:n.timing)&&g([v(window.performance.timing,"indexPage")]),(b=Object(l.e)()).errors.forEach(yt),b.network.forEach(function(t){return E.apply(null,t)}),Object(K.c)(function(t,e,n){e==K.a.Error&&yt(n)}),Object(it.registerCreateServiceResponseCallback)(E),Object(ot.b)(E),(m=Object(c.f)())&&new st.a("PageLoadTime",{isCore:!0,isCosmosDatapoint:!0}).end(m.time,function(t,e){if("ok"==t)return"Success";if("fail"==t)return e?"ServerError":"ClientError";return"UserError"}(m.status,m.isServer)),O.label=8;case 8:return[2]}var y})})}function pt(t){return P(t)}function ht(){R.AWTLogManager.flush(function(){})}function gt(t,e){var n;return null===(n=e)||void 0===n||!n.flightControls||t.options&&t.options.isCore?null:e.flightControls[t.getEventType()]}var vt=0;function bt(t,e){var n,r,o=t.getEventType();if(Object(i.d)(o))return!0;if(o==i.b&&(!e.verboseWhiteListEvents||-1==e.verboseWhiteListEvents.indexOf(t.eventName)))return!1;if(o==q&&++vt>e.maxErrorsPerSession)return!1;var a=gt(t,e);return!(a&&!Object(p.c)(a.flight))&&((null===(n=t.options)||void 0===n||!n.logEvery||(t.sessionOccurence-1)%t.options.logEvery==0)&&((null===(r=t.options)||void 0===r||!r.ring||t.options.ring==Object(s.o)())&&(function(t){return!t.options||!t.options.sessionSampleRate||z(t.options.sessionSampleRate)}(t)&&function(t){var e;switch(null===(e=t.options)||void 0===e?void 0:e.variant){case 0:return!1;case 2:return 1==t.sessionOccurence;case 3:return t.sessionOccurence>1;default:return!0}}(t))))}function mt(t){ut.then(function(e){var n,r=Object(p.f)("an-full-logging"),o=gt(t,e);if(bt(t,e)||r){C(t);for(var a=function(t,e){var n;return(null===(n=e)||void 0===n?void 0:n.tenantTokens)?e.tenantTokens:t.ariaTenantTokens}(e,t.options),s=t.getEventType(),c=0;c<a.length;c++){var u=M(r?i.b:s);r&&(u.properties.OriginalEvent=s);for(var d=Object.keys(t.properties),f=0;f<d.length;f++){var l=t.properties[d[f]];u.properties[d[f]]=l.value}W(u),u.properties.Sampled=(null===(n=o)||void 0===n?void 0:n.rate)?o.rate:100,t.propertyBag&&(u.properties.MiscData=Object(A.b)(t)),t.piiBag&&(u.properties.PiiData={value:Object(A.a)(t.piiBag),pii:R.AWTPiiKind.GenericData}),F(e)||P(a[c]).logEvent(u)}}})}var Ot=["out of memory","not enough storage is available"];function yt(t){try{var e=t.networkError?"NETWORK_ERROR":function(t){if(t)for(var e=0;e<Ot.length;e++)if(t.toLowerCase().indexOf(Ot[e])>-1)return!0;return!1}(t.message)&&"MEMORY_ERROR";mt(e?new et.a(e,{message:t.message,diagnosticInfo:t.diagnosticInfo}):new $(t))}catch(t){}}function wt(t){var e=M("CLPLabel");Object.keys(t).map(function(n){e.properties[n]=t[n]}),P(Object(J.b)()).logEvent(e)}},803:function(t,e,n){"use strict";var r=Array.isArray;e.a=r},879:function(t,e,n){"use strict";var r=n(194),i=n(915),o=n(803),a=n(329),s=1/0,c=r.a?r.a.prototype:void 0,u=c?c.toString:void 0;e.a=function t(e){if("string"==typeof e)return e;if(Object(o.a)(e))return Object(i.a)(e,t)+"";if(Object(a.a)(e))return u?u.call(e):"";var n=e+"";return"0"==n&&1/e==-s?"-0":n}},900:function(t,e,n){"use strict";var r=n(1049);e.a=function(t){var e=Object(r.a)(t),n=e%1;return e==e?n?e-n:e:0}},912:function(t,e,n){"use strict";var r=n(879);e.a=function(t){return null==t?"":Object(r.a)(t)}},915:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}}}]);
//# sourceMappingURL=owa.Analytics.js.map
self.scriptsLoaded['owa.Analytics.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Analytics.js'] = (new Date()).getTime();