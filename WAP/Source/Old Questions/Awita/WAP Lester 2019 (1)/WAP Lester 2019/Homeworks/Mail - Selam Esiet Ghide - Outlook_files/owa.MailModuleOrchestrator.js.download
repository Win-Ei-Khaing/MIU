self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailModuleOrchestrator.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[351],{1017:function(n,e,t){"use strict";t.d(e,"c",function(){return o}),t.d(e,"a",function(){return a}),t.d(e,"b",function(){return i});var r=t(40),a="HTML",i="Text",c="Html";function o(){return Object(r.a)().UserOptions.ComposeMarkup==c?"HTML":"Text"}},1058:function(n,e,t){"use strict";t.d(e,"a",function(){return o});var r=t(0),a=t(821),i=t(814),c=t(62);function o(){var n,e,t=Object(i.a)();try{for(var o=Object(r.__values)(t.tabs),u=o.next();!u.done;u=o.next()){var s=u.value;if(s.isActive&&s.type!=a.a.FloatingChat)return s}}catch(e){n={error:e}}finally{try{u&&!u.done&&(e=o.return)&&e.call(o)}finally{if(n)throw n.error}}return c.d.error("There is no active tab. Something went very wrong."),null}},1098:function(n,e,t){"use strict";var r=t(1138);t(809),t(50),t(832);t(820),t(846);t.d(e,"a",function(){return r.a})},1138:function(n,e,t){"use strict";t.d(e,"a",function(){return a});var r=t(809);function a(){return(location?location.pathname:"").split("/").indexOf(r.c)>=0}},1157:function(n,e,t){"use strict";var r=t(821),a=t(1483),i=t(1058),c=t(1861),o=t(1952),u=t(49),s=t(1197);e.a=Object(u.c)("activateTab",a.a.TabViewActivateTab)(function(n,e){var t,a;switch(Object(c.a)(n,!0),n.type){case r.a.FloatingChat:return void Object(o.a)(n);case r.a.Primary:case r.a.OverflowMenu:case r.a.SecondaryReadingPane:case r.a.Compose:if(!n.isActive){var u,d=Object(i.a)();if(d)d.isActive=!1,(null===(t=u=Object(s.a)(d.type))||void 0===t?void 0:t.onDeactivate)&&u.onDeactivate(d);if(n)n.isActive=!0,n.blink=!1,(null===(a=u=Object(s.a)(n.type))||void 0===a?void 0:a.onActivate)&&u.onActivate(n)}return}})},1191:function(n,e,t){"use strict";t.d(e,"a",function(){return u});var r=t(0),a=t(948),i=t(814),c=t(889),o=t(160);function u(n,e,t){var u,l,b;void 0===e&&(e=0);var v=function(n){switch(n){case 0:return s;case 1:return d;case 2:return f;default:return Object(o.a)(n)}}(e),O=Object(c.b)();try{for(var m=Object(r.__values)(Object(i.a)().tabs),p=m.next();!p.done;p=m.next()){var w=p.value;if(w.type==a.a.Compose&&!w.isShown){var j=O.viewStates.get(w.data);if((null===(b=j)||void 0===b?void 0:b.isInlineCompose)&&v(j,n)&&(0==j.asyncSendState||t&&6==j.asyncSendState))return j}}}catch(n){u={error:n}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(u)throw u.error}}return null}function s(n,e){return n.conversationId===e}function d(n,e){return n.referenceItemId.Id===e}function f(n,e){return!1}},1197:function(n,e,t){"use strict";t.d(e,"b",function(){return i}),t.d(e,"a",function(){return c});var r=t(821),a={};function i(n,e){a[r.a[n]]=e}function c(n){return a[r.a[n]]}},1217:function(n,e,t){"use strict";t.d(e,"b",function(){return a}),t.d(e,"a",function(){return i});var r=t(1951);function a(n){var e,t,r;return n.isDirty||(null===(e=n.toRecipientWell)||void 0===e?void 0:e.isDirty)||(null===(t=n.ccRecipientWell)||void 0===t?void 0:t.isDirty)||(null===(r=n.bccRecipientWell)||void 0===r?void 0:r.isDirty)}function i(n){return Object(r.a)(n.toRecipientWell)+Object(r.a)(n.ccRecipientWell)+Object(r.a)(n.bccRecipientWell)}},1285:function(n,e,t){"use strict";var r=t(4),a=Object(r.actionCreator)("ADD_CHAT_TAB",function(n){return{chatConversationId:n}});e.a=a},1323:function(n,e,t){"use strict";t.d(e,"a",function(){return a});var r=t(0);function a(n){var e,t,a,i,c=[];if(null===(a=n)||void 0===a?void 0:a.recipients)try{for(var o=Object(r.__values)(n.recipients),u=o.next();!u.done;u=o.next()){var s=u.value,d=s.persona.EmailAddress;(null===(i=d)||void 0===i?void 0:i.ItemId)&&"PrivateDL"==d.MailboxType?c.push({Name:d.Name,RoutingType:d.RoutingType,MailboxType:d.MailboxType,ItemId:{Id:d.ItemId.Id,ChangeKey:null},EmailAddressIndex:d.EmailAddressIndex,RelevanceScore:d.RelevanceScore||0}):c.push(s.persona.EmailAddress)}}catch(n){e={error:n}}finally{try{u&&!u.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return c}},1412:function(n,e,t){"use strict";var r=t(745),a=t.n(r),i=t(69);function c(n){n&&(n.isDirty=!1)}e.a=Object(i.action)("updateComposeItemId")(function(n,e,t,r){n&&(n.itemId?n.itemId.ChangeKey=t:n.itemId=a()({Id:e,ChangeKey:t}),r&&(n.lastSaveTimeStamp=r,n.isDirty=!1,c(n.toRecipientWell),c(n.ccRecipientWell),c(n.bccRecipientWell)))})},1413:function(n,e,t){"use strict";t.d(e,"a",function(){return i});var r=t(0),a=t(1754);function i(n){var e;return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,a.c.import()];case 1:return t=r.sent(),n&&t(null===(e=n.referenceItemId)||void 0===e?void 0:e.Id),[2]}})})}},14151:function(n,e,t){"use strict";t.r(e);var r=t(4),a=Object(r.action)("closeImmersiveReadingPane",function(n){return{source:n}}),i=t(1036),c=t(1037),o=t(69),u=t(731),s=t(807),d=Object(o.action)("onReadingPanePositionOptionSaved")(function(){Object(i.a)(!0),Object(c.a)(!Object(s.b)()),u.O.rowInfoForVLV.clear()}),f=t(864),l=t(948),b=Object(o.action)("onReplyOrReplyAllOrForwardMessage")(function(){var n=Object(l.c)();!Object(s.b)()||n&&n.type!=l.a.Primary||(Object(f.y)(!0),Object(f.x)(!1))}),v=t(972),O=t(889),m=t(1098),p=Object(o.action)("mailModuleOrchestrator.onSelectingFolder")(function(){null===O.a.primaryComposeId||Object(m.a)()?Object(s.b)()&&a():v.x.importAndExecute(null)}),w=Object(o.action)("onSelectMessageAd")(function(){Object(f.y)(!0),Object(f.x)(!Object(s.b)())}),j=t(1297),y=t(888);function g(n){if(Object(s.b)())switch(n){case y.c.MailList:a();break;case y.c.ReadingPane:case y.c.ConversationAttachmentWell:}j.b.importAndExecute()}y.G.eventManager.on(y.f.CloseEvent,g);var h=t(2557),C=(Object(r.orchestrator)(h.b,function(n){Object(f.x)(!0),Object(f.y)(!Object(s.b)())}),t(0)),S=t(2439),A=t(905),_=t(1753),T=t(2290),I=t(1216),R=t(151);Object(r.orchestrator)(a,function(n){if(!Object(s.b)())throw new Error("closeImmersiveReadingPane should only be called with reading pane off");var e=Object(A.a)(),t=Object(T.b)(e.tableQuery);if("messageSuggestion"!==t){if("mail"===t){var r=n.source||"Unknown";Object(R.m)("Search_ReadingPaneClosed",[r])}var a=Object(I.a)();if(Object(f.x)(!0),Object(f.y)(!1),a&&1==e.selectedRowKeys.size){var i=Object(C.__spread)(e.selectedRowKeys.keys())[0];_.i.importAndExecute(i,e)}}else Object(S.a)("CommandBar")});var P=t(52),M=Object(P.e)(f.v,"CLONE_CLIENT_READING_PANE_POSITION_CHANGE",function(n){return Object(C.__awaiter)(void 0,void 0,void 0,function(){var n,e,t,r;return Object(C.__generator)(this,function(a){return n=Object(A.a)(),e=Object(s.b)(),t=!e||Object(I.a)()&&1==n.selectedRowKeys.size,r=!e||!t,Object(f.y)(t),Object(f.x)(r),u.O.rowInfoForVLV.clear(),[2]})})});t.d(e,"closeImmersiveReadingPane",function(){return a}),t.d(e,"onReadingPanePositionOptionSaved",function(){return d}),t.d(e,"onReplyOrReplyAllOrForwardMessage",function(){return b}),t.d(e,"onSelectingFolder",function(){return p}),t.d(e,"onSelectMessageAd",function(){return w}),t.d(e,"onSxSPreviewPaneClose",function(){return g}),t.d(e,"onClientReadingPanePositionChangeOrchestrator",function(){return M})},1482:function(n,e,t){"use strict";t.d(e,"a",function(){return a});var r=t(4),a=Object(r.action)("messageBeingSent")},1483:function(n,e,t){"use strict";e.a={TabViewAddTab:{name:"TabViewAddTab",customData:function(n,e,t,r){return[n,e,t]}},TabViewCloseTab:{name:"TabViewCloseTab",customData:function(n,e){return[n.type,n.isShown,n.isActive,e,n.startTime?(new Date).getTime()-n.startTime:0]}},TabViewActivateTab:{name:"TabViewActivateTab",customData:function(n,e){return[n.type,e]},options:{isVerbose:!0}}}},1484:function(n,e,t){"use strict";var r=t(4),a=Object(r.createStore)("MRUAttachmentStore",{attachments:[]});e.a=a},1485:function(n,e,t){"use strict";var r=t(4);e.a=Object(r.action)("onInlineComposeSendStateChange",function(n,e){return{viewState:n,isSendPending:e}})},1753:function(n,e,t){"use strict";t.d(e,"a",function(){return i}),t.d(e,"k",function(){return c}),t.d(e,"l",function(){return o}),t.d(e,"d",function(){return u}),t.d(e,"c",function(){return s}),t.d(e,"g",function(){return d}),t.d(e,"e",function(){return f}),t.d(e,"b",function(){return l}),t.d(e,"j",function(){return b}),t.d(e,"i",function(){return v}),t.d(e,"h",function(){return O}),t.d(e,"f",function(){return m});var r=t(52),a=new r.c(function(){return Promise.all([t.e(38),t.e(73),t.e(358)]).then(t.bind(null,4224))}),i=new r.a(a,function(n){return n.clearAutoMarkAsReadTimer}),c=new r.a(a,function(n){return n.setAutoMarkAsReadTimer}),o=new r.a(a,function(n){return n.toggleRowReadState}),u=new r.b(a,function(n){return n.markItemsAsReadBasedOnNodeIds}),s=new r.a(a,function(n){return n.markItemAsReadFromReadingPane}),d=new r.a(a,function(n){return n.onKeyboardMarkAsRead}),f=new r.a(a,function(n){return n.markReadOnTableViewChange}),l=new r.a(a,function(n){return n.markAsReadInTable}),b=new r.a(a,function(n){return n.onSingleSelectionChanged}),v=new r.a(a,function(n){return n.onReadingPaneClosed}),O=new r.a(a,function(n){return n.onNavigateAwayViaUpDown}),m=new r.a(a,function(n){return n.onItemPartDeselected})},1754:function(n,e,t){"use strict";t.d(e,"c",function(){return c}),t.d(e,"b",function(){return o});var r=t(52),a=t(1484);t.d(e,"a",function(){return a.a});var i=new r.c(function(){return Promise.all([t.e(4),t.e(130)]).then(t.bind(null,3049))}),c=new r.b(i,function(n){return n.getAttachmentSuggestionsAction}),o=new r.b(i,function(n){return n.createCloudFileFromAttachmentData})},1861:function(n,e,t){"use strict";var r=t(1157),a=t(69),i=t(814);e.a=Object(a.action)("setTabIsShown")(function(n,e){if(n.isShown!=e&&(n.isShown=e,n.blink=e,n.isActive&&!e)){var t=Object(i.a)(),a=t.tabs.indexOf(n),c=t.tabs.filter(function(e){return e.id==n.parentTabId&&e.isShown})[0]||function(n,e){e<0&&(e=0);for(var t=e;t<n.length;t++)if(n[t].isShown)return n[t];for(t=e-1;t>=0;t--)if(n[t].isShown)return n[t];return null}(t.tabs,a);c&&Object(r.a)(c)}})},1910:function(n,e,t){"use strict";var r=t(0),a=t(1157),i=t(1483),c=t(1058),o=t(821),u=t(49),s=t(814),d=1;e.a=Object(u.c)("addTab",i.a.TabViewAddTab)(function(n,e,t,i){var u=Object(c.a)(),f=Object(s.a)(),l={id:o.a[n]+(d++).toString(),isShown:e,isActive:!1,startTime:(new Date).getTime(),parentTabId:u?u.id:null,blink:e,data:i},b=null;switch(n){case o.a.Primary:b=Object(r.__assign)(Object(r.__assign)({},l),{type:o.a.Primary});break;case o.a.OverflowMenu:b=Object(r.__assign)(Object(r.__assign)({},l),{type:o.a.OverflowMenu,data:i});break;case o.a.SecondaryReadingPane:b=Object(r.__assign)(Object(r.__assign)({},l),{type:o.a.SecondaryReadingPane,data:i});break;case o.a.Compose:b=Object(r.__assign)(Object(r.__assign)({},l),{type:o.a.Compose,data:i});break;case o.a.FloatingChat:b=Object(r.__assign)(Object(r.__assign)({},l),{type:o.a.FloatingChat,data:i,isChatActive:!1})}f.tabs.push(b),t&&Object(a.a)(f.tabs[f.tabs.length-1])})},1951:function(n,e,t){"use strict";function r(n){var e;return(null===(e=n)||void 0===e?void 0:e.recipients)?n.recipients.length:0}t.d(e,"a",function(){return r})},1952:function(n,e,t){"use strict";var r=t(69);e.a=Object(r.action)("toggleChatTab")(function(n){n.isChatActive=!n.isChatActive,n.isActive=n.isChatActive,n.blink=!1})},2557:function(n,e,t){"use strict";t.d(e,"d",function(){return a}),t.d(e,"c",function(){return i}),t.d(e,"b",function(){return c}),t.d(e,"a",function(){return o});var r=t(4),a=Object(r.action)("ON_COMPOSE_OPENED"),i=Object(r.action)("ON_COMPOSE_CLOSED"),c=Object(r.action)("ON_CLOSE_FULL_COMPOSE"),o=Object(r.action)("NEW_MESSAGE_V3",function(n,e,t,r,a){return{actionSource:n,groupId:e,toEmailAddressWrappers:t,subject:r,body:a}})},809:function(n,e,t){"use strict";t.d(e,"c",function(){return i}),t.d(e,"b",function(){return c}),t.d(e,"h",function(){return o}),t.d(e,"g",function(){return u}),t.d(e,"f",function(){return s}),t.d(e,"d",function(){return d}),t.d(e,"e",function(){return f}),t.d(e,"a",function(){return l});var r=t(0),a=t(904),i="deeplink",c="compose",o="reply",u="replyall",s="read",d="group",f="/"+Object(r.__spread)(["mail"],Object(a.a)().split("/").slice(1)).join("/")+i+"/",l="/"+Object(r.__spread)(["calendar"],Object(a.a)().split("/").slice(1)).join("/")+i+"/"},814:function(n,e,t){"use strict";t.d(e,"a",function(){return c}),t.d(e,"b",function(){return o});var r=t(821),a=t(4),i={tabs:[{id:"primaryTab",type:r.a.Primary,isShown:!0,isActive:!0,blink:!1}],tabBarWidth:0,isOverflowMenuShown:!1},c=Object(a.createStore)("tab",i),o=(c(),c().tabs[0])},820:function(n,e,t){"use strict";var r=t(809),a=t(50),i=t(832),c=t(39);function o(n,e){if(e){var t=e.displayName?e.displayName+"<"+e.smtpAddress+">":e.smtpAddress;return n?"&"+n+"="+t:t}return""}function u(n,e){return e?"&"+n+"="+e:""}function s(n){var e;if(!(null===(e=n.to)||void 0===e?void 0:e.smtpAddress))return"";var t=c.parse(Object(a.a)().search.substr(1));return t.mailtouri=function(n){var e;if(!(null===(e=n.to)||void 0===e?void 0:e.smtpAddress))return"";var t="mailto:"+o(null,n.to),r="";return r+=o("cc",n.cc),r+=o("bcc",n.bcc),r+=u("subject",n.subject),(r+=u("body",n.body))?t+"?"+r.slice(1):t}(n),Object(i.a)(r.e,r.b,"?"+c.stringify(t))}t.d(e,"a",function(){return s})},821:function(n,e,t){"use strict";var r;t.d(e,"a",function(){return r}),function(n){n[n.Primary=0]="Primary",n[n.OverflowMenu=1]="OverflowMenu",n[n.SecondaryReadingPane=2]="SecondaryReadingPane",n[n.Compose=3]="Compose",n[n.FloatingChat=4]="FloatingChat"}(r||(r={}))},832:function(n,e,t){"use strict";t.d(e,"a",function(){return a});var r=t(248);function a(n,e,t){var a={pathname:n+e,search:t};return r.format(a)}},846:function(n,e,t){"use strict";t.d(e,"a",function(){return c});var r=t(809),a=t(50),i=t(832);function c(n){return n?Object(i.a)(r.e,r.f+"/"+encodeURIComponent(n),Object(a.a)().search):""}},889:function(n,e,t){"use strict";var r=t(21),a=t(4),i={viewStates:new r.ObservableMap,primaryComposeId:null,complianceConfigurations:new r.ObservableMap,messageClassifications:new r.ObservableMap,newMessageCreationInProgress:!1},c=Object(a.createStore)("compose",i),o=c();t.d(e,"a",function(){return o}),t.d(e,"b",function(){return c})},948:function(n,e,t){"use strict";var r=t(1197),a=t(821),i=t(0),c=t(814);function o(n){var e,t,r=Object(c.a)();try{for(var o=Object(i.__values)(r.tabs),u=o.next();!u.done;u=o.next()){var s=u.value;if(s.type!==a.a.Primary&&s.data==n)return s}}catch(n){e={error:n}}finally{try{u&&!u.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return null}var u=t(1058),s=t(52),d=t(1157),f=t(1910),l=t(1285),b=t(4);Object(b.mutator)(l.a,function(n){var e,t;try{for(var r=Object(i.__values)(Object(c.a)().tabs),o=r.next();!o.done;o=r.next()){var u=o.value;if(u.type==a.a.FloatingChat&&u.data==n.chatConversationId)return void Object(d.a)(u,!0)}}catch(n){e={error:n}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}Object(f.a)(a.a.FloatingChat,!0,!0,n.chatConversationId)});t(864);t.d(e,"e",function(){return O}),t.d(e,"f",function(){return m}),t.d(e,"g",function(){return p}),t.d(e,"h",function(){return w}),t.d(e,"a",function(){return a.a}),t.d(e,"b",function(){return o}),t.d(e,"c",function(){return u.a}),t.d(e,"d",function(){return c.a}),t.d(e,"i",function(){return c.b}),t.d(e,"j",function(){return r.b});var v=new s.c(function(){return Promise.all([t.e(49),t.e(67),t.e(73),t.e(475)]).then(t.bind(null,14356))}),O=new s.a(v,function(n){return n.activateTab}),m=new s.a(v,function(n){return n.addTab}),p=new s.a(v,function(n){return n.closeTab}),w=new s.a(v,function(n){return n.setTabIsShown})},972:function(n,e,t){"use strict";var r=t(1482),a=t(52),i=t(1017),c=t(1217),o=(t(1412),t(1323)),u=t(1191),s=t(889),d=t(948),f=t(62);function l(n,e,t){var r,a=Object(s.b)();if(n){switch(n.type){case d.a.SecondaryReadingPane:n.data.listViewType==t&&(r=Object(u.a)(e,t));break;case d.a.Compose:r=a.viewStates.get(n.data);break;case d.a.Primary:r=e?Object(u.a)(e,t,!0):null;break;default:r=null}return r}return f.d.error("There is no active tab. Something went very wrong."),null}var b=t(1413),v=t(4),O=Object(v.action)("onComposeAddinsInitialized",function(n,e){return{hostItemIndex:n,itemId:e}}),m=t(1485);function p(){var n=Object(d.c)(),e=Object(s.b)(),t=n?function(n,e){switch(n.type){case d.a.Primary:return e.primaryComposeId;case d.a.Compose:return n.data;default:return null}}(n,e):e.primaryComposeId,r=t?e.viewStates.get(t):null;return r&&!r.isInlineCompose?r:null}t.d(e,"u",function(){return j}),t.d(e,"m",function(){return y}),t.d(e,"h",function(){return g}),t.d(e,"k",function(){return h}),t.d(e,"o",function(){return C}),t.d(e,"r",function(){return S}),t.d(e,"y",function(){return A}),t.d(e,"x",function(){return _}),t.d(e,"p",function(){return T}),t.d(e,"s",function(){return I}),t.d(e,"w",function(){return R}),t.d(e,"t",function(){return P}),t.d(e,"q",function(){return M}),t.d(e,"j",function(){return x}),t.d(e,"n",function(){return k}),t.d(e,"l",function(){return E}),t.d(e,"v",function(){return D}),t.d(e,"i",function(){return F}),t.d(e,"d",function(){return i.c}),t.d(e,"a",function(){return i.b}),t.d(e,"g",function(){return c.b}),t.d(e,"f",function(){return o.a}),t.d(e,"c",function(){return u.a}),t.d(e,"b",function(){return l}),t.d(e,"z",function(){return b.a}),t.d(e,"B",function(){return O}),t.d(e,"C",function(){return m.a}),t.d(e,"e",function(){return p}),t.d(e,"A",function(){return r.a});var w=new a.c(function(){return Promise.all([t.e(3),t.e(5),t.e(6),t.e(7),t.e(329)]).then(t.bind(null,13720))}),j=new a.a(w,function(n){return n.replyToMessage}),y=new a.a(w,function(n){return n.forwardMessage}),g=new a.a(w,function(n){return n.closeCompose}),h=new a.a(w,function(n){return n.discardCompose}),C=new a.a(w,function(n){return n.loadDraftToCompose}),S=new a.a(w,function(n){return n.openCompose}),A=new a.a(w,function(n){return n.trySendMessage}),_=new a.a(w,function(n){return n.trySaveAndCloseCompose}),T=new a.a(w,function(n){return n.moveComposeToTab}),I=new a.a(w,function(n){return n.recreateComposeFromViewState}),R=new a.a(w,function(n){return n.tryCreateResendDraft}),P=new a.a(w,function(n){return n.replyToApprovalMessage}),M=new a.a(w,function(n){return n.onEditDraftButtonClicked}),x=new a.b(w,function(n){return n.createReply}),k=new a.b(w,function(n){return n.getToCcRecipientsForReply}),E=new a.b(w,function(n){return n.findComposePlugins}),D=new a.b(w,function(n){return n.replyToMessageAndCreateViewState}),F=new a.b(w,function(n){return n.createAttachments});new a.b(w,function(n){return n.findComposeFromRecipientWell})}},0,[1,2,22,577,185,0,578,189,7,379,3,5,6,329,4,12,37,127,38,73,358,342,376]]);
//# sourceMappingURL=owa.MailModuleOrchestrator.js.map
self.scriptsLoaded['owa.MailModuleOrchestrator.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailModuleOrchestrator.js'] = (new Date()).getTime();