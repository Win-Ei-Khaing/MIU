self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailRoutes.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[354],{1007:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return a}),n.d(t,"f",function(){return c});var r=600,i=600,u=650,o=1/2.89*100,a=420,c=420/1300*100},1075:function(e,t,n){"use strict";n.d(t,"t",function(){return d}),n.d(t,"g",function(){return f}),n.d(t,"h",function(){return l}),n.d(t,"i",function(){return b}),n.d(t,"j",function(){return p}),n.d(t,"k",function(){return w}),n.d(t,"l",function(){return v}),n.d(t,"m",function(){return h}),n.d(t,"n",function(){return m}),n.d(t,"o",function(){return g}),n.d(t,"p",function(){return I}),n.d(t,"q",function(){return O}),n.d(t,"r",function(){return j}),n.d(t,"s",function(){return _}),n.d(t,"u",function(){return y});var r=n(2088);n.d(t,"c",function(){return r.a});var i=n(1538);n.d(t,"d",function(){return i.a});var u=n(1499);n.d(t,"f",function(){return u.a});var o=n(52),a=n(1007);n.d(t,"b",function(){return a.a}),n.d(t,"e",function(){return a.d});var c=n(2089);n.d(t,"a",function(){return c.a});var s=new o.c(function(){return Promise.all([n.e(79),n.e(628),n.e(4),n.e(12),n.e(471)]).then(n.bind(null,3997))}),d=new o.b(s,function(e){return e}),f=new o.b(s,function(e){return e.resetPreviewPane}),l=(new o.b(s,function(e){return e.setAudioPreviewState}),new o.b(s,function(e){return e.setBlankPreviewState}),new o.b(s,function(e){return e.setCustomPreviewState}),new o.b(s,function(e){return e.setIframePreviewState})),b=(new o.b(s,function(e){return e.setImageGalleryItems}),new o.b(s,function(e){return e.setImagePreviewLoaded})),p=new o.b(s,function(e){return e.setImagePreviewState}),w=new o.b(s,function(e){return e.setImagePreviewStateFromImageGalleryItem}),v=(new o.b(s,function(e){return e.setNativePdfPreviewState}),new o.b(s,function(e){return e.setPanesSize})),h=(new o.b(s,function(e){return e.setPdfJsPreviewState}),new o.b(s,function(e){return e.setPdfJsPreviewStateByData}),new o.b(s,function(e){return e.setPreviewError})),m=new o.b(s,function(e){return e.setPreviewLoading}),g=new o.b(s,function(e){return e.setRightPaneDisplayAndUpdateSize}),I=new o.b(s,function(e){return e.setSaveStatusText}),O=new o.b(s,function(e){return e.setTextPreviewState}),j=(new o.b(s,function(e){return e.setVideoPreviewState}),new o.b(s,function(e){return e.setWacPreviewState})),_=new o.b(s,function(e){return e.setWacReadOnly}),y=new o.b(s,function(e){return e.updatePanesSize})},14095:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1222);function u(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,Object(i.m)(e.categoryId)];case 1:return t.sent(),[2]}})})}var o=n(4329);function a(e){Object(o.a)(e.folderId)}var c=n(3189),s=n(3916),d=/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$/i;function f(e){if(!e.groupAlias||!e.groupDomain)return null;var t,n=e.groupAlias+"@"+e.groupDomain;return t=n,d.test(t)?n:null}var l=n(151),b=n(3);function p(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,u,o,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(n=f(e))?(Object(l.m)("MailGroupFilesRouteHandlerEvent",{source:Object(b.c)()}),[4,c.a.import()]):[2];case 1:return u=r.sent(),[4,c.c.import()];case 2:return o=r.sent(),u(o.Files),[4,Object(i.q)(n,"groups")];case 3:return r.sent(),a=t&&t.length>2?t[2]:null,[4,s.f.import()];case 4:return r.sent()(n,a?"/"+a:""),[2]}})})}var w=n(7292),v=n(4993);function h(e){Object(v.a)(e.rowId)}function m(e){var t=e.folderId,n=e.rowId;Object(w.a)(t,n)}function g(e,t,n,r){return!!n&&n.some(function(e){return"search"==e})}var I=n(888);function O(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return h(e),[4,I.v.import()];case 1:return t.sent()(e.attachmentId),[2]}})})}function j(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return!!n&&n.some(function(e){return"sxs"==e})?[3,2]:[4,I.r.import()];case 1:e.sent()("browserNavigation"),e.label=2;case 2:return[2,!1]}})})}var _=n(52),y=new _.c(function(){return n.e(275).then(n.bind(null,14376))}),P=new _.b(y,function(e){return e.getSxSStoreViewState}),S=new _.a(y,function(e){return e.resetSxSViewStoreAction});function x(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,S.importAndExecute("browserNavigation")];case 1:return e.sent(),[2,!1]}})})}function A(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,j()]})})}function R(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,p(e,void 0)];case 1:return t.sent(),[2]}})})}var D=n(5572),E=n(6664),F=new _.c(function(){return n.e(268).then(n.bind(null,14196))}),C=new _.b(F,function(e){return e.DeeplinkActionType}),G=new _.a(F,function(e){return e.initializeDeeplink}),V=new _.a(F,function(e){return e.onGroupDetailsLoaded}),k=new _.a(F,function(e){return e.onGroupDetailsLoadError});function N(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,u,o,a,s,d,p,w,h,m=this;return Object(r.__generator)(this,function(g){switch(g.label){case 0:return(t=f(e))?(t=t.toLowerCase(),Object(l.m)("MailGroupRouteHandlerEvent",{source:Object(b.c)()}),n=null,u=null,e.actionId?[4,V.import()]:[3,2]):[2];case 1:g.sent(),o=new Promise(function(e,t){n=function(){V.importAndExecute(),e()},u=function(){k.importAndExecute(),e()}}),g.label=2;case 2:return[4,Object(i.q)(t,"groups",n,u)];case 3:return g.sent(),[4,c.a.import()];case 4:return a=g.sent(),[4,c.c.import()];case 5:return s=g.sent(),a(s.Email),e.actionId?[4,C.import()]:[3,7];case 6:d=g.sent(),null!=(p=d[e.actionId.toLowerCase()])&&(w=function(e){return Object(r.__awaiter)(m,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,E.a.import()];case 1:return t.sent()(e),[2]}})})},h=function(e){return Object(r.__awaiter)(m,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,D.a.import()];case 1:return t.sent()(e),[2]}})})},G.importAndExecute(t,p,w,h)),g.label=7;case 7:return e.rowId&&Object(v.a)(e.rowId),o?[4,o]:[3,9];case 8:g.sent(),g.label=9;case 9:return[2]}})})}var z=n(7207);function B(e){e.assetId?e.campaignId&&e.providerId?z.a.import().then(function(t){t(!1,e.assetId,e.campaignId,e.providerId)}):z.a.import().then(function(t){t(!1,e.assetId)}):z.a.import().then(function(e){e(!0)})}function K(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,i.f.importAndExecute(e.favoriteNodeId)];case 1:return t.sent(),[2]}})})}function L(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,i.h.importAndExecute(e.favoriteNodeId)];case 1:return t.sent(),[2]}})})}var H=n(65),T=n(3415),q=n(2515),M=n(3643),$=n(889),J=n(972),U=n(2588);function W(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return Object(o.a)(e.folderId),e.draftId?[4,J.o.importAndExecute(e.draftId)]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,U.c.importAndExecute("Route")];case 3:t.sent(),t.label=4;case 4:return[2]}})})}function Q(){return!!$.a.primaryComposeId&&J.k.importAndExecute($.a.viewStates.get($.a.primaryComposeId)).then(function(){return!1},function(){return!0})}var X=n(5936);function Y(){Object(X.a)()}var Z=n(864),ee=n(807);function te(e){Object(ee.b)()&&(Object(l.m)("Search_ReadingPaneClosed",["BrowserBackButton"]),Object(Z.y)(!1),Object(Z.x)(!0)),e.rowId&&Object(v.a)(e.rowId)}function ne(e,t,n,r){return!!e&&e.some(function(e){return"sxs"==e})&&(j(0,0,n),Object(Z.y)(!1)),!1}function re(e){e("/help",Y),e("/compose",W,Q),e("/compose/:draftId",W,Q),e("/search/id/:rowId/sxs/:itemId/:attachmentId",O,ne),e("/search/id/:rowId/sxs/:attachmentId",O,ne),e("/search/id/:rowId",h,ne),e("/search",te,ne),e("/id/:rowId",m),function(e){Object(q.a)()&&(e("/group/:groupDomain/:groupAlias",N),e("/group/:groupDomain/:groupAlias/email",N),e("/group/:groupDomain/:groupAlias/email/id/:rowId",N),e("/group/:groupDomain/:groupAlias/action/:actionId",N),function(e){e("/group/:groupDomain/:groupAlias/files/sxs/sp/:spFileId/?((\\w|.)*)",R,x),e("/group/:groupDomain/:groupAlias/files/sxs/attachment/:attachmentId/?((\\w|.)*)",R,A),e("/group/:groupDomain/:groupAlias/files/?((\\w|.)*)",p)}(e))}(e),Object(M.b)(),Object(T.g)(),e("/persons/:favoriteNodeId",K),Object(H.f)("peo-favoritePdls")&&e("/contactlists/:favoriteNodeId",L),e("/category/:categoryId",u),e("/inclientstore",B),e("/inclientstore/assetid/:assetId",B),e("/inclientstore/assetid/:assetId/campaignid/:campaignId/providerid/:providerId",B),e("/:folderId/id/:rowId/sxs/:itemId/:attachmentId",O,j),e("/:folderId/id/:rowId/sxs/:attachmentId",O,j),e("/:folderId/compose/:draftId",W,Q),e("/:folderId/compose",W,Q),e("/:folderId/id/:rowId",m,g),e("/:folderId",a,g)}var ie=n(1075),ue=n(861),oe=n(1318),ae=n(1272),ce=n(761),se=n(71);function de(){var e,t,n,i,u=[],o=Object(M.a)();if(o.length)return o;if($.a.primaryComposeId){u.push("compose");var a=$.a.viewStates.get($.a.primaryComposeId);return(null===(n=a.itemId)||void 0===n?void 0:n.Id)&&u.push(a.itemId.Id),u}var d=Object(ue.c)();if(1===d.type){if(d.id)return u.push("persons"),u.push(d.id),u}else if(5===d.type&&Object(H.f)("peo-favoritePdls")){if(d.id)return u.push("contactlists"),u.push(d.id),u}else if(4===d.type){if(d.id)return u.push("category"),u.push(d.id),u}else if(2===d.type){if(d.id){var f=d.id.split("@");if(2!=f.length)return u;u.push("group"),u.push(f[1]),u.push(f[0]);var l=c.b.tryImportForRender(),b=c.c.tryImportForRender();if(l&&b)switch(l.navigationButtonSelected){case b.Email:u.push("email");break;case b.Files:u.push("files");var p=P.tryImportForRender();if(p){var w=p();if((null===(i=w)||void 0===i?void 0:i.previewPane)&&w.previewPane.mode!=ie.d.Blank){u.push("sxs"),u.push("sp"),u.push(w.previewPane.id);break}}if(I.G.extendedViewState.attachmentId&&!Object(se.s)()){u.push("sxs"),u.push("attachment"),u.push(I.G.extendedViewState.attachmentId.Id);break}var v=s.b.tryImportForRender();if(v){var h=v(d.id);if(h&&h.length>0){"/"==h.charAt(0)&&(h=h.substring(1));var m=h.split("/");try{for(var g=Object(r.__values)(m),O=g.next();!O.done;O=g.next()){var j=O.value;u.push(j)}}catch(t){e={error:t}}finally{try{O&&!O.done&&(t=g.return)&&t.call(g)}finally{if(e)throw e.error}}}}return u}}}else if(3!==d.type&&d.id){if(0===d.type){var _=Object(ae.a)();if(_){var y=_.FolderId.Id;u.push(_.distinguishedFolderId?Object(ce.a)(y):y)}}}else u.push("search");return Object(Z.C)()&&(oe.n.conversationReadingPaneViewState?(u.push("id"),u.push(oe.n.conversationReadingPaneViewState.conversationId.Id)):oe.n.itemReadingPaneViewState&&(u.push("id"),u.push(oe.n.itemReadingPaneViewState.itemId))),I.G.extendedViewState.attachmentId&&(u.push("sxs"),u.push(I.G.extendedViewState.attachmentId.Id)),u}n.d(t,"initializeMailRoutes",function(){return re}),n.d(t,"getCurrentRoute",function(){return de})},2088:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Default=0]="Default",e[e.NeedPassword=1]="NeedPassword",e[e.IncorrectPassword=2]="IncorrectPassword"}(r||(r={}))},2089:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="autoHideEmail"},3643:function(e,t,n){"use strict";var r=n(1127),i=n(0),u=n(1775),o="options";function a(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return t=e.category,n=e.subcategory,u=e.option,[4,r.e.importAndExecute(t,n,u)];case 1:return i.sent(),[2]}})})}function c(e,t,n,u){return Object(i.__awaiter)(this,void 0,void 0,function(){var e,a,c=this;return Object(i.__generator)(this,function(s){return e=n[0]!==o,a=e||t.category!=u.category||t.subcategory!=u.subcategory,[2,new Promise(function(t){return Object(i.__awaiter)(c,void 0,void 0,function(){var n,u=this;return Object(i.__generator)(this,function(o){switch(o.label){case 0:return[4,r.c.import()];case 1:return n=o.sent(),a?n(function(){return Object(i.__awaiter)(u,void 0,void 0,function(){return Object(i.__generator)(this,function(n){switch(n.label){case 0:return t(!1),e?[4,r.d.import()]:[3,2];case 1:n.sent()(!1),n.label=2;case 2:return[2]}})})},function(){return t(!0)}):t(!1),[2]}})})})]})})}function s(){Object(u.b)("/"+o,a,c),Object(u.b)("/"+o+"/:category",a,c),Object(u.b)("/"+o+"/:category/:subcategory",a,c),Object(u.b)("/"+o+"/:category/:subcategory/:option",a,c)}function d(){var e=[],t=Object(r.b)();return t.isFullOptionsShown&&t.currentCategoryKey&&t.currentSubCategoryKey&&(e=[o,t.currentCategoryKey,t.currentSubCategoryKey],t.currentOptionKey&&e.push(t.currentOptionKey)),e}n.d(t,"a",function(){return d}),n.d(t,"b",function(){return s})},3916:function(e,t,n){"use strict";n.d(t,"d",function(){return u}),n.d(t,"e",function(){return o}),n.d(t,"f",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return s}),n.d(t,"a",function(){return d});var r=n(52),i=new r.c(function(){return Promise.all([n.e(4),n.e(12),n.e(47),n.e(273)]).then(n.bind(null,6486))}),u=new r.a(i,function(e){return e.onFilesNavigation}),o=new r.a(i,function(e){return e.onGetGroupDetailsSucceeded}),a=new r.b(i,function(e){return e.setSharePointItemsViewNavigationTargetPath}),c=new r.b(i,function(e){return e.getSharePointItemsViewCurrentPath}),s=new r.b(i,function(e){return e.loadAttachmentInformation}),d=new r.b(i,function(e){return e.clickAttachmentFile})},4329:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1222);function i(e){e?Object(r.p)(e,"Route"):Object(r.l)("Route")}},4993:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(893),i=n(731),u=n(905),o=n(1056);function a(e){var t=Object(u.a)(),n=Object(i.A)([e],t)[0];t.rowKeys.includes(n)&&Object(r.r)(t,n,!0,o.a.RouteHandler)}},5572:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(52),i=new r.c(function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(7),n.e(269)]).then(n.bind(null,8276))}),u=new r.b(i,function(e){return e.editGroup})},5936:function(e,t,n){"use strict";function r(){window.O365Shell.FlexPane.OpenFlexPaneForProvider("Help")}n.d(t,"a",function(){return r})},7207:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return o});var r=n(52),i=new r.c(function(){return Promise.all([n.e(5),n.e(78),n.e(4),n.e(510)]).then(n.bind(null,9346))}),u=new r.b(i,function(e){return e.storeLinkHandler}),o=new r.b(i,function(e){return e.launchStoreUrl})},7292:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(4329),i=n(4993);function u(e,t){Object(r.a)(e),Object(i.a)(t)}}},0,[3,5,8,13,422,604,21,25,38,334,1,2,22,577,185,0,578,189,7,379,16,361,10,626,444,6,329,355,79,4,12,131,37,127,73,358,49,347,353,609,370,238,255,342,376,541,716]]);
//# sourceMappingURL=owa.MailRoutes.js.map
self.scriptsLoaded['owa.MailRoutes.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailRoutes.js'] = (new Date()).getTime();