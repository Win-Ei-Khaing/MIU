self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ItemActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[308],{12938:function(e){e.exports={f:"nuc",d:"ouc",k:"puc",j:"quc",i:"ruc",e:"suc",h:"tuc",l:"uuc",b:"vuc",c:"wuc",g:"xuc",a:"yuc"}},12939:function(e,t,n){var r=n(12940),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},12940:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'.tZW9JCrS32YC2HkVN-WyY{display:block!important}.Isabp7l92KgYue--mXACT{width:auto;height:32px}html[dir] .Isabp7l92KgYue--mXACT{border-radius:2px;background:transparent}html[dir] .Isabp7l92KgYue--mXACT:hover{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir] .Isabp7l92KgYue--mXACT:active{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .Isabp7l92KgYue--mXACT._3i2_PWR38mmJG6N-oVvSc{background-color:"[theme:themeLighter, default:#DEECF9]"}.Isabp7l92KgYue--mXACT._3i2_PWR38mmJG6N-oVvSc.ms-Button .ms-Button-icon,.Isabp7l92KgYue--mXACT._3i2_PWR38mmJG6N-oVvSc.ms-Button .ms-Button-menuIcon,.Isabp7l92KgYue--mXACT:active.ms-Button .ms-Button-icon,.Isabp7l92KgYue--mXACT:active.ms-Button .ms-Button-menuIcon,.Isabp7l92KgYue--mXACT:hover.ms-Button .ms-Button-icon,.Isabp7l92KgYue--mXACT:hover.ms-Button .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}html[dir] .bW0ipvHhaLslVzcuqolhK{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"!important}.aX3RmEGx8HrdPL1yktLRm{width:230px}html[dir] .aX3RmEGx8HrdPL1yktLRm{background-color:"[theme:white, default:#ffffff]"}._3EVsmMkXoUVhUDeorDNq-T{max-height:400px;overflow-x:hidden}._3dfPy9ayr523z3j8V0vi53{overflow:hidden}._3nLjv484RsToOL5jRMWQLH{height:44px}html[dir=ltr] ._3nLjv484RsToOL5jRMWQLH{padding-left:12px}html[dir=rtl] ._3nLjv484RsToOL5jRMWQLH{padding-right:12px}html[dir] ._3nLjv484RsToOL5jRMWQLH:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}',""]),t.locals={likeCustomButtonLabel:"tZW9JCrS32YC2HkVN-WyY",likeIconButtonCustom:"Isabp7l92KgYue--mXACT",isChecked:"_3i2_PWR38mmJG6N-oVvSc",likeCustomButtonActive:"bW0ipvHhaLslVzcuqolhK",callout:"aX3RmEGx8HrdPL1yktLRm",scrollContainer:"_3EVsmMkXoUVhUDeorDNq-T",personaCollection:"_3dfPy9ayr523z3j8V0vi53",persona:"_3nLjv484RsToOL5jRMWQLH"}},12941:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'html[dir=ltr] ._2opPWe6KuVFhEI52_XY6Tw{padding-right:2px}html[dir=rtl] ._2opPWe6KuVFhEI52_XY6Tw{padding-left:2px}._3tBxnKAWFWDe41Zarl9mN{width:100%;min-width:0;height:40px;display:inline-block;-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1;position:relative;top:1px}html[dir=ltr] ._3tBxnKAWFWDe41Zarl9mN{left:2px}html[dir=rtl] ._3tBxnKAWFWDe41Zarl9mN{right:2px}._20q0GP-4M43aJdIUNdbHS_{font-size:14px;color:"[theme:themePrimary, default:#0078D4]"}html[dir] ._20q0GP-4M43aJdIUNdbHS_{background:transparent}._3CHzUb8E75dSDcMFHT_8Qx{height:32px}html[dir] ._3CHzUb8E75dSDcMFHT_8Qx{background-color:transparent;padding:4px 0}.eeijf3m13i_oYyGsPmueH{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}._3ODQEP4a8av7UYmYAIFIRW{height:100%;min-width:32px}html[dir] ._3ODQEP4a8av7UYmYAIFIRW{background-color:transparent;margin:0 2px}._2O1OZ_6q64cOi7BcKWHTR7.ms-ContextualMenu-icon,._2i4F3Q0eiaJ5u4aiXx5D3w:not(._20q0GP-4M43aJdIUNdbHS_),._3ODQEP4a8av7UYmYAIFIRW .ms-Button-label{display:none}._1MncjFzxk89g--zyj1v5O5{width:32px;height:32px}html[dir] ._1MncjFzxk89g--zyj1v5O5{border-radius:2px;background:transparent}._1MncjFzxk89g--zyj1v5O5.ms-Button{width:32px;height:32px}html[dir] ._1MncjFzxk89g--zyj1v5O5:hover{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir] ._1MncjFzxk89g--zyj1v5O5:active{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] ._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN{background-color:"[theme:themeLighter, default:#DEECF9]"}._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN.ms-Button .ms-Button-menuIcon,._1MncjFzxk89g--zyj1v5O5:active.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5:active.ms-Button .ms-Button-menuIcon,._1MncjFzxk89g--zyj1v5O5:hover.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5:hover.ms-Button .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}.aZVJsA6Ilr8olDTFGKR6T{color:"[theme:themePrimary, default:#0078D4]"}._3DE4Hx2dldBiXVAxb2jkoh{color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._3of7CI7D6gm5OF90xXEWK0{background-color:transparent}',""]),t.locals={surfaceActionsCommandBarCharms:"_2opPWe6KuVFhEI52_XY6Tw",surfaceActionsCommandBarContainer:"_3tBxnKAWFWDe41Zarl9mN",surfaceActionsCommandBarOverflowIcon:"_20q0GP-4M43aJdIUNdbHS_",surfaceActionsCommandBar:"_3CHzUb8E75dSDcMFHT_8Qx",surfaceActionsCommandBarPrimarySet:"eeijf3m13i_oYyGsPmueH",surfaceActionsCommandBarButton:"_3ODQEP4a8av7UYmYAIFIRW",commandBarIcon:"_2O1OZ_6q64cOi7BcKWHTR7",commandBarMenuIcon:"_2i4F3Q0eiaJ5u4aiXx5D3w",iconButton:"_1MncjFzxk89g--zyj1v5O5",isChecked:"_37fr-TjgFabRfitZmzNqlN",enabledIconButton:"aZVJsA6Ilr8olDTFGKR6T",disabledIconButton:"_3DE4Hx2dldBiXVAxb2jkoh",disabledReplyActionButton:"_3of7CI7D6gm5OF90xXEWK0"}},12942:function(e){e.exports={b:"luc",a:"muc"}},12943:function(e,t,n){var r=n(12944),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},12944:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._1pVbbNWoU3A2KPJ5mTx9ss{width:750px!important;max-width:750px!important;height:550px;overflow:hidden}._2o7RMkbYm39CgXru8bzVk{width:690px;height:410px;overflow:auto;word-wrap:break-word;white-space:pre-line}._3c9eatHmfdZHfX00YKzcP4{color:"[theme:white, default:#ffffff]"!important}html[dir] ._3c9eatHmfdZHfX00YKzcP4{background-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px}html[dir] ._3c9eatHmfdZHfX00YKzcP4:hover{background-color:"[theme:themeDark, default:#0D62AA]"}html[dir] ._3c9eatHmfdZHfX00YKzcP4:active{background-color:"[theme:themeDarker, default:#004578]"}',""]),t.locals={container:"_1pVbbNWoU3A2KPJ5mTx9ss",content:"_2o7RMkbYm39CgXru8bzVk",button:"_3c9eatHmfdZHfX00YKzcP4"}},12945:function(e){e.exports={a:"juc"}},12946:function(e){e.exports={a:"iuc"}},12947:function(e){e.exports={e:"lrc",d:"mrc",b:"nrc",a:"orc",c:"prc"}},1353:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(40);function o(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},14157:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(103),a=n(1523),i=n(688),s=n(66),c=n(1396),u=n(673),d=n(189),l=n(319),p=n(815),m=n(1),b=n(12938),f=n(5),h=n(40),I=100;function v(e){try{if(e.LikeCount&&e.Likers){var t=Object(h.a)().SessionSettings.UserEmailAddress,n=!!e.Likers&&e.Likers.some(function(e){return e.EmailAddress===t});switch(e.LikeCount){case 1:return n?Object(f.a)(b.f):Object(f.b)(Object(f.a)(b.d),e.Likers[0].Name);case 2:return n?Object(f.b)(Object(f.a)(b.k),e.Likers.filter(function(e){return e.EmailAddress!==t})[0].Name):Object(f.b)(Object(f.a)(b.j),e.Likers[0].Name,e.Likers[1].Name);case 3:return n?Object(f.b)(Object(f.a)(b.i),e.Likers[0].Name,Object(f.a)(b.e)):Object(f.b)(Object(f.a)(b.h),e.Likers[0].Name,e.Likers[1].Name,Object(f.a)(b.e));default:return n?e.LikeCount>=I?Object(f.b)(Object(f.a)(b.l),I-1):Object(f.b)(Object(f.a)(b.b),e.Likers[0].Name,Object(f.b)(Object(f.a)(b.c),e.LikeCount-2)):e.LikeCount>=I?Object(f.b)(Object(f.a)(b.g),I-1):Object(f.b)(Object(f.a)(b.a),e.Likers[0].Name,e.Likers[1].Name,Object(f.b)(Object(f.a)(b.c),e.LikeCount-2))}}}catch(e){return null}return null}function g(e){return e.LikeCount?e.LikeCount<I?e.LikeCount.toString():I-1+"+":null}var O=n(953),j=n(12939),k=n(8927),y=n(297),S=function(e){function t(t){var n=e.call(this,t)||this;return n.handleMouseOver=function(){n.state.isMouseOverButton||n.setState({isMouseOverButton:!0})},n.handleMouseLeave=function(){n.state.isMouseOverButton&&n.setState({isMouseOverButton:!1})},n.handleLikersListMouseOver=function(){n.state.isMouseOverLikersList||n.setState({isMouseOverLikersList:!0})},n.handleLikersListMouseLeave=function(){n.state.isMouseOverLikersList&&n.setState({isMouseOverLikersList:!1})},n.state={isMouseOverButton:!1,isMouseOverLikersList:!1},n}return Object(r.__extends)(t,e),t.prototype.IsLikersListShown=function(){return this.state.isMouseOverLikersList},t.prototype.render=function(){var e=this,t=this.props,n=t.surfaceActionItem,o=t.message,b=o.LikeCount&&o.Likers&&(this.state.isMouseOverButton||this.state.isMouseOverLikersList),f="likeButtonId"+Object(l.a)();return m.createElement(u.a,{content:n.name},m.createElement(a.a,{id:f,role:"button",ariaLabel:n.name,ariaDescription:v(o),iconProps:n.iconProps,styles:{root:y(k.surfaceActionsCommandBarButton,j.likeIconButtonCustom,b&&j.likeCustomButtonActive),label:o.LikeCount&&j.likeCustomButtonLabel,rootChecked:k.checkedCommandBarButton,rootDisabled:k.disabledReplyActionButton,icon:k.enabledIconButton,iconDisabled:k.disabledIconButton,menuIcon:k.commandBarMenuIcon},onClick:function(t){return e.onLikeClicked(t,n)},onMouseEnter:this.handleMouseOver,onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,text:g(o)}),b&&m.createElement(i.a,{className:j.callout,onDismiss:function(){return e.setState(Object(r.__assign)(Object(r.__assign)({},e.state),{isMouseOverButton:!1,isMouseOverLikersList:!1}))},target:"#"+f,isBeakVisible:!1,setInitialFocus:!1,directionalHint:Object(d.a)()?s.a.bottomLeftEdge:s.a.bottomRightEdge},m.createElement("div",{className:y(j.scrollContainer,"customScrollBar"),onMouseEnter:this.handleLikersListMouseOver,onMouseOver:this.handleLikersListMouseOver,onMouseLeave:this.handleLikersListMouseLeave},m.createElement("div",{className:j.personaCollection},o.Likers.map(function(e){return m.createElement(A,{key:e.EmailAddress,emailAddress:e.EmailAddress,name:e.Name,mailBoxType:e.MailboxType,disableHover:!0,clientScenario:"Liker"},m.createElement(p.a,{className:j.persona,key:e.EmailAddress,name:e.Name,emailAddress:e.EmailAddress,size:c.c.size32,showPersonaDetails:!0,mailboxType:e.MailboxType}))})))))},t.prototype.onLikeClicked=function(e,t){t.onClick(e,t),e.stopPropagation()},t=Object(r.__decorate)([o.observer],t)}(m.Component);function A(e){var t=Object(O.a)(e);return m.createElement(t,null,m.createElement("div",null,e.children))}var C=n(12942),P=n(2101),_=n(254),x=n(675),M=n(178),w=n(349),R=n(1081),T=n(1074),B=n(842),L=n.n(B);function F(e){var t;return Object(R.a)([e.ItemId.Id],L()({BaseShape:"IdOnly"}),"MessageDetails","V2016_06_24",null===(t=e.MailboxInfo)||void 0===t?void 0:t.requestOptions).then(function(e){return function(e){if(Object(T.a)(e[0])){var t=e[0].Items[0];if(null!=t.ExtendedProperty&&t.ExtendedProperty.length>=1)return t.ExtendedProperty[0].Value}return null}(e)})}function D(e){var t;return Object(R.a)([e.ItemId.Id],L()({BaseShape:"IdOnly",IncludeMimeContent:!0}),null,"V2016_06_24",null===(t=e.MailboxInfo)||void 0===t?void 0:t.requestOptions).then(function(e){return function(e){return Object(T.a)(e[0])?e[0].Items[0].MimeContent:null}(e)})}var E=n(245),N=n(141),G=n(297),H=n(12943),U=function(e){function t(t){var n=e.call(this,t)||this;return n.onDismiss=function(){n.props.onClose()},n.state={content:""},n}return Object(r.__extends)(t,e),t.prototype.render=function(){return m.createElement(x.a,{hidden:!1,containerClassName:H.container,dialogContentProps:{showCloseButton:!1,title:Object(E.a)()?Object(f.a)(C.b):Object(f.a)(C.a),type:M.a.normal},onDismiss:this.onDismiss},m.createElement("div",{className:G(H.content,"allowTextSelection"),tabIndex:-1},this.state.content),m.createElement(w.a,null,m.createElement(_.a,{onClick:this.onDismiss,className:H.button},Object(f.a)(P.a))))},t.prototype.setContent=function(e){this.setState({content:e})},t=Object(r.__decorate)([o.observer],t)}(m.Component);var z=n(731);function V(e){var t,n,r=Object(z.M)(e)?e:null;if(null==r)return null;var o=null===(t=r.Sender)||void 0===t?void 0:t.Mailbox;if(o){var a=K(o);if(a)return a}var i=null===(n=r.From)||void 0===n?void 0:n.Mailbox;if(i){var s=K(i);if(s)return s}return null}function K(e){return"GroupMailbox"==e.MailboxType||Object(f.g)(e.EmailAddress)?null:Object(f.g)(e.Name)?e.EmailAddress:e.Name}var W=n(21),q=n(22),J=n(2876),X=n(128),Y=n(70),Q=n(806),Z=n(8264),$=n(859),ee=n(151),te=n(131),ne=n(65),re=n(5076),oe=n(3341),ae=n(3343),ie=n(3340),se=n(3342),ce=n(4829),ue=n(3329),de=n(2390),le=n(5723),pe=n(3114),me=n(12945),be=n(12946),fe=n(6955),he=n(5178),Ie=n(3054),ve=n(4326),ge=n(2258),Oe=n(2285),je=n(1297),ke=n(6634),ye=n(4049),Se=n(3820),Ae=n(6213),Ce=n(807),Pe=n(1753),_e=n(6212),xe=n(6673),Me=n(8771),we=n(5176),Re=n(7105),Te=n(7211),Be=n(69),Le=Object(Be.action)("toggleAmpPreference")(function(e){e.preferAmp=!e.preferAmp}),Fe=n(3726),De=n(49),Ee=Object(De.c)("toggleUndoDarkMode",{name:function(e){return e.undoDarkMode?"ToggleDarkModeOn":"ToggleDarkModeOff"},actionSource:"ReadingPane"})(function(e){e&&(e.undoDarkMode=!e.undoDarkMode)}),Ne=n(3103),Ge=n(7715),He=n(4328),Ue=n(6209),ze=n(5072),Ve=n(3453),Ke=n(3331),We=n(956),qe=n(1242),Je=n(1072),Xe=n(1404),Ye=n(4056),Qe=n(1254),Ze=n(12947),$e=n(972),et=n(732),tt=n(1522),nt=n(2801),rt=n(764),ot=n(8927),at=n(130).bind(ot),it="Dropdown",st=5,ct=function(e){function t(t){var n=e.call(this,t)||this;return n.commandBarHiddenOverflowItems=[],n.commandBarDividerKey=0,n.likeButtonClickCount=0,n.likeUnlikeInProgress=!1,n.forcePinnedSurfaceActions=new Set,n.getHandler=function(e,t,r){return function(o,a){Object(nt.l)(!1,r,a,n.getActionSource(a)),t?(n.updateSelectItemPart(),e(o,a)):o.which==Y.a.enter&&(o.preventDefault(),o.stopPropagation(),n.updateSelectItemPart(),e(o,a))}},n.updateSelectItemPart=function(){n.props.viewState.isConversationItemPart&&Object(Fe.a)(n.props.viewState,!1)},n.ItemHeaderToolbarButton=Object(q.a)(function(e){return m.createElement(a.a,Object(r.__assign)({},e,{menuProps:e.menuProps&&Object(r.__assign)(Object(r.__assign)({},e.menuProps),{directionalHint:s.a.bottomAutoEdge}),onMenuClick:n.updateSelectItemPart,styles:Object(r.__assign)(Object(r.__assign)({},e.styles),{root:at(ot.surfaceActionsCommandBarButton,ot.iconButton),rootChecked:ot.checkedCommandBarButton,rootDisabled:ot.disabledReplyActionButton,icon:ot.enabledIconButton,iconDisabled:ot.disabledIconButton,menuIcon:ot.commandBarMenuIcon}),role:"button"}))}),n.ItemHeaderToolbarOverflowButton=Object(q.a)(function(e){var t=n.ItemHeaderToolbarButton;return m.createElement(u.a,{content:Object(f.a)(le.a)},m.createElement(t,Object(r.__assign)({},e)))}),n.onCommandBarReduceData=function(e){var t=e.primaryItems,o=e.overflowItems,a=e.cacheKey,i=t[0];if(void 0!==i)return n.commandBarHiddenOverflowItems=Object(r.__spread)([i],n.commandBarHiddenOverflowItems),t=t.slice(1),a=n.computeCommandBarCacheKey(t),Object(r.__assign)(Object(r.__assign)({},e),{primaryItems:t,overflowItems:o,cacheKey:a})},n.onCommandBarGrowData=function(e){var t=e.primaryItems,o=e.overflowItems,a=e.cacheKey,i=n.commandBarHiddenOverflowItems[0];if(void 0!==i)return n.commandBarHiddenOverflowItems=n.commandBarHiddenOverflowItems.slice(1),t=Object(r.__spread)([i],t),a=n.computeCommandBarCacheKey(t),Object(r.__assign)(Object(r.__assign)({},e),{primaryItems:t,overflowItems:o,cacheKey:a})},n.onResize=function(){n.commandBar&&n.commandBar.remeasure()},n.onPopout=function(e,t){e.stopPropagation();var o=Object(We.e)(n.props.item.MailboxInfo,n.props.viewState.itemId);Object(We.c)("mail",o,function(){return Object(r.__awaiter)(n,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,ke.a.import()];case 1:return[2,e.sent()(Object(z.B)())]}})})})},n.replyByIm=function(e,t){n.replyByImInternal(!1)},n.replyAllByIm=function(e,t){n.replyByImInternal(!0)},n.onReply=function(e,t){n.onReplyReplyAllInternal(e,!1,t)},n.onReplyAll=function(e,t){n.onReplyReplyAllInternal(e,!0,t)},n.onReplyReplyAllInternal=function(e,t,o){e.stopPropagation();var a=n.props.item.ConversationId?n.props.item.ConversationId.Id:null,i=Object(ne.f)("cmp-inlineTranslation")&&n.props.item.TranslationData&&(n.props.item.TranslationData.isShowingTranslation||n.props.item.TranslationData.isShowingForwardContentTranslation);$e.u.importAndExecute({referenceItemId:Object(r.__assign)(Object(r.__assign)({},n.props.item.ItemId),{mailboxInfo:n.props.item.MailboxInfo}),isReplyAll:t,useFullCompose:!i&&!n.props.viewState.isConversationItemPart,actionSource:it,instrumentationContexts:[n.props.instrumentationContext],conversationId:a,suppressServerMarkReadOnReplyOrForward:Object(z.R)(Object(z.B)())})},n.onForward=function(e,t){e.stopPropagation(),$e.m.importAndExecute(Object(r.__assign)(Object(r.__assign)({},n.props.item.ItemId),{mailboxInfo:n.props.item.MailboxInfo}),it,[n.props.instrumentationContext],Object(z.R)(Object(z.B)()))},n.onReplyByMeeting=function(e,t){var r;e.stopPropagation();var o=Object(z.M)(n.props.item)?n.props.item:null;Object(Re.a)(n.props.item.ItemId.Id,null,!1,it,null,null===(r=o)||void 0===r?void 0:r.InternetMessageId)},n.onLikeUnLike=function(){return function(e,t){e.stopPropagation(),!n.likeUnlikeInProgress&&t&&(n.likeUnlikeInProgress=!0,n.asyncLikeItem(t))}},n.asyncLikeItem=function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,tt.q.import()];case 1:return e=t.sent(),this.likeButtonClickCount++,e(Object(r.__assign)(Object(r.__assign)({},this.props.item.ItemId),{mailboxInfo:this.props.item.MailboxInfo}),this.props.item,Object(z.B)(),this.likeButtonClickCount>=st,this.props.instrumentationContext),this.likeUnlikeInProgress=!1,[2]}})})},n.onDelete=function(e,t){e.stopPropagation();var r=n.getConversationId();if(r&&Object(ne.f)("rp-selectionUI")){var o=Object(Me.b)(r,n.props.viewState);tt.j.importAndExecute([n.props.item.ItemId.Id],Object(He.a)(n.props.item.ItemId.Id),[n.props.instrumentationContext],it,n.props.item.MailboxInfo,!0).then(function(){Object(Te.a)(o,r)})}else tt.j.importAndExecute([n.props.item.ItemId.Id],Object(He.a)(n.props.item.ItemId.Id),[n.props.instrumentationContext],it,n.props.item.MailboxInfo).then(function(){Object(he.a)()})},n.onToggleJunkNotjunk=function(){return function(e,t){e.stopPropagation(),tt.s.importAndExecute(n.props.item.ItemId.Id,Object(z.B)(),it,[n.props.instrumentationContext]).then(function(){Object(he.a)()}),je.b.importAndExecute()}},n.onPhishing=function(e,t){e.stopPropagation(),tt.r.importAndExecute(n.props.item.ItemId.Id,Object(z.B)(),it).then(function(){Object(he.a)()}),je.b.importAndExecute()},n.onReportAbuse=function(e,t){e.stopPropagation(),Ue.b.importAndExecute(n.props.item,Object(z.B)(),[n.props.instrumentationContext],it),je.b.importAndExecute()},n.onBlock=function(e,t){e.stopPropagation(),tt.f.importAndExecute(n.props.item.ItemId.Id,[n.props.instrumentationContext],it),je.b.importAndExecute()},n.onToggleReadMenuItem=function(e,t){e.stopPropagation();var r=n.props.item;Pe.c.importAndExecute(n.props.item.ItemId.Id,Object(z.B)(),!r.IsRead,[n.props.instrumentationContext],it)},n.onToggleFlagMenuItem=function(e,t){var r;e.stopPropagation(),r="Flagged"!=n.props.item.Flag.FlagStatus?"Flagged":"NotFlagged",tt.M.importAndExecute([n.props.item.ItemId.Id],[n.props.instrumentationContext],{FlagStatus:r},Object(z.C)(),it)},n.onAddToSafeSenders=function(e,t){e.stopPropagation();var r=n.props.item;tt.c.import().then(function(e){e(r.Sender.Mailbox,r.ItemId.Id,n.getActionSource(t))})},n.onCreateRule=function(e,t){e.stopPropagation();var r=n.props.item;ye.a.import().then(function(e){e(r,n.getActionSource(t))})},n.onPrint=function(e,t){e.stopPropagation(),Object(we.a)(Object(r.__assign)(Object(r.__assign)({},n.props.item.ItemId),{mailboxInfo:n.props.item.MailboxInfo}),it)},n.onTranslate=function(e,t){e.stopPropagation(),Ae.f.importAndExecute(n.props.item.ItemId.Id,Object(Ge.a)(),n.props.viewState.isConversationItemPart,!0)},n.onShowInImmersiveReader=function(e,t){e.stopPropagation(),Object(re.d)(Object(r.__assign)(Object(r.__assign)({},n.props.item.ItemId),{mailboxInfo:n.props.item.MailboxInfo}),it,n.getActionSource(t))},n.onViewMessageSource=function(e,t){e.stopPropagation(),Object(ee.m)("ViewMessageSource",{subActionSource:n.getActionSource(t)},{actionSource:it}),function(e){Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){return(t=document.createElement("div")).id="ViewMessageSourceDialog",document.body.appendChild(t),n=N.render(m.createElement(U,{onClose:function(){N.unmountComponentAtNode(t),document.body.removeChild(t)}}),t),Object(E.a)()?e.MimeContent?n.setContent(atob(e.MimeContent.Value)):D(e).then(function(t){e.MimeContent=t,n.setContent(atob(e.MimeContent.Value))}):F(e).then(function(e){n.setContent(e)}),[2]})})}(n.props.item)},n.onToggleAmp=function(e){e.stopPropagation(),Le(n.props.viewState.ampViewState)},n.onToggleUndoDarkMode=function(e,t){e.stopPropagation(),Ee(n.props.viewState)},n.renderLikeCustomButtonMenuItem=function(e){return m.createElement(S,{surfaceActionItem:e,message:n.props.item})},n.state={addinsInitializedState:0},n}return Object(r.__extends)(t,e),t.prototype.disableTranslate=function(e,t){return!e.CopyAllowed||!e.ForwardAllowed||!e.ReplyAllAllowed||!e.ReplyAllowed||!e.PrintAllowed||!t.TranslationData||!t.TranslationData.userLanguage||t.TranslationData.isShowingTranslation||t.TranslationData.isTranslating},t.prototype.shouldAddBlockSafeSenderMenuItemForFolder=function(e){return!Object(Je.a)(e.ParentFolderId.Id,"drafts")&&e.Sender&&e.Sender.Mailbox&&!Object(Ve.a)(e.Sender.Mailbox.EmailAddress)&&null!=V(e)},t.prototype.shouldAddAssignPolicyMenuItem=function(e){return!this.isGroupItem()&&(Object(et.L)(e,et.j)||Object(et.L)(e,et.c)||Object(et.L)(e,"favorites"))},t.prototype.blockMenuItemName=function(e){return Object(f.b)(Object(f.a)(oe.a),V(e))},t.prototype.createCommandBarItems=function(e,t){var n=this;this.commandBarHiddenOverflowItems=[];var o=[],a=[],i=Object(nt.i)(),s=this.props.customizedSubsetActionKeys&&this.props.customizedSubsetActionKeys.length>0?i.filter(function(e){return n.props.customizedSubsetActionKeys.indexOf(e.key)>-1}):i;s=s.filter(function(e){return"ViewMessageSource"!==e.key||!n.isSentItem});var c=Object(r.__read)(Object(xe.a)(this.props.item,this.props.viewState.isConversationItemPart),3),u=c[0],d=c[1],l=c[2];return s.forEach(function(i){var s=n.tryCreateStaticActionCommandBarItem(i,e,t,u,d,l);if(s){var c=i.key;if(n.props.hideSurfaceButton)n.addItemToCommandBarOverflow(c,a,s);else{var p=s,m=(n.props.shouldIncludeFullInfo||Object(ne.f)("rp-selectionUI"))&&(Object(nt.o)(c,n.props.item)||n.forcePinnedSurfaceActions.has(c));m&&!Object(nt.j)(c)&&n.forcePinnedSurfaceActions.add(c),m&&(p=Object(r.__assign)({},s),n.addItemToCommandBarSurface(c,o,s)),n.addItemToCommandBarOverflow(c,a,p)}}}),this.tryCreateAddinsCommandBarItems(o,a),this.props.shouldIncludeFullInfo||Object(ne.f)("rp-selectionUI")||o.push({key:"charms",onRender:function(){return m.createElement("div",{className:ot.surfaceActionsCommandBarCharms},n.renderCharms())}}),{items:this.props.hideSurfaceButton?[]:o,overflowItems:a}},t.prototype.addItemToCommandBarSurface=function(e,t,n){n.isPinned=!0,Object(nt.p)(e)?t.push(n):t.unshift(n)},t.prototype.addItemToCommandBarOverflow=function(e,t,n){n.renderedInOverflow=!0,n.onRender=null,"-"==e?this.tryAddDivider(t,n):t.push(n)},t.prototype.tryAddDivider=function(e,t){var n=e.length;n>0&&e[n-1].displayName!=nt.a&&e.push(t)},t.prototype.tryCreateStaticActionCommandBarItem=function(e,t,n,r,o,a){if(e.hideInGroup&&this.isGroupItem()||e.hideInSxS&&this.props.isItemAttachment)return null;var i,s=e.key,c=Object(nt.g)(s),u=Object(nt.h)(s).iconName,d=null,l=!1,p=null,m=e.key,b=this.props.item;switch(s){case"LikeUnlike":if(!Object(E.a)()&&!Object(et.L)(b.ParentFolderId.Id,et.l)){var I=Object(h.a)().SessionSettings.UserEmailAddress,v=!!b.Likers&&b.Likers.some(function(e){return e.EmailAddress===I});i=this.onLikeUnLike(),v&&(u="LikeSolid",c=Object(f.a)(Ze.e)),Object(nt.o)(s,this.props.item)&&(p=this.renderLikeCustomButtonMenuItem)}break;case"ToggleAmp":var g=this.props.viewState.ampViewState,O=g.preferAmp,j=g.ampAvailability;Object(ge.a)()&&j==ve.a.AmpValidated&&(c=O?Object(f.a)(be.a):Object(f.a)(me.a),m=O?"ViewAsOriginal":"ViewAsDynamic",i=this.onToggleAmp);break;case"Reply":i=this.onReply,l=r;break;case"ReplyAll":i=this.onReplyAll,l=o;break;case"Forward":i=this.onForward,l=a;break;case"ReplyByMeeting":i=this.onReplyByMeeting,l=n;break;case"Popout":this.props.isItemAttachment||this.props.isDeeplink||(i=this.onPopout);break;case"Delete":!this.props.isItemAttachment&&Object(Oe.b)(8)&&(i=this.onDelete,l=!!this.isGroupItem()&&!b.CanDelete);break;case"MarkReadUnread":this.isGroupPopout()||(c=b.IsRead?Object(f.a)(de.a):Object(f.a)(ue.a),m=b.IsRead?"MarkItemUnread":"MarkItemRead",i=this.onToggleReadMenuItem);break;case"FlagUnflag":if(Object(Oe.b)(10)){var k=!b.Flag||"Flagged"!=b.Flag.FlagStatus;c=k?Object(f.a)(ae.a):Object(f.a)(Ze.d),m=k?"FlagItem":"UnflagItem",i=this.onToggleFlagMenuItem}break;case"AssignPolicy":if(this.shouldAddAssignPolicyMenuItem(b.ParentFolderId.Id)){i=this.onAssignPolicy;var y=Object(z.B)();d=Object(ze.c)(y?y.id:null,"RPCSAOverflow",this.props.item)}break;case"AddToSafeSenders":this.shouldAddBlockSafeSenderMenuItemForFolder(b)&&(i=this.onAddToSafeSenders);break;case"MarkJunkNotJunk":Object(Oe.g)()&&Object(et.N)(b.ParentFolderId.Id)&&(c=this.isInJunkFolder?Object(f.a)(Ze.b):Object(f.a)(se.a),m=this.isInJunkFolder?"MarkItemNotjunk":"MarkItemJunk",i=this.onToggleJunkNotjunk());break;case"MarkAsPhishing":i=this.onPhishing;break;case"Block":this.shouldAddBlockSafeSenderMenuItemForFolder(b)&&Object(et.N)(b.ParentFolderId.Id)&&(c=this.blockMenuItemName(b),i=this.onBlock);break;case"ReportAbuse":Object(ne.f)("tri-reportAbuse")&&(c=Object(f.a)(pe.a),i=this.onReportAbuse);break;case"CreateRule":Object(Se.a)()&&this.itemHasSenderSMTP()&&Object(et.N)(b.ParentFolderId.Id)&&(i=this.onCreateRule);break;case"Print":i=this.onPrint,l=!t.PrintAllowed;break;case"Translate":i=this.onTranslate,l=this.disableTranslate(t,this.props.item);break;case"ShowInImmersiveReader":i=this.onShowInImmersiveReader;break;case"ViewMessageSource":i=this.onViewMessageSource;break;case"ToggleDarkMode":var S=this.props.viewState.undoDarkMode;c=S?Object(f.a)(Ze.a):Object(f.a)(ie.a),u=S?"ClearNight":"Sunny",m=S?"ToggleDarkModeOn":"ToggleDarkModeOff",i=this.onToggleUndoDarkMode;break;case"ReplyByIM":i=this.replyByIm,l=!Object(Xe.b)();break;case"ReplyAllByIM":i=this.replyAllByIm,l=!Object(Xe.b)();break;case"AddToProjectSpace":var A=fe.a.tryImportForRender();A&&(i=this.onAddToProjectSpace,d=A(this.props.item.ItemId.Id,this.props.item));break;case"-":return{key:(this.commandBarDividerKey++).toString(),displayName:nt.a,itemType:X.a.Divider,onClick:null}}return i?{key:s,name:c,iconProps:{iconName:u,className:ot.commandBarIcon},onRender:p,disabled:l,onClick:this.getHandler(i,!0,m),onKeyDown:this.getHandler(i,!1,m),iconOnly:!0,ariaLabel:c,subMenuProps:d}:null},t.prototype.tryCreateAddinsCommandBarItems=function(e,t){var n,o=this;if(this.shouldAddinsPopulate()&&2==this.state.addinsInitializedState){var a,i=[],s=[],c=Object(rt.c)(rt.a.SurfaceActions);if(this.props.viewState.isConversationItemPart&&Object(ne.f)("rp-selectionUI"))a=null===(n=Object(Ne.b)())||void 0===n?void 0:n.itemId;Object(Z.a)($.a.MessageRead,this.props.item,a||this.props.item.ItemId.Id,c.readSurfaceAddins,i,s,!0,this.commandBarDividerKey,null,!0),i.forEach(function(e){if(e.onClick){var t=e.onClick;e.onClick=o.getHandler(t,!0,"Addins"),e.onKeyDown=o.getHandler(t,!1,"Addins")}}),s.forEach(function(e){if(e.onClick){var t=e.onClick;e.onClick=o.getHandler(t,!0,"Addins"),e.onKeyDown=o.getHandler(t,!1,"Addins")}}),e.unshift.apply(e,Object(r.__spread)(i)),t.push.apply(t,Object(r.__spread)(s))}},t.prototype.componentDidMount=function(){qe.a.importAndExecute(this.onResize),this.initailizeAddinsIfNeeded()},t.prototype.componentWillUnmount=function(){qe.c.importAndExecute(this.onResize),this.deInitializeAddins()},t.prototype.componentDidUpdate=function(){this.initailizeAddinsIfNeeded()},t.prototype.render=function(){var e=!this.props.item.ParentFolderId||!Object(Je.a)(this.props.item.ParentFolderId.Id,"notes");return m.createElement("div",{className:ot.surfaceActionsCommandBarContainer},e&&this.renderCommandBar())},t.prototype.renderCommandBar=function(){var e=this;if(!this.props.viewState)return null;var t=Object(Ke.a)(this.props.item),n=Object(Qe.a)(this.props.item),r=this.createCommandBarItems(t,n);return m.createElement(m.Fragment,null,m.createElement(J.a,{componentRef:function(t){return e.commandBar=t},items:r.items,overflowItems:r.overflowItems,overflowButtonProps:{iconProps:{iconName:"More"},menuIconProps:{iconName:"More",styles:{root:Object(f.g)(this.props.seeMoreStyles)?ot.surfaceActionsCommandBarOverflowIcon:at(ot.surfaceActionsCommandBarOverflowIcon,this.props.seeMoreStyles)}},ariaLabel:Object(f.a)(ce.a)},buttonAs:this.ItemHeaderToolbarButton,overflowButtonAs:this.ItemHeaderToolbarOverflowButton,shiftOnReduce:!0,onDataReduced:nt.n,onDataGrown:nt.m,styles:{root:ot.surfaceActionsCommandBar,primarySet:ot.surfaceActionsCommandBarPrimarySet},ariaLabel:Object(f.a)(Ze.c),onReduceData:this.onCommandBarReduceData,onGrowData:this.onCommandBarGrowData}))},t.prototype.renderCharms=function(){var e=this.props,t=e.item,n=e.viewState,r=e.instrumentationContext;return m.createElement(_e.b,{message:t,viewState:n,instrumentationContext:r,charmSize:_e.a.size16,hideAttachmentIcon:!0,hideCharmlessIcon:!0})},t.prototype.computeCommandBarCacheKey=function(e){return[e.reduce(function(e,t){var n=t.cacheKey;return e+(void 0===n?t.key:n)},""),"","overflow"].join(" ")},t.prototype.getConversationId=function(){var e=this.props.viewState.isConversationItemPart&&this.props.item.ConversationId?this.props.item.ConversationId.Id:null;return Object(Ce.a)()?null:e},t.prototype.isGroupPopout=function(){return this.props.isDeeplink&&this.isGroupItem()},t.prototype.isGroupItem=function(){return!!this.props.item.MailboxInfo&&this.props.item.MailboxInfo.type===te.a.GroupMailbox},Object.defineProperty(t.prototype,"isInJunkFolder",{get:function(){var e=this.props.item;return Object(Je.a)(e.ParentFolderId.Id,"junkemail")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSentItem",{get:function(){var e=this.props.item;return Object(Je.a)(e.ParentFolderId.Id,"sentitems")},enumerable:!0,configurable:!0}),t.prototype.replyByImInternal=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,o,a,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:return t=this.props.item,[4,$e.n.import()];case 1:return[4,s.sent()(t,e)];case 2:return n=r.__read.apply(void 0,[s.sent(),2]),o=n[0],a=n[1],(i=Object(r.__spread)(o,a).map(function(e){return e.SipUri?e.SipUri:"sip:"+e.EmailAddress})).length>0&&Xe.e.import().then(function(n){return n(i,t.Subject,e?3:2)}),[2]}})})},t.prototype.onAssignPolicy=function(e,t){e.stopPropagation()},t.prototype.itemHasSenderSMTP=function(){var e,t;return!!(null===(t=null===(e=Object(z.M)(this.props.item)?this.props.item:null)||void 0===e?void 0:e.From)||void 0===t?void 0:t.Mailbox)},t.prototype.onAddToProjectSpace=function(e,t){e.stopPropagation()},t.prototype.shouldAddinsPopulate=function(){var e=(!this.props.customizedSubsetActionKeys||0==this.props.customizedSubsetActionKeys.length)&&this.props.shouldIncludeFullInfo;return!(!Object(ne.f)("rp-addins")||!e||Object($e.c)(this.getConversationId())||this.props.isItemAttachment||!Object(Q.S)(this.props.item)||this.isGroupItem()||Object(Ye.a)(this.props.item))},t.prototype.initailizeAddinsIfNeeded=function(){var e=this;0==this.state.addinsInitializedState&&this.shouldAddinsPopulate()&&(this.setState({addinsInitializedState:1}),setTimeout(function(){e.initializeAddins()},1))},t.prototype.initializeAddins=function(){var e=this;if(this.isGroupItem())return Object(Ie.h)(Q.h.NotSupported),void this.setState({addinsInitializedState:3});Object(ne.f)("rp-addins")&&Ie.b.import().then(function(t){var n=t(e.props.item,e.props.viewState);Q.w.import().then(function(t){t(Object(Q.q)(e.props.item.ItemId.Id),n),e.setState({addinsInitializedState:2})})})},t.prototype.deInitializeAddins=function(){var e=this;this.isGroupItem()||Object(ne.f)("rp-addins")&&Q.v.import().then(function(t){t(Object(Q.q)(e.props.item.ItemId.Id))})},t.prototype.getActionSource=function(e){var t,n="RPCSAPinned";return(null===(t=e)||void 0===t?void 0:t.renderedInOverflow)&&(n=e.isPinned?"RPCSAOverflow":"RPCSANotPinned"),this.props.actionSource&&(n=this.props.actionSource),n},Object(r.__decorate)([W.computed],t.prototype,"isInJunkFolder",null),Object(r.__decorate)([W.computed],t.prototype,"isSentItem",null),t=Object(r.__decorate)([o.observer],t)}(m.Component);n.d(t,"ItemActions",function(){return ct})},2101:function(e){e.exports={a:"cEb"}},2227:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(40),o=n(245),a=n(65);function i(){return Object(o.a)()?Object(a.f)("cmp-encryption")&&Object(r.a)().SessionSettings.IsPremiumConsumerMailbox:Object(r.a)().SegmentationSettings.Irm}},2274:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"c",function(){return I}),n.d(t,"b",function(){return v});var r=n(2),o=n(248),a=n(99),i="resources/images/surfaceActions",s=i+"/attach.svg",c=i+"/attachDark.svg",u=i+"/inlineimage.svg",d=i+"/inlineimageDark.svg",l=i+"/emoji.svg",p=i+"/showribbon.svg",m=i+"/showribbonDark.svg",b=i+"/dictate.svg",f=i+"/dictationLanguage.svg";function h(e){var t,n,i=!1;switch(e){case"AddAttachment":t=Object(o.resolve)(Object(r.q)(),Object(a.c)()?c:s),n=Object(o.resolve)(Object(r.q)(),s),i=!0;break;case"AddInlineImage":t=Object(o.resolve)(Object(r.q)(),Object(a.c)()?d:u),n=Object(o.resolve)(Object(r.q)(),u),i=!0;break;case"AddEmoji":t=Object(o.resolve)(Object(r.q)(),l),i=!0;break;case"ToggleDarkCompose":t="Sunny";break;case"ToggleDictation":t=Object(o.resolve)(Object(r.q)(),b),i=!0;break;case"SetDictationLanguage":t=Object(o.resolve)(Object(r.q)(),f),i=!0;break;case"ToggleRibbon":t=Object(o.resolve)(Object(r.q)(),Object(a.c)()?m:p),n=Object(o.resolve)(Object(r.q)(),p),i=!0;break;case"SensitivityMenu":t="MarkAsProtected";break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":t="MailOptions";break;case"SwitchBodyType":case"AccChecker":t="OutlookLogo";break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:i}}function I(e){var t;switch(e){case"-":t="-";break;case"Reply":t="Reply";break;case"ReplyAll":t="ReplyAll";break;case"Forward":t="Forward";break;case"ReplyByMeeting":t="Calendar";break;case"ReportAbuse":t="ReportHacked";break;case"Delete":t="Delete";break;case"MarkReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"AssignPolicy":t="Assign";break;case"AddToSafeSenders":t="AddFriend";break;case"MarkJunkNotJunk":t="MailAlert";break;case"MarkAsPhishing":t="Phishing";break;case"Block":t="BlockContact";break;case"CreateRule":t="CreateMailRule";break;case"Print":t="Print";break;case"Translate":t="LocaleLanguage";break;case"ShowInImmersiveReader":t="ReadOutLoud";break;case"ViewMessageSource":t="OpenSource";break;case"Popout":t="OpenInNewWindow";break;case"LikeUnlike":t="Like";break;case"ToggleDarkMode":t="Sunny";break;case"ReplyByIM":case"ReplyAllByIM":t="ChatInviteFriend";break;case"ToggleAmp":t="LightningBolt";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function v(e){var t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}},2390:function(e){e.exports={a:"ioa"}},2391:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return i});var r="ArchivePolicyParentRow",o="DeletePolicyParentRow",a="FolderArchiveTag",i="FolderPolicyTag"},2632:function(e){e.exports={a:"Cna"}},2751:function(e){e.exports={a:"voa"}},2752:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),o=n(874),a=n(3817),i=n.n(a);function s(e,t,n){if(void 0===t&&(t=Object(o.getJsonRequestHeader)()),!e||!e.ConversationActions||0===e.ConversationActions.length)throw new Error("ApplyConversationAction requestBody is invalid!");n=n||{};var a=Object(r.__assign)({},n),s=a.headers?new Headers(a.headers):new Headers;return s.set("X-OWA-ActionSource","ApplyConversationAction_"+e.ConversationActions[0].Action),a.headers=s,i()({Header:t,Body:e},a).then(function(e){return e.Body.ResponseMessages.Items[0]}).catch(function(e){return Promise.reject(e)})}},2801:function(e,t,n){"use strict";var r=n(52),o=n(3339);function a(e){return o.a.addinOptionSurfaceItems[e]}var i=n(2093),s=n(2751),c=n(3098),u=n(2969),d=n(2447),l=n(3340),p=n(3099),m=n(3100),b=n(2984),f=n(2970),h=n(3341),I=n(3342),v=n(2838),g=n(3343),O=n(2390),j=n(2842),k=n(3114),y=n(2616),S=n(2617),A=n(2618),C=n(3213),P=n(3214),_=n(3215),x=n(3344),M=n(3345),w=n(3216),R=n(3346),T=n(3347),B=n(3348),L=n(3217),F=n(3474),D=n(3349),E=n(2632),N=n(3218),G=n(5),H=n(245);function U(e){switch(e){case"AddAttachment":return Object(G.a)(D.a);case"AddInlineImage":return Object(G.a)(N.a);case"AddEmoji":return Object(G.a)(F.a);case"ToggleRibbon":return Object(G.a)(B.a);case"SaveDraft":return Object(G.a)(T.a);case"InsertSignature":return Object(G.a)(R.a);case"ShowFrom":return Object(G.a)(w.a);case"SetImportance":return Object(G.a)(M.a);case"ShowMessageOptions":return Object(G.a)(x.a);case"SwitchBodyType":return Object(G.a)(_.a);case"SensitivityMenu":return Object(G.a)(P.a);case"ProtectMessage":return Object(G.a)(C.a);case"AccChecker":return Object(G.a)(E.a);case"ToggleDarkCompose":return Object(G.a)(F.o);case"ToggleDictation":return Object(G.a)(F.p);case"SetDictationLanguage":return Object(G.a)(F.m);default:return""}}function z(e){switch(e){case"LikeUnlike":return Object(G.a)(F.d);case"Reply":return Object(G.a)(A.a);case"ReplyAll":return Object(G.a)(S.a);case"Forward":return Object(G.a)(y.a);case"ReplyByMeeting":return Object(G.a)(F.f);case"ReportAbuse":return Object(G.a)(k.a);case"Popout":return Object(G.a)(j.a);case"Delete":return Object(G.a)(F.c);case"MarkReadUnread":return Object(G.a)(O.a);case"FlagUnflag":return Object(G.a)(g.a);case"AssignPolicy":return Object(G.a)(v.a);case"AddToSafeSenders":return Object(G.a)(F.b);case"MarkJunkNotJunk":return Object(G.a)(I.a);case"MarkAsPhishing":return Object(G.a)(F.e);case"Block":return Object(G.b)(Object(G.a)(h.a),"");case"CreateRule":return Object(G.a)(f.a);case"Print":return Object(G.a)(b.a);case"Translate":return Object(G.a)(m.a);case"ShowInImmersiveReader":return Object(G.a)(p.a);case"ViewMessageSource":return Object(H.a)()?Object(G.a)(F.h):Object(G.a)(F.g);case"ToggleDarkMode":return Object(G.a)(l.a);case"ReplyByIM":return Object(G.a)(F.l);case"ReplyAllByIM":return Object(G.a)(F.k);case"ToggleAmp":return Object(G.a)(F.n);case"AddToProjectSpace":return Object(G.a)(L.a);default:return""}}function V(e){switch(e){case"None":return Object(G.a)(F.i);case"Delete":return Object(G.a)(d.a);case"Archive":return Object(G.a)(u.a);case"PinUnpin":return Object(G.a)(c.a);case"ReadUnread":return Object(G.a)(F.j);case"FlagUnflag":return Object(G.a)(s.a);case"Move":return Object(G.a)(i.a);default:return""}}var K=n(2274),W=n(3350),q=n(2227),J=n(65),X=n(764),Y=n(40),Q=n(99),Z=n(25);function $(){var e=[{key:"Reply",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!1},{key:"Forward",hideInGroup:!1,hideInSxS:!1}];return e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(J.f)("fwk-skypeBusinessV2")&&e.push({key:"ReplyByIM",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAllByIM",hideInGroup:!0,hideInSxS:!1},{key:"-",hideInGroup:!0,hideInSxS:!1}),Object(J.f)("outlookSpaces-enabled")&&e.push({key:"AddToProjectSpace",hideInGroup:!1,hideInSxS:!1},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(Y.a)().SessionSettings.IsShadowMailbox||(e.push({key:"AddToSafeSenders",hideInGroup:!0,hideInSxS:!0},{key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0},{key:"Block",hideInGroup:!0,hideInSxS:!0}),Object(J.f)("tri-reportAbuse")&&e.push({key:"ReportAbuse",hideInGroup:!Object(H.a)(),hideInSxS:!0}),e.push({key:"-",hideInGroup:!1,hideInSxS:!1})),Object(H.a)()||e.push({key:"AssignPolicy",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(Y.a)().SessionSettings.IsShadowMailbox||e.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0}),e.push({key:"Print",hideInGroup:!1,hideInSxS:!1}),Object(J.f)("rp-inlineTranslation")&&Object(J.f)("rp-inlineTranslationManual")&&e.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),Object(Q.c)()&&e.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),Object(J.f)("rp-immersiveReader")&&e.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),e.push({key:"ViewMessageSource",hideInGroup:!1,hideInSxS:!0}),e.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),Object(H.a)()||e.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),Object(J.f)("rp-amp")&&Object(H.a)()&&e.push({key:"ToggleAmp",hideInGroup:!1,hideInSxS:!0}),e}function ee(){var e=[{key:"AddAttachment",hideInGroup:!1},{key:"AddInlineImage",hideInGroup:!1}];return e.push({key:"AddEmoji",hideInGroup:!1}),(Object(Z.d)()||Object(Z.e)()||Object(Z.b)())&&Object(J.f)("cmp-dictation")&&e.push({key:"ToggleDictation",hideInGroup:!1}),e=e.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1},{key:"SwitchBodyType",hideInGroup:!1},{key:"AccChecker",hideInGroup:!1}]),Object(J.f)("cmp-clp")&&!Object(H.a)()&&e.push({key:"SensitivityMenu",hideInGroup:!1}),Object(q.a)()&&e.push({key:"ProtectMessage",hideInGroup:!1}),Object(W.a)()&&e.push({key:"ShowMessageOptions",hideInGroup:!1}),e}function te(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e}function ne(e){return-1!==Object(X.c)(X.a.SurfaceActions).readSurfaceActions.indexOf(e)}function re(e,t){return ne(e)||!(!Object(J.f)("rp-csaPinnedLikes")||"LikeUnlike"!==e||!t.LikeCount)}var oe=n(151);function ae(e,t,n,r){var o,a;r?a=r:(a="Pinned",(null===(o=n)||void 0===o?void 0:o.renderedInOverflow)&&(a=n.isPinned?"Overflow":"NotPinned")),Object(oe.m)(e?"CSACountComposeUserAction":"CSACountReadUserAction",[t,a])}function ie(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!0})}function se(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!1})}n.d(t,"k",function(){return ue}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return U}),n.d(t,"g",function(){return z}),n.d(t,"f",function(){return V}),n.d(t,"a",function(){return"-"}),n.d(t,"d",function(){return K.a}),n.d(t,"h",function(){return K.c}),n.d(t,"e",function(){return ee}),n.d(t,"i",function(){return $}),n.d(t,"p",function(){return te}),n.d(t,"o",function(){return re}),n.d(t,"j",function(){return ne}),n.d(t,"l",function(){return ae}),n.d(t,"n",function(){return ie}),n.d(t,"m",function(){return se});var ce=new r.c(function(){return n.e(467).then(n.bind(null,14381))}),ue=new r.a(ce,function(e){return e.setAddinOptionSurfaceItems})},2838:function(e){e.exports={a:"koa"}},2842:function(e){e.exports={a:"hoa"}},2969:function(e){e.exports={a:"toa"}},2970:function(e){e.exports={a:"noa"}},3098:function(e){e.exports={a:"uoa"}},3099:function(e){e.exports={a:"qoa"}},3100:function(e){e.exports={a:"poa"}},3114:function(e){e.exports={a:"goa"}},3195:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c});var r=n(4),o=Object(r.action)("ON_ARCHIVE_TAG_FOR_FOLDER_UPDATE_SUCCESS",function(e,t){return{folder:e,archiveTag:t}}),a=Object(r.action)("ON_DELETE_TAG_FOR_FOLDER_UPDATE_SUCCESS",function(e,t){return{folder:e,deleteTag:t}}),i=Object(r.action)("ON_RETENTION_TAG_FOR_ITEMS_UPDATE_SUCCESS",function(e,t,n){return{tag:e,isArchiveTag:t,itemIds:n}}),s=Object(r.action)("ON_RETENTION_TAG_FOR_ITEMS_CHANGED",function(e,t,n,r,o){return{isArchiveTag:e,tagValue:t,itemIds:n,actionSource:r,mailboxInfo:o}}),c=Object(r.action)("ON_RETENTION_TAG_FOR_CONVERSATIONS_CHANGED",function(e,t,n,r,o,a,i){return{isArchiveTag:e,tagValue:t,folderId:n,conversationActionContexts:r,itemIds:o,actionSource:a,mailboxInfo:i}})},3196:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("SHOW_IN_IMMERSIVE_READER",function(e,t,n){return{itemId:e,actionSource:t,subActionSource:n}})},3213:function(e){e.exports={a:"boa",b:"coa"}},3214:function(e){e.exports={a:"aoa"}},3215:function(e){e.exports={a:"$na"}},3216:function(e){e.exports={a:"Yna"}},3217:function(e){e.exports={a:"Una"}},3218:function(e){e.exports={a:"Bna"}},3329:function(e){e.exports={a:"GAb"}},3339:function(e,t,n){"use strict";var r=n(4),o=Object(r.createStore)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})();t.a=o},3340:function(e){e.exports={a:"roa"}},3341:function(e){e.exports={a:"moa"}},3342:function(e){e.exports={a:"loa"}},3343:function(e){e.exports={a:"joa"}},3344:function(e){e.exports={a:"_na"}},3345:function(e){e.exports={a:"Zna"}},3346:function(e){e.exports={a:"Xna"}},3347:function(e){e.exports={a:"Wna"}},3348:function(e){e.exports={a:"Vna"}},3349:function(e){e.exports={a:"Dna"}},3350:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(71);function o(){return!Object(r.s)()}},3474:function(e){e.exports={a:"Ena",d:"Fna",f:"Gna",c:"Hna",b:"Ina",e:"Jna",h:"Kna",g:"Lna",i:"Mna",j:"Nna",l:"Ona",k:"Pna",m:"Qna",n:"Rna",o:"Sna",p:"Tna"}},4049:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s});var r=n(52),o=new r.c(function(){return Promise.all([n.e(5),n.e(6),n.e(88),n.e(597),n.e(301)]).then(n.bind(null,6460))}),a=new r.a(o,function(e){return e.openCreateEditRuleSettingsPage}),i=new r.b(o,function(e){return e.createRuleFromItem}),s=new r.b(o,function(e){return e.createRuleFromRow})},4311:function(e,t,n){var r=n(6644),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},4312:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(151);function o(e){var t=e.isArchiveTag,n=e.actionSource,o=e.responseClass;Object(r.m)("TnS_RetentionPolicySelected",[t,n,o])}},5072:function(e,t,n){"use strict";var r=n(52),o=n(2391),a=n(0),i=n(2838),s=n(5),c=n(732);var u=n(6643),d=n(128),l=n(4311);function p(e){var t=e.retentionId,n=e.displayName,r=e.isChecked,o=e.subMenuProps;return{key:t,text:n,data:t,onClick:e.onClickCallback,checked:r,itemProps:r?{styles:{label:l.checkedItem}}:null,iconProps:r?{iconName:"CheckMark",className:l.checkmark}:null,subMenuProps:o}}var m=n(6645);function b(e){var t=e.retentionId,n=e.retentionPolicyTags,r=e.folderType,o=e.isArchive,a=e.isChecked,i=e.onClickCallback,c=function(e,t){return 12==e?t?Object(s.a)(m.a):Object(s.a)(m.b):Object(s.a)(m.c)}(r,o);return p({retentionId:t,displayName:17!=r?function(e){var t=e.retentionPolicyTags,n=e.folderType,r=e.isArchive,o=e.defaultName;return t.reduce(function(e,t){return t.Type===n&&t.IsArchive==r?t.DisplayName:e},o)}({retentionPolicyTags:n,folderType:r,isArchive:o,defaultName:c}):c,isChecked:a,subMenuProps:null,onClickCallback:i})}var f=n(4311);function h(e,t,n,r,a){var i=!1;return(12==r?[]:e.map(function(e){var r=e.RetentionId===n;return r&&(i=!0),p({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&r,subMenuProps:null,onClickCallback:a})})).concat(b({retentionId:o.a,retentionPolicyTags:e,folderType:r,isArchive:!0,isChecked:t&&!i,onClickCallback:a}))}var I=n(6646);var v=n(4311);function g(e,t,n,r,a,i){var s=!1;return(17!=r||"archive"===a?[]:function(e){var t={},n=e.filter(function(e){return null==e.ParentLabelIdentity||e.ParentLabelIdentity.length<=0}).reduce(function(e,n){var r={parentPolicyTag:n,childrenPolicyTags:[]};return e.push(r),t[n.RetentionId]=r,e},[]);return e.filter(function(e){return null!=e.ParentLabelIdentity&&e.ParentLabelIdentity.length>0&&e.ParentLabelIdentity in t}).forEach(function(e){t[e.ParentLabelIdentity].childrenPolicyTags.push(e)}),n}(e).map(function(e){var r=function(e,t,n,r){var o=e.parentPolicyTag,a=e.childrenPolicyTags,i=o.RetentionId===n;if(null==a||0==a.length)return{item:p({retentionId:o.RetentionId,displayName:o.DisplayName,isChecked:t&&i,subMenuProps:null,onClickCallback:r}),policyFound:i};var s=!1,c=a.map(function(e){var o=e.RetentionId===n;return o&&(s=!0),p({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&o,subMenuProps:null,onClickCallback:r})});return{item:p({retentionId:o.RetentionId,displayName:o.DisplayName,isChecked:t&&i,subMenuProps:{items:c},onClickCallback:null}),policyFound:s}}(e,t,n,i);return r.policyFound&&(s=!0),r.item})).concat(b({retentionId:o.c,retentionPolicyTags:e,folderType:r,isArchive:!1,isChecked:t&&!s,onClickCallback:i}))}function O(e){var t=e.retentionPolicyTagList,n=e.showTagSelection,r=e.selectedArchiveTag,o=e.selectedDeleteTag,i=e.treeType,l=e.distinguishedFolderId,p=e.hasArchive,m=e.onArchivePolicyClickedCallback,b=e.onDeletePolicyClickedCallback,O=[],k=p&&i!=c.c,y=function(e){switch(e){case"msgfolderroot":case"archivemsgfolderroot":return 12;case"deleteditems":case"archivedeleteditems":return 3;case"recoverableitemsdeletions":case"archiverecoverableitemsdeletions":return 18;case"calendar":return 1;case"contacts":return 2;case"conversationhistory":return 16;case"drafts":return 4;case"inbox":return 5;case"junkemail":return 6;case"journal":return 7;case"notes":return 8;case"outbox":return 9;case"sentitems":return 10;case"syncissues":return 15;case"tasks":return 11;case"none":default:return 17}}(l),S=t.filter(function(e){return e.IsVisible&&e.IsArchive}).sort(j),A=t.filter(function(e){return e.IsVisible&&!e.IsArchive}).sort(j);return k&&O.push.apply(O,Object(a.__spread)(function(e,t,n,r,o){var a,i=(null===(a=n)||void 0===a?void 0:a.IsExplicit)?n.Value:null;return[{key:"archiveSection",className:f.sectionHeader,itemType:d.a.Section,sectionProps:{bottomDivider:!0,title:Object(s.a)(u.a),items:h(e,t,i,r,o)}}]}(S,n,r,y,m))),O.push.apply(O,Object(a.__spread)(function(e,t,n,r,o,a){var i,c=(null===(i=n)||void 0===i?void 0:i.IsExplicit)?n.Value:null;return[{key:"deleteSection",className:v.sectionHeader,itemType:d.a.Section,sectionProps:{title:Object(s.a)(I.a),items:g(e,t,c,r,o,a)}}]}(A,n,o,y,l,b))),{items:O}}function j(e,t){return e.RetentionPeriod&&t.RetentionPeriod?e.RetentionPeriod-t.RetentionPeriod:t.RetentionPeriod?1:-1}var k=n(40),y=n(245);function S(e){if(Object(y.a)())return null;var t=Object(k.a)(),n=e.treeType,r=t.RetentionPolicyTags;return r&&0!==r.length&&n!==c.l?{key:"AssignPolicy",name:Object(s.a)(i.a),disabled:!1,subMenuProps:O(Object(a.__assign)(Object(a.__assign)({},e),{showTagSelection:!0,retentionPolicyTagList:r,hasArchive:!!t.SessionSettings.HasArchive}))}:null}var A=n(857),C=n(731),P=n(1022);var _=n(3195),x=n(869);function M(e,t,n){var r=C.O.tableViews.get(e);if(!r)return null;var o=function(e){if(e&&Object(A.e)(e.tableQuery)){var t=A.i.tryImportForRender();return t?t(e.tableQuery):[]}return Object(k.a)().RetentionPolicyTags}(r);if(!o||!o.length)return null;var i=function(e){var t,n;if(e&&Object(A.e)(e.tableQuery))t=null,n="groups";else{var r=Object(P.g)(e),o=r&&Object(c.B)().get(r);if(!o)return null;t=o.DistinguishedFolderId||o.FolderId.Id,n=o.treeType}return{folderId:t,treeType:n}}(r);if(!i)return null;var s,u,d,l=Object(a.__spread)(r.selectedRowKeys.keys());return n?(s=n.ArchiveTag,u=n.PolicyTag,d=!0):(s=1==l.length?C.b.getArchiveTag(l[0],r):null,u=1==l.length?C.b.getPolicyTag(l[0],r):null,d=1==l.length),O({retentionPolicyTagList:o,showTagSelection:d,selectedArchiveTag:s,selectedDeleteTag:u,treeType:i.treeType,distinguishedFolderId:"none",hasArchive:w(r),onArchivePolicyClickedCallback:R({isArchivePolicyClicked:!0,tableView:r,selectedTag:s,folderId:i.folderId,clientItem:n,actionSource:t}),onDeletePolicyClickedCallback:R({isArchivePolicyClicked:!1,tableView:r,selectedTag:u,folderId:i.folderId,clientItem:n,actionSource:t})})}function w(e){return(!e||!Object(A.e)(e.tableQuery))&&!!Object(k.a)().SessionSettings.HasArchive}function R(e){var t=e.isArchivePolicyClicked,n=e.tableView,r=e.selectedTag,i=e.folderId,s=e.clientItem,c=e.actionSource;return function(e,u){var d,l,p,m;if(d={retentionTag:r,retentionId:u.data,inheritSubMenuIdentifier:t?o.a:o.c},l=d.retentionTag,p=d.retentionId,m=d.inheritSubMenuIdentifier,!!l&&p!=l.Value||!l&&p!=m){var b="RPCSAOverflow"==c||1===n.tableQuery.listViewType,f=Object(a.__spread)(n.selectedRowKeys.keys()),h=Object(x.b)(n);if(b){var I="RPCSAOverflow"==c?[s.ItemId.Id]:f.map(function(e){return Object(C.G)(e,n.id).clientId.Id});Object(_.d)(t,u.data,I,c,h)}else{var v=f.map(function(e){return Object(C.h)(e,n.id)});I=f.reduce(function(e,t){var r=Object(C.F)(t,n.id);return r&&e.push.apply(e,Object(a.__spread)(r.itemIds)),e},[]);Object(_.c)(t,u.data,i,v,I,c,h)}}}}function T(e){var t=e.folder,n=e.retentionId,r=e.inheritSubMenuIdentifier,a=r===o.a?t.ArchiveTag:t.PolicyTag;return!!a&&n!=a.Value||!a&&n!=r}var B=n(1321),L=n.n(B),F=n(745),D=n.n(F),E=n(1909),N=n.n(E),G=n(1950),H=n.n(G),U=n(191),z=n(1586),V=n.n(z),K=n(743),W=n.n(K),q=n(1378),J=n.n(q),X=n(1814),Y=n.n(X),Q=n(1353);function Z(e,t,n,r){var o=function(e,t,n){var r,o=t?"ItemArchiveTag":"ItemPolicyTag",i=t?"ArchiveTag":"PolicyTag",s=[n?J()({Path:W()({FieldURI:o}),Item:V()((r={},r[i]=n,r))}):Y()({Path:W()({FieldURI:o})})],c=[];return e.forEach(function(e){return c.push(L()({Updates:s,ItemId:D()({Id:e})}))}),H()(Object(a.__assign)({ItemChanges:c,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:!1,ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone"},Object(Q.a)()))}(e,t,n);return N()({Header:Object(U.getJsonRequestHeader)(),Body:o},r).then(function(e){return e.Body.ResponseMessages.Items[0]})}var $=n(4),ee=n(62),te=n(4312),ne=(Object($.orchestrator)(_.d,function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var t,n,r,i,s,c,u,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,r=e.itemIds,i=e.actionSource,s=e.mailboxInfo,c=n===o.a||n===o.c?null:{Value:n,IsExplicit:!0},[4,Z(r,t,c,s.requestOptions)];case 1:return"Success"==(u=a.sent()).ResponseClass&&Object(_.e)(c,t,r),Object(te.a)({isArchiveTag:t,actionSource:i,responseClass:u.ResponseClass}),[3,3];case 2:return d=a.sent(),ee.d.error("Error while updating item retention tag "+d),[3,3];case 3:return[2]}})})}),n(2752)),re=n(2753),oe=n.n(re),ae=n(2754),ie=n.n(ae),se=n(778),ce=n.n(se),ue=n(324),de=n.n(ue),le=n(747),pe=n.n(le),me=n(737);function be(e,t,n,r,o){var a=function(e,t,n,r){var o=e.map(function(e){return function(e,t,n,r){var o=ie()({Action:"SetRetentionPolicy",ConversationId:D()({Id:e.conversationId}),RetentionPolicyType:n});t&&(o.RetentionPolicyTagId=t);if(r){var a=ce()({BaseFolderId:(i=r,Object(me.a)(i)?de()({Id:i}):pe()({Id:i}))});o.ContextFolderId=a}var i;return o}(e,t,n,r)});return oe()({ConversationActions:o,ReturnMovedItemIds:!1})}(e,t,n,r);return Object(ne.a)(a)}Object($.orchestrator)(_.c,function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var t,n,r,i,s,c,u,d,l,p,m,b;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,r=e.folderId,i=e.conversationActionContexts,s=e.itemIds,c=e.actionSource,u=e.mailboxInfo,d=t?1:0,l=n===o.a||n===o.c,[4,be(i,l?null:n,d,r,u.requestOptions)];case 1:return"Success"==(p=a.sent()).ResponseClass&&(m=l?null:{Value:n,IsExplicit:!0},Object(_.e)(m,t,s)),Object(te.a)({isArchiveTag:t,actionSource:c,responseClass:p.ResponseClass}),[3,3];case 2:return b=a.sent(),ee.d.error("Error while updating conversation retention tag"+b),[3,3];case 3:return[2]}})})});var fe=n(740);Object($.mutator)(_.e,function(e){var t=e.itemIds,n=e.tag,r=e.isArchiveTag;t.forEach(function(e){var t=fe.H.items.get(e);t&&(r?t.ArchiveTag=n:t.PolicyTag=n)})}),n.d(t,"f",function(){return Ie}),n.d(t,"g",function(){return ve}),n.d(t,"a",function(){return o.a}),n.d(t,"b",function(){return o.c}),n.d(t,"d",function(){return S}),n.d(t,"c",function(){return M}),n.d(t,"e",function(){return T});var he=new r.c(function(){return n.e(436).then(n.bind(null,14194))}),Ie=new r.b(he,function(e){return e.onArchiveTagForFolderChanged}),ve=new r.b(he,function(e){return e.onDeleteTagForFolderChanged})},5076:function(e,t,n){"use strict";var r=n(0),o=n(5162),a=n(5),i=n(4),s=n(3196),c=function(e){return new Promise(function(t){return setTimeout(function(){t()},e)})},u=n(5163),d=n.n(u);function l(e,t,n,r){return d()({itemId:e,sessionId:t,version:n},r)}var p=n(151),m=n(772),b=n(745),f=n.n(b),h=(Object(i.orchestrator)(s.a,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,i,s,u,d,b,g,O,k,y,S,A,C;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(t=e.itemId,n=j(),!t||n.isLoading||0!==n.immersiveReaderFrameState)return[2];(i=new p.a("ShowInImmersiveReader")).addCustomData({sessionId:n.sessionId,subAction:e.subActionSource}),i.addActionSource(e.actionSource),h(!0),I(!0),s=(new Date).getUTCMilliseconds(),u=!0,d=null,b=null,r.label=1;case 1:return r.trys.push([1,7,8,9]),[4,l(f()({Id:t.Id}),n.sessionId,"2.0",null===(C=t.mailboxInfo)||void 0===C?void 0:C.requestOptions)];case 2:if(g=r.sent(),i.addCheckmark("ImmersiveReaderProcessText_Done"),g&&g.ReaderModelJson?d=JSON.parse(g.ReaderModelJson):(u=!1,b="Response from service call was null or did not contain a ReaderModelJson"),!u)return[3,6];O=(new Date).getUTCMilliseconds(),k=(O-s).toString(),null,d.launchToPostMessageSentDurationInMs=k,v({messageType:"LinguisticModel",messageValue:d}),y=120,S=0,r.label=3;case 3:return S<y&&1===j().immersiveReaderFrameState?[4,c(500)]:[3,5];case 4:return r.sent(),S++,[3,3];case 5:1===j().immersiveReaderFrameState&&(u=!1,b="Frame never got to Ready state"),r.label=6;case 6:return[3,9];case 7:return A=r.sent(),u=!1,i.addCheckmark("CaughtException"),b=A.toString(),[3,9];case 8:return h(!1),[7];case 9:return u?i.end():(I(!1),i.endWithError("ServerError",new Error(b)),Object(m.b)(Object(a.a)(o.b),Object(a.a)(o.a),!1,{hideCancelButton:!0})),[2]}})})}),Object(i.mutatorAction)("toggleImmersiveReaderLoadingState",function(e){j().isLoading=e})),I=Object(i.mutatorAction)("toggleImmersiveReaderShowingState",function(e){j().immersiveReaderFrameState=e?1:0}),v=Object(i.mutatorAction)("setImmersiveReaderApiResponse",function(e){j().apiResponse=e}),g=n(319),O={sessionId:Object(g.a)(),isLoading:!1,immersiveReaderFrameState:0,apiResponse:null},j=Object(i.createStore)("immersivereader",O),k=j(),y=Object(i.mutatorAction)("setImmersiveReaderFrameReady",function(){j().immersiveReaderFrameState=2}),S=Object(i.mutatorAction)("closeImmersiveReader",function(){var e=j();e.immersiveReaderFrameState=0,e.apiResponse=null});n.d(t,"e",function(){return k}),n.d(t,"b",function(){return j}),n.d(t,"c",function(){return y}),n.d(t,"a",function(){return S}),n.d(t,"d",function(){return s.a})},5162:function(e){e.exports={b:"xwc",a:"ywc"}},5723:function(e){e.exports={a:"_sb"}},6634:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(52),o=new r.c(function(){return n.e(254).then(n.bind(null,9361))}),a=new r.b(o,function(e){return e.preparePopoutDataForReadingPane})},6643:function(e){e.exports={a:"urc"}},6644:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,"._2Ij1xLT_HLp88M37zkVcqx{font-weight:600}html[dir] ._23f4dMU1_LGLt4GgPo3Lk9 .ms-ContextualMenu-header{padding:0 4px}._2XmjPcdNPHzJnErHgc7pg8{font-weight:700}",""]),t.locals={checkedItem:"_2Ij1xLT_HLp88M37zkVcqx",sectionHeader:"_23f4dMU1_LGLt4GgPo3Lk9",checkmark:"_2XmjPcdNPHzJnErHgc7pg8"}},6645:function(e){e.exports={a:"rrc",b:"src",c:"trc"}},6646:function(e){e.exports={a:"qrc"}},6673:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(5177),o=n(3331),a=n(1254);function i(e,t){var n=Object(o.a)(e),i=Object(a.a)(e)&&t,s=Object(r.b)(e);return[!n.ReplyAllowed||s||i,!n.ReplyAllAllowed||s||i,!n.ForwardAllowed||i]}},6955:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(52),o=new r.c(function(){return Promise.all([n.e(7),n.e(10),n.e(632),n.e(58),n.e(482)]).then(n.bind(null,9310))}),a=(new r.a(o,function(e){return e.loadSpaces}),new r.b(o,function(e){return e.getSpacesContextMenuItems}))},7715:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(838);function o(){return r.a.conversationReadingPaneViewState?r.a.conversationReadingPaneViewState.conversationSubject:null}},8264:function(e,t,n){"use strict";var r,o=n(4),a=Object(o.createStore)("AddinsSurfaceActionsStore",{isAddinObserverLoaded:!1})(),i=n(69),s=Object(i.action)("setAddinObserverLoaded ")(function(){a.isAddinObserverLoaded=!0}),c=n(806);c.s.import().then(function(e){r=e,s()});var u=n(0),d=n(128),l=n(859),p=n(732),m=n(2801);function b(e,t,n,o,i,s,b,f,h,I,v,g){var O,j=function(e,t){return a.isAddinObserverLoaded&&r?r(e,t).get():null}(e,v=v||function(e){if(!e||!e.ParentFolderId)return!1;var t=e.ParentFolderId.Id;return Object(p.L)(t,p.l)}(t));O=j?j.sectionProps.items:[];var k=e==l.a.MessageRead?Object(c.q)(n):Object(c.o)(n),y=!0;O.forEach(function(e){Object(c.m)(k,e);var t=e;if(t.iconOnly=!0,h&&(t.className=h),t.disabled=!!g,o.indexOf(e.key)>=0){var n=t;I&&(n=Object(u.__assign)({},t)),null!=n.name&&null!=n.title&&n.name.trim()!=n.title.trim()&&(n.name=n.ariaLabel),n.title="",function(e,t,n){t.isPinned=!0,t.subMenuProps&&t.subMenuProps.items.forEach(function(e){e.isPinned=!0}),n?e.unshift(t):e.push(t)}(i,n,b)}(-1==o.indexOf(e.key)||I)&&(y&&(!function(e,t){var n=e.length;n>0&&e[n-1].displayName!=m.a&&e.push({key:"addinDivider_"+t,displayName:m.a,itemType:d.a.Divider,onClick:null})}(s,f++),y=!1),t.renderedInOverflow=!0,t.subMenuProps&&t.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!0}),(t.itemType!==d.a.Divider||0!==s.length&&s[s.length-1].itemType!==d.a.Divider)&&s.push(t))})}n.d(t,"a",function(){return b})},8927:function(e,t,n){var r=n(12941),o=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)}},0,[634,21,25,38,489,1,2,22,577,185,0,578,189,3,459,7,379,8,13,16,361,5,6,329,355,10,79,4,12,131,73,358,572,148,306,565,110,609,370,342,376,423,541]]);
//# sourceMappingURL=owa.ItemActions.js.map
self.scriptsLoaded['owa.ItemActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ItemActions.js'] = (new Date()).getTime();