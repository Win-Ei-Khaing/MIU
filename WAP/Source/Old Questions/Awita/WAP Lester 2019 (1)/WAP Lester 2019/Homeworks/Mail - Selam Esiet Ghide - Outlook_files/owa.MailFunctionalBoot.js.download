self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFunctionalBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[340],{11447:function(e){e.exports={a:"qdc"}},11448:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(129);n.default=function(e,n){return r.makeServiceRequest("ConnectedAccountsNotification",e,n)}},14097:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t(52),o=new a.c(function(){return t.e(312).then(t.bind(null,14163))}),c=new a.b(o,function(e){return e.addLandmarkKeyboardNavigation}),i=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,c.import()];case 1:return e.sent()(),[2]}})})},u=t(737),s=t(2679),d=t(731);function l(){Object(s.f)(f)}function f(e){return Object(d.L)(Object(u.a)("inbox"))}var b=t(771);function h(){Object(s.g)(p)}function p(e){var n=Object(u.a)("inbox");return Object(d.L)(n)&&!Object(b.isPersonaInFavorites)(null,e.SenderSmtpEmailAddress)}var v=t(797),C=t(5),O=t(11447);var g=t(8233),m=t(40),j=t(33),w=t(65),I=t(151);function k(e){var n;return Object(r.__awaiter)(this,void 0,void 0,function(){var t,a,o,c,i,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(t=new I.a("RegisterServiceWorker"),!(a=null===(n=e.navigator)||void 0===n?void 0:n.serviceWorker))return[3,7];if(o=function(){var e,n=Object(j.a)().browser;Object(w.f)("fwk-prefetch-code-off")?e="Error_PrefetchDisabled":"Chrome"==n||"Edge Anaheim"==n?Object(w.f)("fwk-prefetch-code-off-chromium")&&!Object(j.k)([77])&&(e="Error_ChromeMinVersion"):"Edge"==n?Object(w.f)("auth-ServiceWorkerEdge")?Object(j.k)([17,17134])||(e="EdgeMinVersion"):e="EdgeFlightOff":"Safari"==n?Object(w.f)("auth-ServiceWorkerSafari")?Object(j.k)([11,1])||(e="SafariMinVersion"):e="SafariFlightOff":"Firefox"!=n&&(e="UnsupportedBrowser:"+n);return e}())return[3,5];i=Object(m.a)(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(g.a)(e,"mail",i.SessionSettings.UserLanguage,i.UserOptions.IsDarkModeTheme)];case 2:return r.sent(),[3,4];case 3:return u=r.sent(),c=u,[3,4];case 4:return[3,6];case 5:a.getRegistrations&&a.getRegistrations().then(function(e){for(var n=0;n<e.length;++n)e[n].unregister()}),r.label=6;case 6:return[3,8];case 7:o="SWNotAvailable",r.label=8;case 8:return t.addCustomData([o||"success"]),c?t.endWithError("ClientError",c):o?t.endWithError("ServerError"):t.end(),[2]}})})}var S=t(8287),E=t(2215),y=new a.c(function(){return t.e(262).then(t.bind(null,14154))}),R=new a.a(y,function(e){return e.loadGetStarted}),U=t(966),A=t(2369),P=new a.c(function(){return t.e(120).then(t.bind(null,14373))}),x=new a.a(P,function(e){return e.loadSenders}),N=t(8442),W=t(1946),F=t(2081),_=t(191),L=t(1671),M=t.n(L),T=t(747),V=t.n(T),H=t(1670),B=t.n(H),D=t(743),q=t.n(D),G=t(1015),J=t.n(G);var K=function(e){var n=[q()({FieldURI:"UnreadCount"}),q()({FieldURI:"TotalCount"})];return e&&n.push(q()({FieldURI:"PermissionSet"})),n},Q=t(732),$=t(1236),z=t(4),Y=t(62),X=(Object(z.orchestrator)(W.a,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,t,a,o;return Object(r.__generator)(this,function(r){return n=e.folderId,t=Object(Q.B)().get(n),a=t&&t.treeType===Q.l,o=Object($.b)(n).requestOptions,function(e,n,t){return M()({Header:Object(_.getJsonRequestHeader)(),Body:B()({FolderShape:J()({BaseShape:"IdOnly",AdditionalProperties:K(n)}),FolderIds:[V()({Id:e})]})},t).then(function(e){return e.Body.ResponseMessages.Items[0]})}(n,a,o).then(function(e){var t=e&&e.Folders[0];t&&(Object(F.a)(t.UnreadCount,t.TotalCount,n,!1),a&&Q.Y.import().then(function(e){e(n,t.PermissionSet.Permissions)}))}).catch(function(e){Y.d.warn("GetFolderDataOrchestrator: "+e)}),[2]})})}),t(982)),Z=t.n(X),ee=t(981),ne=t.n(ee);function te(){var e=Z()({FolderShape:J()({BaseShape:"IdOnly",AdditionalProperties:[q()({FieldURI:"TotalCount"}),q()({FieldURI:"UnreadCount"})]}),Paging:null,ParentFolderIds:[V()({Id:Object(u.a)("msgfolderroot")})],ReturnParentFolder:!0,ShapeName:null,Traversal:"Deep"});return ne()({Header:Object(_.getJsonRequestHeader)(),Body:e}).then(function(e){return e.Body.ResponseMessages.Items[0]})}var re=t(909),ae=t(1549),oe=t(2241);function ce(e){switch(e.EventType){case"Reload":case"QueryResultChanged":!function(){Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,te()];case 1:return"Success"==(e=n.sent()).ResponseClass?e.RootFolder.Folders.forEach(function(e){Object(F.a)(e.UnreadCount,e.TotalCount,e.FolderId.Id,!1)}):Y.d.warn("UpdateFolderCountsAction failed"),[2]}})})}();break;case"RowAdded":case"RowModified":var n=e;Object(F.a)(n.unreadCount,n.itemCount,n.folderId,!1),"RowAdded"===e.EventType&&oe.e.importAndExecute(n.folderId,n.parentFolderId,n.displayName),ae.f.import().then(function(n){n(e)});break;default:return}}function ie(){re.g.importAndExecute({subscriptionId:"HierarchyNotification",requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:"HierarchyNotification"}},ce)}var ue=new a.c(function(){return t.e(295).then(t.bind(null,14374))}),se=new a.a(ue,function(e){return e.postIRISService}),de=new a.a(ue,function(e){return e.getExperienceTypeForUser}),le=t(9290),fe=t(8318),be=t(8322),he=t(11448),pe=t.n(he),ve=t(245),Ce=t(1404),Oe=t(1521),ge=t(3183),me=t(2592),je=t(1752),we=t(2011);function Ie(){Object(S.a)(),we.b.importAndExecute(function(){return le.a.import()},{condition:Object(w.f)("fwk-devTools"),task:function(){return N.b.importAndExecute()}},i,function(){return k(window)},{condition:Object(w.f)("fwk-mailtoProtocolHandler"),task:function(){var e,n;(null===(n=null===(e=window)||void 0===e?void 0:e.navigator)||void 0===n?void 0:n.registerProtocolHandler)&&window.navigator.registerProtocolHandler("mailto",""+Object(v.m)()+Object(v.k)()+"deeplink/compose?mailtouri=%s",Object(C.a)(O.a))}},h,l,function(){return pe()({isOWALogon:!0})},{condition:Object(w.f)("fwk-skypeBusinessV2"),task:function(){return Ce.c.import().then(function(e){return e()})}},function(){return ge.a.importAndExecute()},ie,{condition:Object(ve.a)(),task:function(){return x.importAndExecute()}},{condition:Object(w.f)("auth-realtimeEmail"),task:function(){de.importAndExecute().then(function(e){e&&se.importAndExecute(e.toString())})}},be.b,{condition:0!=Object(A.i)(!1),task:function(){return fe.b.import()}},function(){return R.importAndExecute()},function(){return ae.i.importAndExecute()},function(){return ae.h.importAndExecute()},function(){return E.c.importAndExecute()},{condition:Object(me.j)(),task:function(){return me.d.importAndExecute()}},function(){return me.e.importAndExecute()},{condition:Object(je.d)(window),task:function(){return je.i.importAndExecute(window)}},function(){Oe.c.import().then(function(e){return e()})},{condition:Object(w.f)("rp-linkedInViewProfile"),task:function(){return U.b.importAndExecute()}}).then(function(){we.a.importAndExecute()})}var ke=t(869),Se=t(1318),Ee=t(740),ye=t(1570);Object(z.orchestrator)(s.c,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,t,a,o,c,i,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=e.notification,0!==Object(d.B)().tableQuery.listViewType?[3,3]:(t=Object(Ee.s)().conversations.get(n.conversationId),a={Id:n.conversationId,mailboxInfo:Object(ke.a)()},t?[3,2]:[4,Object(ye.d)(a,"LoadLikedConversation")]);case 1:r.sent(),r.label=2;case 2:return Re(a,n.subject),[3,6];case 3:return o=Object(Ee.s)().items.get(n.itemId),c={Id:n.itemId,mailboxInfo:Object(ke.a)()},(null===(u=o)||void 0===u?void 0:u.NormalizedBody)?(Re(c,n.subject),[3,6]):[3,4];case 4:return i={Id:n.itemId,mailboxInfo:Object(ke.a)()},[4,Object(ye.e)(i,"LoadLikedItem")];case 5:r.sent(),Re(i,n.subject),r.label=6;case 6:return[2]}})})});function Re(e,n){Se.j.importAndExecute(e,n,[],!0,null)}var Ue=t(7292),Ae=t(71);Object(z.orchestrator)(s.d,function(e){var n=e.notification,t=1===Object(Ae.f)().UserOptions.GlobalListViewTypeReact?n.ItemId:n.ConversationId;Object(Ue.a)("inbox",t)});t.d(n,"setupMailModulePostRender",function(){return Ie})},2451:function(e,n,t){"use strict";t.d(n,"b",function(){return o}),t.d(n,"e",function(){return c}),t.d(n,"c",function(){return i}),t.d(n,"g",function(){return u}),t.d(n,"d",function(){return s}),t.d(n,"f",function(){return d}),t.d(n,"a",function(){return l});var r=t(52),a=new r.c(function(){return Promise.all([t.e(7),t.e(572),t.e(148)]).then(t.bind(null,4233))}),o=new r.a(a,function(e){return e.loadCLPUserLabels}),c=new r.b(a,function(e){return e.showJustificationModal}),i=new r.a(a,function(e){return e.loadItemCLPInfo}),u=new r.b(a,function(e){return e.updateItemCLPInfo}),s=new r.b(a,function(e){return e.logReadCLPLabel}),d=new r.b(a,function(e){return e.triggerCLPAutoLabeling}),l=Object(r.d)(a,function(e){return e.CLPSubjectHeaderLabel})},3183:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(52),a=new r.c(function(){return t.e(508).then(t.bind(null,4768))}),o=new r.a(a,function(e){return e.loadWorkloadScenarioSettings})},4329:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(1222);function a(e){e?Object(r.p)(e,"Route"):Object(r.l)("Route")}},4331:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(52),a=new r.c(function(){return t.e(365).then(t.bind(null,6499))}),o=new r.a(a,function(e){return e.loadSignatureInUserOptions})},4993:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(893),a=t(731),o=t(905),c=t(1056);function i(e){var n=Object(o.a)(),t=Object(a.A)([e],n)[0];n.rowKeys.includes(t)&&Object(r.r)(n,t,!0,c.a.RouteHandler)}},7292:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(4329),a=t(4993);function o(e,n){Object(r.a)(e),Object(a.a)(n)}},8233:function(e,n,t){"use strict";var r,a=t(54),o=t(3),c=t(62);!function(e){e[e.Normal=0]="Normal",e[e.CacheCorrupt=1]="CacheCorrupt",e[e.TooManyInstallError=2]="TooManyInstallError"}(r||(r={}));var i,u=r;!function(e){e[e.Install=0]="Install",e[e.UnInstall=1]="UnInstall"}(i||(i={}));var s,d=i;!function(e){e[e.CacheProgress=0]="CacheProgress",e[e.Error=1]="Error"}(s||(s={}));var l,f=s;!function(e){e[e.Checking=0]="Checking",e[e.Downloading=1]="Downloading",e[e.Progress=2]="Progress",e[e.Error=3]="Error",e[e.Cached=4]="Cached",e[e.NoUpdate=5]="NoUpdate",e[e.Obsolete=6]="Obsolete",e[e.UpdateReady=7]="UpdateReady",e[e.Idle=8]="Idle",e[e.UnCached=9]="UnCached",e[e.CleanupError=10]="CleanupError",e[e.CleanupSuceeded=11]="CleanupSuceeded"}(l||(l={}));var b,h=l;!function(e){e[e.CacheInstalled=0]="CacheInstalled",e[e.CacheFailed=1]="CacheFailed",e[e.CacheCleared=2]="CacheCleared"}(b||(b={}));var p=b,v=t(151),C="SWCache";function O(e,n,t,r,a,o,c){var i={};i.ev=n,i.cv=t,i.e=r,i.rc=e.resourcesCached,i.ccs=e.cacheCleanupStatus,i.ncc=e.numberOfCachesCleaned,i.r=a,i.st=o,i.stk=c,i.ch=e.cacheHealth,i.app=e.appName,e.resourcesCached=0,e.cacheCleanupStatus=0,e.numberOfCachesCleaned=0,Object(v.m)(C,i)}var g=t(11);function m(e,n){return e+"_"+n}var j="SWCacheErrorCount";function w(e,n,t){var r=m(n.appName,j);0==t?Object(g.c)(e,r):Object(g.d)(e,r,""+t)}function I(e,n){var t=parseInt(Object(g.a)(e,m(n.appName,j)));return isNaN(t)?0:t}var k="CacheVersion",S="AttemptedCacheVersion";function E(e,n,t,r){switch(t){case p.CacheInstalled:Object(g.d)(e,m(n.appName,k),r),w(e,n,0);break;case p.CacheFailed:Object(g.d)(e,m(n.appName,S),r),w(e,n,I(e,n)+1);break;case p.CacheCleared:Object(g.d)(e,m(n.appName,k),null),Object(g.d)(e,m(n.appName,S),null),w(e,n,0)}}function y(e,n,t){if(null!=t.cacheMessage&&(t.targetClient==n.appName||"global"==t.targetClient)){var r=t.cacheMessage;switch(r.cacheEvent){case h.Checking:c.d.info("[SW Client] Checking");break;case h.Downloading:c.d.info("[SW Client] Downloading");break;case h.Progress:!function(e,n){c.d.info("[SW Client] Progress"),e.resourcesCached++}(n);break;case h.Error:!function(e,n,t){c.d.warn("[SW Client] Error: "+t.error),E(e,n,p.CacheFailed,t.cacheVersion),O(n,"ER",t.cacheVersion,t.error,t.resource,t.status,t.stack)}(e,n,r);break;case h.Cached:!function(e,n,t){c.d.info("[SW Client] Cached"),E(e,n,p.CacheInstalled,t.cacheVersion),O(n,"C",t.cacheVersion)}(e,n,r);break;case h.NoUpdate:!function(e,n,t){c.d.info("[SW Client] NoUpdate"),E(e,n,p.CacheInstalled,t.cacheVersion),O(n,"NU",t.cacheVersion)}(e,n,r);break;case h.Obsolete:!function(e,n,t){c.d.info("[SW Client] Obsolete"),E(e,n,p.CacheCleared,null),O(n,"OB"),n.cacheHealth>u.Normal&&(n.cacheHealth=u.Normal,x())}(e,n);break;case h.UpdateReady:!function(e,n,t){c.d.info("[SW Client] UpdateReady"),E(e,n,p.CacheInstalled,t.cacheVersion),O(n,"UR",t.cacheVersion)}(e,n,r);break;case h.Idle:c.d.info("[SW Client] Idle");break;case h.UnCached:c.d.info("[SW Client] Uncached");break;case h.CleanupError:!function(e,n){c.d.warn("[SW Client] Cleanup Error"),e.cacheCleanupStatus=1}(n);break;case h.CleanupSuceeded:!function(e,n){var t=null!=n.cachesCleaned?n.cachesCleaned.join(","):null;c.d.info("[SW Client] Cleanup Suceeded, "+t),e.cacheCleanupStatus=2,e.numberOfCachesCleaned=null!=n.cachesCleaned?n.cachesCleaned.length:0}(n,r)}}}var R=t(65),U=15,A=null,P=null;function x(){var e=Object(a.a)(P.location),n=(e?"/"+e:"")+"/"+A.appName+"cache.manifest?manifestVersion=2",t=d.Install;A.cacheHealth>u.Normal&&(t=d.UnInstall);var r={source:A.appName,action:t,bootResourcesOnly:!0,language:A.userLanguage,darkMode:void 0!==A.darkMode&&A.darkMode,manifestUrl:n,proxyFetchAlways:Object(R.f)("fwk-sw-proxyFetchAlways")};A.serviceWorkerRegistration.active.postMessage(r)}function N(e){if(null!=e.data){var n=e.data;n.messageType==f.CacheProgress?y(P,A,n):n.messageType==f.Error&&function(e){null!=e.error&&c.d.error({message:"[SW Client] ServiceWorker Unhandled Exception",error:e.error})}(n)}}var W=t(33),F="activated",_=null,L=null,M=null,T=null,V=null,H=!1;function B(e,n,t,r){L=(M=e).navigator.serviceWorker;var c=Object(a.a)(M.location);T=n,V=t,H=r;var i,u,s,d=(c?"/"+c:"")+"/sw.js",l=null!=c?{scope:"/"+c+"/"}:null,f=[];return["branch","ring","version"].some(function(n){return!!Object(o.d)(n,e.location)&&(f.push(n+"="+Object(o.a)(n,e.location)),!0)}),Object(R.f)("fwk-sw-proxyFetchAlways")&&(i=Object(W.a)(),u=i.browser,s=i.browserVersion,("Chrome"==u||"Edge Anaheim"==u)&&s&&s.length>0)&&f.push("fa=1"),f.length>0&&(d=d+"?"+f.join("&")),L.register(d,l).then(function(){L.ready.then(D)})}function D(e){c.d.info("[SW Client] ready fired, state: "+e.active.state),_=e,L.oncontrollerchange=J,q()}function q(){_.active.state==F?K():_.active.onstatechange=G}function G(e){_.active.state==F&&(_.active.onstatechange=null,K())}function J(){null!=_.active&&q()}function K(){var e,n;e={serviceWorkerContainer:L,serviceWorkerRegistration:_,appName:T,userLanguage:V,darkMode:H},n=M,null==A&&((A=e).serviceWorkerContainer.onmessage=N,I(window,A)>U&&(A.cacheHealth=u.TooManyInstallError)),P=n,x()}t.d(n,"a",function(){return B})},8322:function(e,n,t){"use strict";var r=t(52),a=t(2137),o=t(65),c=t(2612),i=t(731);function u(e,n,t,r){if(1!=e.length)return null;var a=e[0];return{uniqueSenders:i.b.getUniqueSenders(a,n),lastSenderSmtpAddress:i.b.getLastSenderSMTP(a,n),folderId:r}}t.d(n,"b",function(){return d}),t.d(n,"a",function(){return u});var s=new r.c(function(){return Promise.all([t.e(14),t.e(490)]).then(t.bind(null,14109))});function d(){Object(o.f)("tri-triagePattern")&&(Object(r.f)(a.d,s,function(e){return e.triagePatternsOrchestrator}),Object(r.f)(c.a,s,function(e){return e.triagePatternsOrchestratorForSearch}))}}},0,[3,5,8,13,422,604,21,25,38,334,634,489,1,2,22,577,185,0,578,189,605,352,506,151,298,459,7,379,635,58,45,496,16,361,10,626,444,6,355,79,4,12,131,29,57,96,663,37,127,73,358,458,572,148,49,347,353,609,370,466,119,122,238,253,255,295,312,342,365,366,376,508,541,716]]);
//# sourceMappingURL=owa.MailFunctionalBoot.js.map
self.scriptsLoaded['owa.MailFunctionalBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFunctionalBoot.js'] = (new Date()).getTime();