self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.58.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[58],{1004:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"i",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"f",function(){return s}),n.d(t,"g",function(){return d}),n.d(t,"d",function(){return l}),n.d(t,"h",function(){return f});var r=n(949);function a(e){return e?l(e)?r.e:f(e)?r.C:s(e)?r.t:c(e)?r.a:d(e)?r.v:u(e)?r.c:r.q:r.q}function i(e){return c(e)||s(e)}function o(e){return u(e)||d(e)}function c(e){var t;return(null===(t=e)||void 0===t?void 0:t.RecurrencePattern)&&e.RecurrencePattern.__type==r.b}function u(e){var t;return(null===(t=e)||void 0===t?void 0:t.RecurrencePattern)&&e.RecurrencePattern.__type==r.d}function s(e){var t;return(null===(t=e)||void 0===t?void 0:t.RecurrencePattern)&&e.RecurrencePattern.__type==r.u}function d(e){var t;return(null===(t=e)||void 0===t?void 0:t.RecurrencePattern)&&e.RecurrencePattern.__type==r.w}function l(e){var t;return(null===(t=e)||void 0===t?void 0:t.RecurrencePattern)&&e.RecurrencePattern.__type==r.f}function f(e){var t;return(null===(t=e)||void 0===t?void 0:t.RecurrencePattern)&&e.RecurrencePattern.__type==r.D}},1041:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,a=t%n;return(((e-=r)/n&(t-=a)/n)>>>0)*n+((r&a)>>>0)}return(e&t)>>>0}n.d(t,"a",function(){return r})},1051:function(e,t,n){"use strict";function r(e){var t=[];return e&&e.forEach(function(e){t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress})}),t}n.d(t,"a",function(){return r})},1184:function(e,t,n){"use strict";var r;!function(e){e[e.TxpActivity=0]="TxpActivity",e[e.Dining=1]="Dining",e[e.EventActivityType=2]="EventActivityType",e[e.FlightDeparture=3]="FlightDeparture",e[e.HotelCheckin=4]="HotelCheckin",e[e.HotelCheckout=5]="HotelCheckout",e[e.InvoiceDue=6]="InvoiceDue",e[e.ParcelDelivery=7]="ParcelDelivery",e[e.RentalCarPickup=8]="RentalCarPickup",e[e.RentalCarDropOff=9]="RentalCarDropOff",e[e.InvoiceScheduled=10]="InvoiceScheduled",e[e.ServiceAppointment=11]="ServiceAppointment"}(r||(r={})),t.a=r},1238:function(e,t,n){"use strict";var r;!function(e){e[e.EventSharingFromCalendar=0]="EventSharingFromCalendar",e[e.EventSharingFromMail=1]="EventSharingFromMail",e[e.EmailReminder=2]="EmailReminder"}(r||(r={})),t.a=r},1264:function(e){e.exports={a:"vaa"}},1283:function(e,t,n){"use strict";var r=n(1041);var a=n(1014),i=n(65),o=n(1617);function c(e){return function(e,t,n){return Object(r.a)(e,t)==t&&n}(e,a.d,Object(i.f)(o.a))}n.d(t,"a",function(){return c})},1319:function(e,t,n){"use strict";function r(){return{__type:void 0,ItemId:void 0,ParentFolderId:void 0,Subject:void 0,ReminderIsSet:void 0,ReminderMinutesBeforeStart:void 0,LastModifiedTime:void 0,InstanceKey:void 0,Preview:void 0,EffectiveRights:void 0,HasAttachments:void 0,Attachments:void 0,Sensitivity:void 0,Body:void 0,EntityNamesMap:void 0,IsDraft:void 0,Categories:void 0,Start:void 0,End:void 0,IsAllDayEvent:void 0,IsRoomRequested:void 0,FreeBusyType:void 0,IsMeeting:void 0,IsCancelled:void 0,IsRecurring:void 0,IsResponseRequested:void 0,CalendarItemType:void 0,ResponseType:void 0,Organizer:void 0,RequiredAttendees:void 0,OptionalAttendees:void 0,Resources:void 0,AppointmentReplyTime:void 0,Recurrence:void 0,Location:void 0,IntendedFreeBusyStatus:void 0,IsOrganizer:void 0,AppointmentReplyName:void 0,IsSeriesCancelled:void 0,CharmId:void 0,Locations:void 0,ClientSeriesId:void 0,UID:void 0,ExperienceType:void 0,DoNotForwardMeeting:void 0,IsOnlineMeeting:void 0,JoinOnlineMeetingUrl:void 0,InboxReminders:void 0,MeetingRequestWasSent:void 0,ExtractionSourceId:void 0,TxpObject:void 0,StartTimeZoneId:void 0,EndTimeZoneId:void 0,OnlineMeetingProvider:void 0,OnlineMeetingJoinUrl:void 0,OnlineMeetingConferenceId:void 0,OnlineMeetingTollNumber:void 0,OnlineMeetingTollFreeNumbers:void 0,SeriesMasterItemId:void 0,ExtractionSourceInternetMessageId:void 0,HideAttendees:void 0,PersonId:void 0,InReplyTo:void 0,IsFreeBusyOnly:void 0,MeetingNotesWebUrl:void 0,ConversationId:void 0,SkypeTeamsProperties:void 0}}n.d(t,"a",function(){return r})},1428:function(e,t,n){"use strict";var r=n(1014),a=n(1041);var i=n(1283);function o(e){return function(e){return!(e<=0||Object(a.a)(e,r.c)!=r.c&&Object(a.a)(e,r.e)!=r.e&&Object(a.a)(e,r.g)!=r.g&&Object(a.a)(e,r.f)!=r.f&&Object(a.a)(e,r.a)!=r.a&&Object(a.a)(e,r.b)!=r.b&&Object(a.a)(e,r.h)!=r.h)}(e)||function(e){return Object(a.a)(e,r.i)==r.i||Object(a.a)(e,r.j)==r.j||Object(a.a)(e,r.k)==r.k}(e)||Object(i.a)(e)}n.d(t,"a",function(){return o})},1454:function(e){e.exports={a:"jia"}},1495:function(e){e.exports={a:"iia"}},1496:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i});var r=2,a="",i=-1},1617:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r="cal-txp-invoice",a="cal-txp-serviceReservationAdaptive"},1653:function(e,t,n){"use strict";var r,a=n(1184),i={TxpActivity:"TxpActivity",flightdeparture:a.a.FlightDeparture,hotelcheckin:a.a.HotelCheckin,hotelcheckout:a.a.HotelCheckout,invoicedue:a.a.InvoiceDue,invoicescheduled:a.a.InvoiceScheduled,parceldelivery:a.a.ParcelDelivery,rentalcarpickup:a.a.RentalCarPickup,rentalcardropoff:a.a.RentalCarDropOff,dining:a.a.Dining,miscevent:a.a.EventActivityType,serviceappointment:a.a.ServiceAppointment};!function(e){e[e.None=0]="None",e[e.Unexpected=1]="Unexpected",e[e.Configuration=2]="Configuration",e[e.Trust=3]="Trust",e[e.Error=4]="Error",e[e.ByDesign=5]="ByDesign",e[e.InThePast=6]="InThePast",e[e.SharedEvent=7]="SharedEvent"}(r||(r={}));var o=r,c={EventReservation:"miscevent",FlightReservation:"flightdeparture",FoodEstablishmentReservation:"dining",Invoice:"invoicedue",LodgingReservation:"hotelcheckin",ParcelDelivery:"parceldelivery",RentalCarReservation:"rentalcarpickup",ServiceReservation:"serviceappointment"},u=n(1659),s={primary:u.a.Primary,secondary:u.a.Secondary},d=n(1496);function l(e,t,n,r){return{activityId:t.toString(),type:n,entityId:e,calendarEventIdIndex:d.c,eventOmission:o.None,role:s.primary,activityName:r}}var f={none:o.None,unexpected:o.Unexpected,configuration:o.Configuration,trust:o.Trust,error:o.Error,bydesign:o.ByDesign,inthepast:o.InThePast,sharedevent:o.SharedEvent};function v(e,t){var n=e.type?e.type.toLowerCase():null,r=i[n];return r?function(e,t,n,r){var a=e.calendarEventOmission?e.calendarEventOmission.toLowerCase():null,i=e.role?e.role.toLowerCase():null,o=f[a],c=s[i];return{activityId:r.toString(),type:t,entityId:e.entityId,calendarEventIdIndex:e.calendarEventIdIndex,eventOmission:o,role:c,activityName:n}}(e,r,n,t):null}var p=n(787),_=n(1238),b="schema.org parser",I="schema",m="extraction";function y(e,t){var n;if(e){var r=t?e["@EntityId"]:e["@id"];if(r){var a=_.a[e["additionalType/Txp"]],i=e["@source"],o=function(e,t){var n=null;return null!=e?n=_.a[e]:t&&(n=t.toLowerCase().indexOf(b)>-1?I:m),n}(a,i),c=e["originEmails/Txp"],u=e["@inferenceId"],s=e.immutableMessageIds,d=null,l=null,f=null;return(null===(n=c)||void 0===n?void 0:n.length)&&(d=c[0].ewsId,l=c[0].receivedTime,f=c[0].internetMessageId),{id:r,source:i,trustScore:e["@entityExtractionTrustLevel"],txpAdditionalType:a,origin:o,originalEmailEwsId:d,originalEmailReceivedTime:l,originalEmailInternetMessageId:f,inferenceId:u,immutableMessageIds:s,tripId:e.tripId}}}return null}var O=n(0),g=n(785);function h(e,t){return e&&t?Object(O.__assign)({basicEntity:e},{name:t.name,phone:t.phone}):null}function j(e,t,n){if(e&&t){var r=void 0;if(t.reservationId)r=t.reservationId;else if(t.reservationNumber)r=t.reservationNumber;else if(!n)return null;var a=t.underName,i=Object(O.__assign)(Object(O.__assign)({},e),{reservationId:r,reservationStatus:t.reservationStatus,modifyReservationUrl:t.modifyReservationUrl,underName:h({},a)}),o=t.reservedTicket;if(o){var c=o.ticketSeat;i=Object(O.__assign)(Object(O.__assign)({},i),{reservedTicket:{ticketNumber:o.ticketNumber,seat:{row:c?c.seatRow:null,seatNumber:c?c.seatNumber:null,section:c?c.seatSection:null}}})}return i}return null}function E(e,t){return e&&t?Object(O.__assign)(Object(O.__assign)({},e),{streetAddress:t.streetAddress,addressLocality:t.addressLocality,addressRegion:t.addressRegion,addressCountry:t.addressCountry,postalCode:t.postalCode,postOfficeBoxNumber:t.postOfficeBoxNumber}):null}function R(e){var t=E({},e.reservationFor.address);return{name:e.reservationFor.name,address:t,telephone:e.reservationFor.telephone,city:e.reservationFor.city}}function T(e,t){if(e&&t){var n=Object(O.__assign)(Object(O.__assign)({},e),{name:t.name,telephone:t.telephone,city:t["address/commonCity"]});return t.address&&(n=Object(O.__assign)(Object(O.__assign)({},n),{address:Object(O.__assign)({},t.address)})),n}return null}var A="numSeats";function C(e){var t=0;return e[A]&&e[A]>0&&(t=parseInt(e[A],10)-1),t}function S(e,t){return e&&t?e=T(e=Object(O.__assign)(Object(O.__assign)({},e),{iataCode:t.iataCode}),t):null}function F(e,t,n){var r;if(e&&t){var a=j(e,t,!1);if(function(e,t,n){var r,a;if(null===(a=null===(r=e)||void 0===r?void 0:r.reservationFor)||void 0===a?void 0:a.provider){var i=e.reservationFor,o=e.reservationFor.provider,c=!n||n(i.arrivalTime,!1,t)&&n(i.arrivalTimeUTC,!0,t)&&n(i.departureTime,!1,t)&&n(i.departureTimeUTC,!0,t);if(o.iataCode&&o.name&&N(i.arrivalAirport)&&N(i.departureAirport)&&i.flightNumber&&i.arrivalTime&&i.departureTime&&c)return!0}return!1}(t,e,n)){var i=t.reservationFor,o=i.provider;return a=Object(O.__assign)(Object(O.__assign)({},a),{entityName:p.a.FlightReservation,entityType:g.a.FlightReservation,checkinUrl:t.checkinUrl?t.checkinUrl:t.potentialAction?t.potentialAction.target:null,departureTime:i.departureTime,departureTimeUTC:i["departureTime/utc"],departureTerminal:i.departureTerminal,departureGate:i.departureGate,departureTimeZone:i["departureTime/windowsTimeZoneName"],arrivalTime:i.arrivalTime,arrivalTimeUTC:i["arrivalTime/utc"],arrivalTerminal:i.arrivalTerminal,arrivalGate:i.arrivalGate,arrivalTimeZone:i["arrivalTime/windowsTimeZoneName"],flightNumber:i.flightNumber,airline:{name:o.name,iataCode:o.iataCode},passengerNames:null===(r=t["underName/passengerNames"])||void 0===r?void 0:r.map(function(e){return h({},e)})}),a=Object(O.__assign)(Object(O.__assign)({},a),{departureAirport:S(a,i.departureAirport)}),a=Object(O.__assign)(Object(O.__assign)({},a),{arrivalAirport:S(a,i.arrivalAirport)})}}return null}function N(e){var t,n;return!!((null===(t=e)||void 0===t?void 0:t.iataCode)&&(e["address/commonCity"]||(null===(n=e.address)||void 0===n?void 0:n.addressLocality)))}function P(e,t){return e&&t?Object(O.__assign)({basicEntity:e},{name:t.name,telephone:t.telephone}):null}function k(e){if(e){if(!Array.isArray(e))return e;if(e.length>0)return e[0]}}function D(e,t){return e&&t?Object(O.__assign)(Object(O.__assign)({},e),{price:t.price,priceCurrency:t.priceCurrency}):null}function w(e,t,n){if(e&&t&&function(e,t,n){var r,a;if(e){var i=!0,o=!0;n&&(i=n(e.expectedArrivalFrom,!1,t),o=n(e.expectedArrivalUntil,!1,t));var c=k(e.partOfOrder);if((null===(a=null===(r=c)||void 0===r?void 0:r.seller)||void 0===a?void 0:a.name)&&(e.expectedArrivalFrom&&i||e.expectedArrivalUntil&&o))return!0}return!1}(t,e,n)){var r=k(t.partOfOrder),a=r.seller,i=Object(O.__assign)(Object(O.__assign)({},e),{entityName:p.a.ParcelDelivery,entityType:g.a.ParcelDelivery,trackingUrl:t.trackingUrl,trackingNumber:t.trackingNumber,expectedArrivalFrom:t.expectedArrivalFrom,expectedArrivalUntil:t.expectedArrivalUntil,expectedArrivalUntilUtc:t["expectedArrivalUntil/utc"],deliveryAddress:{},partOfOrder:{orderNumber:r.orderNumber,orderStatus:r.orderStatus,seller:{name:a.name,telephone:a.telephone}}});i.provider=P({},t.provider),i.deliveryAddress=E({},t.deliveryAddress);var o=k(t.partOfOrder.orderedItem);return o&&(i.partOfOrder=Object(O.__assign)(Object(O.__assign)({},i.partOfOrder),{orderedItem:{url:o.url,name:o.name,sku:o.sku,description:o.description,brand:o.brand,color:o.color}})),i}return null}function x(e,t){if(t=k(t),e&&t){var n=Object(O.__assign)(Object(O.__assign)({},e),{name:t.name,description:t.addressLocality,model:t.model});return t.brand&&(n=Object(O.__assign)(Object(O.__assign)({},n),{brand:Object(O.__assign)({},t.brand)})),n}return null}function L(e,t,n,r){if(e){var a=y(e,n);if(a){switch(e["@type"]){case p.a.FlightReservation:a=F(a,e,r);break;case p.a.RentalCarReservation:a=function(e,t,n){if(e&&t&&function(e,t,n){var r=!n||n(e.pickupTime,!1,t)&&n(e.dropoffTime,!1,t);return!!(e.reservationFor&&e.dropoffLocation&&e.pickupLocation&&e.pickupTime&&e.dropoffTime&&r)}(t,e,n)){var r=j(e,t,!0);return r=Object(O.__assign)(Object(O.__assign)({},r),{entityName:p.a.RentalCarReservation,entityType:g.a.RentalCarReservation,pickupTime:t.pickupTime,pickupTimeUTC:t["pickupTime/utc"],dropoffTime:t.dropoffTime,dropoffTimeUTC:t["dropoffTime/utc"],car:x(r,t.reservationFor),dropoffLocation:T(r,t.dropoffLocation),pickupLocation:T(r,t.pickupLocation),provider:t.provider})}return null}(a,e,r);break;case p.a.ParcelDelivery:a=w(a,e,r);break;case p.a.LodgingReservation:a=function(e,t,n){if(e&&t&&function(e,t,n){if(e){var r=!n||n(e.checkinTime,!1,t)&&n(e.checkoutTime,!1,t);if(e.checkinTime&&e.checkoutTime&&e.reservationFor&&r)return!0}return!1}(t,e,n)){var r=j(e,t,!0),a=k((r=Object(O.__assign)(Object(O.__assign)({},r),{entityName:p.a.LodgingReservation,entityType:g.a.LodgingReservation,checkinTime:t.checkinTime,checkoutTime:t.checkoutTime,checkinTimeUTC:t["checkinTime/utc"],checkoutTimeUTC:t["checkoutTime/utc"],lodgingBusiness:{},numAdults:t.numAdults,numChildren:t.numChildren})).lodgingBusiness);return a.address=E({},t.reservationFor.address),a.name=t.reservationFor.name,a.telephone=t.reservationFor.telephone,r}return null}(a,e,r);break;case p.a.FoodReservation:a=function(e,t,n){if(e&&t&&function(e,t,n){var r,a=!n||n(e.startTime,!1,t);return!!((null===(r=e)||void 0===r?void 0:r.startTime)&&e.underName&&e.underName.name&&e.reservationFor&&e.reservationFor.name&&a)}(t,e,n)){var r=j(e,t,!0);return r=Object(O.__assign)(Object(O.__assign)({},r),{entityName:p.a.FoodReservation,entityType:g.a.FoodReservation,startTime:t.startTime,startTimeUTC:t["startTime/utc"],partySize:Number(t["partySize/excludingOrganizer"]),restaurantInfo:R(t)})}return null}(a,e,r);break;case p.a.EventReservation:a=function(e,t){if(e&&t&&function(e){var t,n;return!!((null===(n=null===(t=e)||void 0===t?void 0:t.reservationFor)||void 0===n?void 0:n.startDate)&&e.underName&&e.underName.name)}(t)){var n=j(e,t,!0),r=t.reservationFor;if(r)return n=Object(O.__assign)(Object(O.__assign)({},n),{entityName:p.a.EventReservation,entityType:g.a.EventReservation,name:t.underName.name,startDate:r.startDate,startDateUtc:r["startDate/utc"],endDate:r.endDate,endDateUtc:r["endDate/utc"],numSeats:C(t),location:T(n,r.location),eventName:r.name})}return null}(a,e);break;case p.a.Invoice:a=t?function(e,t,n){var r,a,i;return e&&t&&function(e,t,n){var r=!n||n(e.scheduledPaymentDate,!1,t)||n(e.paymentDueDate,!1,t);return!!(e&&(e.accountId||e.accountIdEndsIn)&&e.provider&&e.provider.name&&(e.scheduledPaymentDate||e.paymentDueDate)&&r)}(t,e,n)?Object(O.__assign)(Object(O.__assign)({},e),{entityName:p.a.Invoice,entityType:g.a.Invoice,accountId:t.accountId,accountIdEndsIn:t["accountId/ending"],billingPeriod:t.billingPeriod,scheduledPaymentDate:t.scheduledPaymentDate,broker:P({},t.broker),category:t.category,customer:t.customer,provider:P({},t.provider),minimumPaymentDue:D({},t.minimumPaymentDue),totalPaymentDue:D({},t.totalPaymentDue),paymentDueDate:t.paymentDueDate,potentialAction:(r={},a=t.potentialAction,i=k(a),r&&i?Object(O.__assign)(Object(O.__assign)({},r),{url:i.url,description:i.description}):null),paymentStatus:t.paymentStatus}):null}(a,e,r):null;break;case p.a.ServiceReservation:a=function(e,t,n){if(e&&t&&function(e,t,n){var r;if(e){var a=e.reservationFor,i=!n||n(a.startTimeFrom,!1,t);if((null===(r=a)||void 0===r?void 0:r.name)&&a.startTimeFrom&&i&&a.provider&&a.provider.name)return!0}return!1}(t,e,n)){var r=j(e,t,!0),a=t.reservationFor;return r=Object(O.__assign)(Object(O.__assign)({},r),{entityName:p.a.ServiceReservation,entityType:g.a.ServiceReservation,startTimeFrom:a.startTimeFrom,startTimeFromUtc:t.reservationFor["startTimeFrom/utc"],endTimeFrom:a.endTimeFrom,endTimeFromUtc:t.reservationFor["endTimeFrom/utc"],name:a.name,underName:h(r,t.underName),provider:h(r,a.provider),location:T({},a.location),confirmReservationUrl:t.confirmReservationUrl,modifyReservationUrl:t.modifyReservationUrl})}return null}(a,e,r);break;default:return null}return a}}return null}function M(e,t,n,r,a){if(e){var o=void 0,u=void 0;try{u=JSON.parse(e)}catch(e){u=null}if(u)if(o=function(e,t,n,r){var a={},i=[];return e&&e.forEach(function(e){var o=L(e,t,n,r);if(!o)return null;a[o.id]=o,i.push(o)}),0==Object.keys(a).length?null:{entitiesDictionary:a,entitiesArray:i}}(function(e){var t;if(e){var n=e.filter(function(e){return e.type!=i.TxpActivity}).map(function(e){return e.entities});t=[].concat.apply([],n)}return 0!=t.length?t:null}(u),t,r,a)){var s=void 0;if(n)s=function(e){var t;if(e){t=[];for(var n=0;n<e.length;n++){var r=e[n],a=c[r.entityName],o=i[a];o&&t.push(l(r.id,n,o,a))}}return t}(o.entitiesArray);else s=function(e,t){if(e){for(var n=[],r=0;r<e.length;r++){var a=e[r];if(a&&t&&t[a.entityId]){var i=v(a,r);if(!i)return null;n.push(i)}}return 0==n.length?null:n}return null}(((d=u)&&(f=d.filter(function(e){return e.type==i.TxpActivity}).map(function(e){return e.entities})),0!=f[0].length?f[0]:null),o.entitiesDictionary);if(s&&s.length>0)return{txpEntities:o.entitiesDictionary,txpActivities:s}}}var d,f;return null}n.d(t,"a",function(){return M})},1655:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("poll",function(e,t,n){return{requestFunction:e,requestIdentifier:t,interval:n}}),i=Object(r.action)("responseRetrieved",function(e,t){return{response:e,responseIdentifier:t}}),o=Object(r.action)("cancelPoll",function(e){return{requestIdentifier:e}}),c={currentRequest:new(n(21).ObservableMap)},u=Object(r.createStore)("requestIdStore",c);Object(r.mutator)(o,function(e){var t=u().currentRequest.get(e.requestIdentifier);if(t){var n=t.timer;clearTimeout(n),t.timer=null}});var s=n(0),d=Object(r.mutatorAction)("setCurrentRequestId",function(e,t){var n=u().currentRequest.get(e);n?n.requestId=t:u().currentRequest.set(e,{requestId:t,timer:null})});function l(e,t){return u().currentRequest.get(e).requestId===t}function f(e,t){return Object(s.__awaiter)(this,void 0,void 0,function(){var n,r,a;return Object(s.__generator)(this,function(i){switch(i.label){case 0:return n=Math.random(),d(t,n),[4,e()];case 1:return r=i.sent(),a={isCurrent:l(t,n)},[2,Object(s.__assign)({response:r},a)]}})})}var v=Object(r.mutatorAction)("setPollTimer",function(e,t){var n=u().currentRequest.get(e);n&&(n.timer=t)});Object(r.orchestrator)(a,function(e){var t=e.requestFunction,n=e.requestIdentifier,r=e.interval;o(n);var c=setTimeout(function(){return function(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,function(){var r;return Object(s.__generator)(this,function(o){switch(o.label){case 0:return[4,f(function(){return e()},t)];case 1:return(r=o.sent()).isCurrent&&i(r.response,t),a(e,t,n),[2]}})})}(t,n,r)},r);v(n,c)}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"d",function(){return f})},1659:function(e,t,n){"use strict";var r;!function(e){e[e.Primary=0]="Primary",e[e.Secondary=1]="Secondary"}(r||(r={})),t.a=r},1662:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(7);function a(e,t){var n;if(null===(n=t)||void 0===n?void 0:n.RecurrenceRange){var a=t.RecurrenceRange.EndDate;if(a)return Object(r.Pb)(e,a)}return null}},1717:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(4),a=Object(r.action)("logCacheUpdateForDiagnostics",function(e){return{cacheUpdateLog:e}})},1718:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(4),a=Object(r.action)("logNotificationUpdateForDiagnostics",function(e){return{notificationUpdateLog:e}})},308:function(e,t,n){"use strict";var r=n(0),a=n(7),i=n(412),o=n.n(i),c=n(413),u=n.n(c),s=n(414),d=n.n(s),l=n(415),f=n.n(l),v=n(416),p=n.n(v),_=n(417),b=n.n(_),I=n(191),m=n(357),y=n(65),O=n(246);function g(e,t,n,i,c,s){var l;return Object(r.__awaiter)(this,void 0,void 0,function(){var v,_,g;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return v=Object(I.getJsonRequestHeader)(),c&&(v.TimeZoneContext.TimeZoneDefinition.Id=c),g=null,s?[4,Object(O.e)(s)]:[3,2];case 1:g=r.sent(),r.label=2;case 2:return r.trys.push([2,,4,5]),[4,b()({request:{Header:v,Body:f()({MailboxDataArray:n.map(function(e){return p()({Email:u()({Address:e})})}),FreeBusyViewOptions:d()({RequestedView:i,TimeWindow:o()({StartTime:Object(a.qb)(e),EndTime:Object(a.qb)(t)})})})}},g)];case 3:return _=r.sent(),[3,5];case 4:return Object(y.f)("cal-mf-diagnostics")&&Object(m.a)({action:"GetUserAvailabilityInternal",status:_?_.Body.ResponseCode:"Error",response:null===(l=_)||void 0===l?void 0:l.Body}),[7];case 5:return[2,_.Body]}})})}var h=n(125),j=n(45),E=n(62),R=5e3,T=function(e){var t={};return e.forEach(function(e){return t[e]={FreeBusyViewType:"None"}}),t};function A(e,t,n,a,i,o){return void 0===i&&(i=!0),Object(r.__awaiter)(this,void 0,void 0,function(){var c,u,s,d,l,f,v;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(0===n.length)return[2];(c=new h.a("FreeBusyAvailabilityRequested")).addCustomData({numAttendees:n.length}),r.label=1;case 1:return r.trys.push([1,3,,8]),[4,g(e,t,n,"DetailedMerged",e.tz,o)];case 2:return u=r.sent(),c.end(),s="Success"===u.ResponseClass&&n.length===u.Responses.length,d={},s?n.forEach(function(e,t){d[e]=u.Responses[t].CalendarView}):d=T(n),i&&(l=s?Object.keys(d).filter(function(e){return"None"==d[e].FreeBusyViewType}):n).length>0&&A(e,t,l,a,!1,o),a(d),[3,8];case 3:return f=r.sent(),c.endWithError("ServerError",f),E.d.warn('[getAvailabilityFunction] Received error calling getUserAvailabilityService, Error: "'+f.stack+'"'),i?f&&"GetUserAvailabilityInternal failed: Microsoft.Exchange.Services.Core.Types.ErrorApiQuarantinedException"==f.message?[4,Object(j.a)(R)]:[3,5]:[3,6];case 4:r.sent(),r.label=5;case 5:return A(e,t,n,a,!1,o),[3,7];case 6:v=T(n),a(v),r.label=7;case 7:return[3,8];case 8:return[2]}})})}n.d(t,"a",function(){return A}),n.d(t,"b",function(){return g})},357:function(e,t,n){"use strict";var r=n(362);n.d(t,"a",function(){return r.a})},362:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(4),a=Object(r.action)("logServiceCallForDiagnostics",function(e){return{serviceCall:e}})},744:function(e,t,n){"use strict";var r=n(1428),a=n(210),i=n(826),o=n(345);function c(e){return!!e.EffectiveRights&&!!e.EffectiveRights.Modify&&!Object(a.E)(e.ParentFolderId.Id)&&!Object(i.c)(e)&&("Private"!==e.Sensitivity||(t=e.ParentFolderId.Id,n=Object(a.n)(t),Object(o.b)(n)));var t,n}var u=function(e){return V(e)&&c(e)&&!e.IsCancelled},s=n(131),d=function(e){var t,n;return(null===(n=null===(t=e)||void 0===t?void 0:t.ParentFolderId)||void 0===n?void 0:n.mailboxInfo)&&e.ParentFolderId.mailboxInfo.type==s.a.GroupMailbox};function l(e,t){if(!e)return!1;var n=!d(e),r=function(t){return t?n?t.filter(function(t){return!e.Organizer||t.Mailbox.EmailAddress!=e.Organizer.Mailbox.EmailAddress}):t:[]},a=r(e.RequiredAttendees).length,i=r(e.OptionalAttendees).length;return t?a+i>0:a+i+r(e.Resources).length>0}function f(e){return e.IsDraft?l(e):e.IsMeeting||l(e)}var v=function(e){return!f(e)&&!e.IsOrganizer&&c(e)&&!e.IsCancelled},p=function(e){return!(!e.IsOrganizer||f(e)&&e.MeetingRequestWasSent||!c(e))},_=n(71),b=n(855);function I(e){var t=Object(a.n)(e.ParentFolderId.Id),n=Object(b.b)(e);return c(e)&&f(e)&&!([3,6,7].includes(t.CalendarFolderType)||n.IsMeetingPollEvent)}function m(e){return!!(e.IsOrganizer&&e.IsMeeting&&e.MeetingRequestWasSent&&c(e))}var y=function(e){return p(e)||u(e)||v(e)};function O(e){return!e.IsOrganizer&&e.IsMeeting&&!e.IsCancelled&&c(e)}function g(e){return 0==Object(_.f)().SessionSettings.WebSessionType&&O(e)&&e.IsResponseRequested&&!e.IsAllDayEvent&&(!e.IsRecurring||E(e))}function h(e){return!e.IsOrganizer&&e.IsCancelled&&c(e)}function j(e){return!Object(r.a)(e.EntityNamesMap)&&e.IsOrganizer&&c(e)}function E(e){return e.IsRecurring&&"RecurringMaster"!==e.CalendarItemType&&"ThisAndFollowingInstancesMaster"!==e.CalendarItemType}function R(e){return"RecurringMaster"===e.CalendarItemType}function T(e){return"ThisAndFollowingInstancesMaster"===e.CalendarItemType}function A(e){return d(e)&&!e.IsCancelled}function C(e){if(e){var t=Object(a.n)(e.ParentFolderId.Id);if(t)return t.IsSharedWithMe||Object(o.c)(t)}return!1}var S=n(65);function F(e){return!!Object(S.f)("cal-recurrenceThisDateForward")&&(d(e)?Object(S.f)("cal-groupNotifications"):!C(e)||Object(S.f)("cal-mf-enableFTDFOnSharedCalendar"))}var N=function(e){var t=Object(a.n)(e.ParentFolderId.Id),n=t?t.CalendarFolderType:void 0;return(Object(i.c)(e)||c(e))&&(!n||1==n||3==n||5==n)};function P(e){return e.IsMeeting}function k(e){return!!Object(S.f)("cal-mf-hideAttendeeList")&&(!C(e)||Object(S.f)("cal-mf-enableHideAttendeeListOnSharedCalendar"))}var D=function(e){if(!e)return!1;var t=e.ParentFolderId.mailboxInfo.deprecatedMailboxId;return w(e.RequiredAttendees,t)||w(e.OptionalAttendees,t)};function w(e,t){return e&&e.some(function(e){return e.Mailbox.EmailAddress.toLowerCase()==t})}var x=n(880);function L(e){if(!e)return!1;var t=!1;return e.forEach(function(e){Object(x.c)(e.Mailbox.EmailAddress)||(t=!0)}),t}function M(e){var t;return!!(null===(t=e.EffectiveRights)||void 0===t?void 0:t.Read)}function U(e){if(!e)return!1;var t=Object(a.n)(e.ParentFolderId.Id);return t&&3==t.CalendarFolderType}function K(e){return"Exception"===e}function q(e){return"Occurrence"===e}function B(e){return q(e.CalendarItemType)||K(e.CalendarItemType)}function V(e){var t;return(null===(t=e)||void 0===t?void 0:t.IsMeeting)&&!e.IsOrganizer}function H(e){return e.IsMeeting&&e.IsOrganizer}function z(e){return Object(i.c)(e)&&f(e)}var W=n(7);function G(e,t){return e&&t&&!Object(i.c)(e)&&Object(W.Gb)(t.Start,e.Start)&&Object(W.Gb)(t.End,e.End)&&t.IsAllDayEvent==e.IsAllDayEvent}function Z(e){return"RecurringMaster"===e}function J(e){return!(!e.IsMeeting||!e.IsOrganizer||!e.IsDraft&&e.MeetingRequestWasSent)}var Y=n(852);function Q(e,t){var n,r;return!(t&&t.length>0)||(e.Subject&&-1!=e.Subject.toLowerCase().indexOf(t.toLowerCase())||(null===(n=e.Location)||void 0===n?void 0:n.DisplayName)&&-1!=Object(Y.d)(e.Location.DisplayName,e.Location.PostalAddress).toLowerCase().indexOf(t.toLowerCase())||(null===(r=e.Organizer)||void 0===r?void 0:r.Mailbox)&&-1!=e.Organizer.Mailbox.Name.toLowerCase().indexOf(t.toLowerCase()))}n.d(t,"j",function(){return I}),n.d(t,"c",function(){return m}),n.d(t,"d",function(){return y}),n.d(t,"o",function(){return O}),n.d(t,"l",function(){return g}),n.d(t,"m",function(){return h}),n.d(t,"h",function(){return j}),n.d(t,"I",function(){return E}),n.d(t,"J",function(){return R}),n.d(t,"z",function(){return T}),n.d(t,"b",function(){return A}),n.d(t,"a",function(){return F}),n.d(t,"e",function(){return u}),n.d(t,"f",function(){return v}),n.d(t,"g",function(){return p}),n.d(t,"i",function(){return N}),n.d(t,"k",function(){return c}),n.d(t,"n",function(){return P}),n.d(t,"r",function(){return l}),n.d(t,"p",function(){return k}),n.d(t,"s",function(){return D}),n.d(t,"t",function(){return L}),n.d(t,"u",function(){return M}),n.d(t,"v",function(){return U}),n.d(t,"w",function(){return f}),n.d(t,"x",function(){return B}),n.d(t,"y",function(){return K}),n.d(t,"A",function(){return V}),n.d(t,"B",function(){return C}),n.d(t,"C",function(){return H}),n.d(t,"D",function(){return z}),n.d(t,"E",function(){return q}),n.d(t,"F",function(){return d}),n.d(t,"G",function(){return G}),n.d(t,"H",function(){return Z}),n.d(t,"K",function(){return J}),n.d(t,"q",function(){return Q})},763:function(e,t,n){"use strict";var r=n(0),a=n(4),i=n(21),o={calendarFolderEvents:new i.ObservableMap,fullItemsMruMap:new i.ObservableMap},c=Object(a.createStore)("calendarEventsStore",o),u=n(320);function s(e,t){for(var n={start:e.Start,end:e.End},r=0;r<t.length;r++)if(0===Object(u.j)(t[r],n,!0))return!0;return!1}function d(e,t,n){var a=n.dateRangesToRetain,i=n.eventsToRetain;return function(e,t,n){for(var a=t.dateRangesToRetain,i=t.eventsToRetain,o=n.startIndex,c=n.endIndex,u=[{startIndex:o,removeCount:0,finished:!1}],d=0,l=o;l>=0&&l<=c&&l<=e.length;l++){var f=e[l];i[f.Key]||s(f,a)?u[d].finished=!0:u[d].finished?(u.push({startIndex:l,removeCount:1,finished:!1}),d+=1):u[d].removeCount+=1}var v=[];return u.filter(function(e){return 0!==e.removeCount}).reverse().forEach(function(t){var n=e.splice(t.startIndex,t.removeCount);v.push.apply(v,Object(r.__spread)(n.reverse()))}),v.reverse()}(t,{dateRangesToRetain:a.filter(function(t){return 0===Object(u.j)(t,e,!0)}),eventsToRetain:i},function(e,t){for(var n={startIndex:-1,endIndex:-1},r=0;r<e.length;r++){var a=Object(u.j)({start:e[r].Start,end:e[r].End},t,!0);if(0===a&&-1===n.startIndex)n.startIndex=r;else if(0!==a&&-1!==n.startIndex){n.endIndex=r-1;break}}return-1!==n.startIndex&&-1===n.endIndex&&(n.endIndex=e.length-1),n}(t,e))}function l(e,t,n){e=Object(r.__spread)(e);for(var a=[],i=t.length-1;i>=0&&e.length>0;i--){var o=t[i],c=e.indexOf(o.Key);if(-1!==c&&f(o,n)){var u=t.splice(i,1);a.push.apply(a,Object(r.__spread)(u)),e.splice(c,1)}else-1!==c&&e.splice(c,1)}return a.reverse()}function f(e,t){var n=t.dateRangesToRetain,r=t.eventsToRetain;return!s(e,n)&&!r[e.Key]}function v(e,t){t.locksInfo.get(e)||t.locksInfo.set(e,{lockedDateRange:null,lockedEvents:{}})}function p(e){return void 0===e&&(e=function(){return!0}),function(t,n){var a=Object(r.__read)(n,2),i=a[0],o=a[1];return e([i,o])&&Object.keys(o.lockedEvents).forEach(function(e){return t[e]=!0}),t}}function _(e){return void 0===e&&(e=function(){return!0}),function(t,n){var a=Object(r.__read)(n,2),i=a[0],o=a[1];return e([i,o])&&o.lockedDateRange&&t.push(o.lockedDateRange),t}}var b,I=function(e){return function(t){return Object(r.__read)(t,1)[0]!==e}};function m(e,t,n){v(t,n);var a=n.locksInfo.get(t),i=a.lockedDateRange,o=a.lockedEvents,c=Object(r.__spread)(n.locksInfo.entries()).reduce(_(e!==b.EventIds?I(t):function(){return!0}),[]),u=Object(r.__spread)(n.locksInfo.entries()).reduce(p(e!==b.DateRange?I(t):function(){return!0}),{});!i||e!==b.All&&e!==b.DateRange||(d(i,n.events,{dateRangesToRetain:c,eventsToRetain:u}),a.lockedDateRange=null);var s=Object.keys(o);s.length>0&&(e===b.All||e===b.EventIds)&&(l(s,n.events,{dateRangesToRetain:c,eventsToRetain:u}),a.lockedEvents={})}!function(e){e[e.All=0]="All",e[e.DateRange=1]="DateRange",e[e.EventIds=2]="EventIds"}(b||(b={}));var y=n(7);var O=n(192);function g(e,t,n){void 0===n&&(n=!1);t.Key;var a,i=Object(r.__rest)(t,["Key"]),o=n?i:(a=i,Object.keys(a).reduce(function(e,t){return void 0!==a[t]&&(e[t]=a[t]),e},{}));O(e,o)}var h=n(1717),j=n(65),E=function(e){Object(j.f)("cal-cacheDiagnostics")&&setTimeout(function(){return Object(h.a)(e)},0)};function R(e,t,n,a){void 0===n&&(n=0),void 0===a&&(a=!1),e=function(e,t,n){for(var r=function(e){return e.reduce(function(e,t,n){return e[t.Key]=n,e},{})}(t),a=[],i=[],o=0;o<e.length;o++){var c=e[o],u=r[c.Key];if(void 0!==u){var s=t[u];g(s,c,n),i.push(u),a.push(s)}else a.push(c)}return(d=i,l=d.reduce(function(e,t){return e[t]=t,e},{}),Object.keys(l).map(function(e){return l[e]})).sort(function(e,t){return t-e}).forEach(function(e){return t.splice(e,1)}),{newEventsToAdd:a};var d,l}(e,t,a).newEventsToAdd;for(var i=[{startIndex:-1,eventsToAdd:[],finished:!1}],o=n,c=0;o<t.length&&c<e.length;){var u=t[o],s=e[c],d=Object(y.p)(s.Start,u.Start),l=-1===d,f=1===d;0===d?(T(s,o,i),c++):l?(T(s,o,i),c++):f&&(i[i.length-1].finished=!0,o++)}if(c<e.length){var v=e.slice(c,e.length);i.push({startIndex:t.length,eventsToAdd:v,finished:!0})}i.filter(function(e){return 0!==e.eventsToAdd.length}).reverse().forEach(function(e){return t.splice.apply(t,Object(r.__spread)([e.startIndex,0],e.eventsToAdd))});var p=Object(r.__spread)(e);return function(e){e.sort(function(e,t){return Object(y.p)(e.Start,t.Start)})}(p),E({lockId:"",updateMessage:"Upserted "+p.length+" items in the cache"}),p}function T(e,t,n){var r=n[n.length-1];if(-1===r.startIndex)r.startIndex=t,r.eventsToAdd.push(e);else if(r.finished){var a={startIndex:t,eventsToAdd:[e],finished:!1};n.push(a)}else r.eventsToAdd.push(e)}var A=function(e,t){return Object(y.p)(e.Start,t.Start)};function C(e,t,n,a,i){void 0===a&&(a=!1),void 0===i&&(i=!1),v(t,n);var o=n.events;if(a){var c=function(e,t){for(var n=null,r=0;r<t.length;r++)if(t[r].Key===e){n=t[r];break}return n?{event:n,index:r}:{event:null,index:-1}}(e.Key,o);c.event&&(o.splice(c.index,1),g(c.event,e,i),e=c.event)}var u=function(e,t,n){for(var r=0,a=0,i=t?t.length-1:0;a<=i;){var o=n(e,t[r=Math.floor((a+i)/2)]);if(0==o)return r;if(o<0){if(i=r-1,r<=a)return Math.max(a,i)}else if(a=r+1,r>=i)return a}return r}(e,o,A),s=u>=0?u:0,d=Object(r.__read)(R([e],o,s,i),1)[0];return n.locksInfo.get(t).lockedEvents[e.Key]=!0,E({lockId:t,updateMessage:"Event with startTime "+d.Start+" added to the lock"}),d}var S=n(62);function F(e,t,n,r){v(n,r);var a,i,o=r.locksInfo.get(n).lockedDateRange,c=o?o.start+" - "+o.end:"null";o&&(a=o,i=e,0==Object(u.j)(a,i,!0)||function(e,t){return 1==(Object(y.p)(e.start,t.start)<0?Object(y.w)(t.start,e.end):Object(y.w)(e.start,t.end))}(a,i))&&!Object(u.c)(e,o,!0)?Object(u.c)(o,e,!0)?S.d.info("[addEventsForLock]: Date range in lock "+n+" already contains the range to be added."):o=Object(u.f)(o,e):(S.d.info('[addEventsForLock] Replacing all items in cache for lock "'+n+'". Date range: '+e.start+" - "+e.end),m(b.DateRange,n,r),o=e);var s=R(t,r.events);return r.locksInfo.get(n).lockedDateRange=o,S.d.info('[addEvents] New range in cache for lock "'+n+'": '+o.start+" - "+o.end),E({lockId:n,updateMessage:s.length+" events added to the lock. Previous locked daterange: "+c+". New locked daterange: "+o.start+" - "+o.end}),s}function N(e,t,n){v(t,n);var a=n.locksInfo.get(t),i=a.lockedDateRange;if(i&&!Object(u.c)(e,a.lockedDateRange,!0)){E({lockId:t,updateMessage:"Now evicting events in cache except for events in date range "+e.start+" - "+e.end+". Current locked cache range: "+i.start+" - "+i.end});var o=Object(r.__spread)(n.locksInfo.entries()).reduce(_(I(t)),[e]),c=Object(r.__spread)(n.locksInfo.entries()).reduce(p(),{}),s=d(i,n.events,{dateRangesToRetain:o,eventsToRetain:c});S.d.info("[owa-events-cache:evictEventsExceptInDateRangeForLock] Evicted "+s.length+" events for lock '"+t+"'"),Object(u.c)(i,e,!0)?a.lockedDateRange=Object(r.__assign)({},e):a.lockedDateRange=function(e,t){var n=-1===Object(y.p)(e.start,t.start),r=1===Object(y.p)(e.end,t.end),a=e.start,i=e.end;n&&(a=t.start);r&&(i=t.end);return{start:a,end:i}}(e,i),E({lockId:t,updateMessage:"Evicted "+s.length+" events for lock. New locked cache range: "+i.start+" - "+i.end})}}function P(e,t){for(var n=t.events,a=0,i=[],o=n.length-1;o>=0;o--){var c=n[o];e(c)&&(i.push(c),n.splice(o,1),a++)}return function(e,t){Object(r.__spread)(t.locksInfo.keys()).forEach(function(n){var r=t.locksInfo.get(n);e.forEach(function(e){return delete r.lockedEvents[e.Key]})})}(i,t),E({lockId:"",updateMessage:"Unloaded "+a+" items from cache"}),i.reverse()}function k(e,t){var n,a,i=[];try{for(var o=Object(r.__values)(t),c=o.next();!c.done;c=o.next()){var s=c.value,d={start:s.Start,end:s.End},l=Object(u.j)(e,d,!0);if(0===l)i.push(s);else if(l>0)break}}catch(e){n={error:e}}finally{try{c&&!c.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return i}var D=n(3);function w(e,t,n){var r=n.locksInfo.get(t)||{},a=r.lockedDateRange,i=void 0===a?null:a,o=r.lockedEvents,c=void 0===o?[]:o;return null===i&&0===Object.keys(c).length?e.map(function(e){return null}):function(e,t,n){for(var r=n.locksInfo.get(t),a=r.lockedDateRange,i=r.lockedEvents,o=e.reduce(function(e,t){return e[t]=!0,e},{}),c={},s=0,d=0;d<n.events.length&&s<e.length;d++){var l=n.events[d],f={start:l.Start,end:l.End},v=!!a&&0===Object(u.j)(a,f,!0);o[l.Key]&&(v||i[l.Key])&&(c[l.Key]=l,s++)}return e.map(function(e){return c[e]||null})}(e,t,n)}var x=0;function L(){return{events:[],locksInfo:new i.ObservableMap}}function M(e){var t=K(e);return t?Object(r.__spread)(t.locksInfo.entries()).reduce(_(),[]):[]}function U(e,t){var n,a=K(e);return a?Object(r.__spread)(a.locksInfo.entries()).reduce((void 0===(n=function(e){return function(t){var n=Object(r.__read)(t,2),a=(n[0],n[1]);return a.lockedDateRange&&0===Object(u.j)(a.lockedDateRange,e,!1)}}(t))&&(n=function(){return!0}),function(e,t){var a=Object(r.__read)(t,2),i=a[0],o=a[1];return n([i,o])&&e.push(i),e}),[]):[]}function K(e){return c().calendarFolderEvents.get(e)||null}function q(e){return!!K(e)}function B(e,t){var n=[],r=[];return e.forEach(function(e){var a={start:e.Start,end:e.End};t.some(function(e){return 0===Object(u.j)(e,a,!0)})?n.push(e):r.push(e)}),{eventsOverlapping:n,eventsNotOverlapping:r}}var V=Object(a.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK",function(e,t,n,r){return{lockId:e,folderId:t,eventKey:n,partialCalendarEvent:r}}),H=Object(a.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK_FAILED",function(e,t,n){return{lockId:e,folderId:t,eventKey:n}}),z=Object(a.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED_FOR_LOCK",function(e,t,n,r,a,i){return{lockId:e,folderId:t,eventKey:n,event:r,eventScope:a,forceOverrideAllPropertiesForEventIfAvailable:i}}),W=Object(a.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED",function(e,t,n){return{folderId:e,eventKey:t,event:n}}),G=Object(a.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_SERVER",function(e){return{partialCalendarEvent:e}}),Z=Object(a.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_PARTIAL_CALENDAR_EVENT",function(e){return{partialCalendarEvent:e}}),J=Object(a.action)("CALENDAR_EVENTS_REMOVE_FULL_CALENDAR_EVENT",function(e,t){return{folderId:e,eventKey:t}}),Y=Object(a.action)("CALENDAR_EVENTS_REMOVE_ALL_FULL_CALENDAR_EVENTS_INFO_FOR_CACHE",function(e){return{folderId:e}}),Q=Object(a.action)("ADD_CALENDAR_EVENTS_TO_EVENTS_CACHE",function(e,t,n){return void 0===n&&(n=!1),{folderId:e,calendarEvents:t,forceReplace:n}}),X=Object(a.action)("ADD_CALENDAR_EVENTS_WITHING_CURRENT_LOCKED_DATE_RANGES",function(e,t){return{folderId:e,calendarEvents:t}}),$=Object(a.action)("REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",function(e,t){return{folderId:e,instanceKey:t}}),ee=Object(a.action)("INTERNAL_REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",function(e,t,n){return{folderId:e,instanceKey:t,onEventsRemoved:n}}),te=Object(a.action)("REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",function(e,t){return{folderId:e,predicate:t}}),ne=Object(a.action)("INTERNAL_REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",function(e,t,n){return{folderId:e,predicate:t,onEventsRemoved:n}}),re=Object(a.action)("CALENDAR_EVENTS_RELEASE_LOCK",function(e){return{lockId:e}}),ae=Object(a.action)("RELEASE_LOCK",function(e){return{lockId:e}}),ie=Object(a.action)("CALENDAR_EVENTS_IN_EVENTS_CACHE_RELOADED",function(e,t,n){return void 0===n&&(n=!1),{folderId:e,eventsReloaded:t,forceReload:n}}),oe=Object(a.action)("CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}}),ce=Object(a.action)("INTERNAL_CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}}),ue=Object(a.action)("INTERNAL_DELETE_EVENTS_CACHE",function(e){return{folderId:e}}),se=Object(a.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_WAS_USED",function(e,t){return{lockId:e,eventKey:t}}),de=Object(a.action)("UpdateItem",function(e,t){return{existingItem:e,updatedItem:t}}),le=n(1264),fe=n(1454),ve=n(1495),pe=n(5),_e=n(49),be=Object(a.action)("calendarEventsRemoved",function(e){return{eventsRemoved:e}}),Ie=Object(a.action)("calendarEventsAdded",function(e){return{eventsAdded:e}}),me=Object(a.action)("calendarEventUpdated",function(e){return{eventUpdated:e}}),ye=Object(a.action)("calendarEventsRemovedMatchedFilter",function(e){return{removePredicate:e}}),Oe=Object(a.action)("cacheReloaded",function(e,t){return{previousEvents:e,reloadedEvents:t}}),ge=Object(a.action)("deleteEventsCache",function(e){return{folderId:e}}),he=Object(a.action)("loadingCalendarEvents",function(e,t,n){return Object(_e.b)({name:"CalendarLoadState",customData:{loadingState:n},options:{isVerbose:!0}},{lockId:e,calendarId:t,loadingState:n})}),je=Object(a.action)("instantCalendarEventCreate",function(e,t,n,r,a,i,o){return void 0===r&&(r=function(){}),void 0===a&&(a=void 0),void 0===i&&(i=Object(pe.a)(fe.a)),void 0===o&&(o=function(){}),{eventToCreate:e,actionToExecute:t,onEventCreatedSuccess:n,onEventCreatedFailed:r,actionSource:a,errorMessage:i,onEventCreatedLocally:o}}),Ee=Object(a.action)("instantCalendarEventUpdate",function(e,t,n,r,a,i,o,c,u){return void 0===i&&(i=function(){}),void 0===o&&(o=void 0),void 0===c&&(c=Object(pe.a)(le.a)),void 0===u&&(u=function(){}),{eventId:e,eventChanges:t,eventScope:n,actionToExecute:r,onEventUpdateSuccess:a,onEventUpdateFailed:i,actionSource:o,errorMessage:c,onEventUpdatedLocally:u}}),Re=Object(a.action)("instantCalendarEventDelete",function(e,t,n,r,a,i,o,c,u,s){return void 0===i&&(i=function(){}),void 0===o&&(o=void 0),void 0===c&&(c=Object(pe.a)(ve.a)),void 0===u&&(u=!1),void 0===s&&(s=function(){return Promise.resolve(!1)}),{eventId:e,eventScope:t,dataPoint:n,actionToExecute:r,onEventDeleteSuccess:a,onEventDeleteFailed:i,actionSource:o,errorMessage:c,responseSent:u,asyncUndoAction:s}}),Te=n(71),Ae=n(164);function Ce(e){if(0===e.length)return[];var t=[];return e.forEach(function(e){return function(e,t){for(var n=!1,r=0;r<t.length&&!n;r++){var a=t[r];0===Object(u.j)(a,e,!0)&&(t[r]=Object(u.f)(a,e),n=!0)}n||t.push(e)}(e,t)}),t}function Se(e,t){var n=c().calendarFolderEvents.get(e);return n?n.events.filter(t):[]}function Fe(e,t){return void 0===t&&(t=null),t?Object(r.__read)(Se(t,function(t){return t.ItemId.Id===e}),1)[0]||null:ke(function(t){return t.ItemId.Id===e})}function Ne(e,t){return void 0===t&&(t=null),t?Object(r.__read)(Se(t,function(t){return t.Key===e}),1)[0]||null:ke(function(t){return t.Key===e})}function Pe(e,t,n){var a=null;return a=e?function(e,t,n){var a=c().calendarFolderEvents.get(e);if(a){var i=Object(r.__read)(w([t],n,a),1),o=i[0];return o||null}return null}(e,t,n):function(e,t){for(var n=c(),a=Object(r.__spread)(n.calendarFolderEvents.keys()),i=0;i<a.length;i++){var o=a[i],u=n.calendarFolderEvents.get(o),s=Object(r.__read)(u?w([e],t,u):[null],1),d=s[0];if(d)return d}return null}(t,n),E({lockId:n,updateMessage:"Got "+(a?"1":"no")+" item from the cache for given folder and key"}),a}function ke(e){for(var t=c(),n=Object(r.__spread)(t.calendarFolderEvents.keys()),a=0;a<n.length;a++){var i=n[a],o=t.calendarFolderEvents.get(i),u=Object(r.__read)(o?o.events.filter(e):[null],1)[0];if(u)return u}return null}var De=n(151),we=n(210),xe=n(744),Le=n(855),Me=n(246),Ue=n(1742),Ke=n.n(Ue),qe=n(745),Be=n.n(qe),Ve=n(1743),He=n.n(Ve),ze=n(191);function We(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n={Header:Object(ze.getJsonRequestHeader)(),Body:Ke()({EventId:Be()({Id:e.Id}),WindowStart:Object(y.qb)(t.start),WindowEnd:Object(y.qb)(t.end),ReturnMaster:!0,ReturnRegularOccurrences:!0,ReturnExceptions:!0,ReturnCancellations:!0,IncludeDeclinedMeetings:Object(j.f)("cal-surface-declinedMeetings")})},a=He.a,i=[n],[4,Object(Me.e)(e.mailboxInfo)];case 1:return[4,a.apply(void 0,i.concat([r.sent()]))];case 2:return[2,r.sent().Body]}})})}var Ge=n(1718),Ze=function(e){Object(j.f)("cal-notificationDiagnostics")&&setTimeout(function(){return Object(Ge.a)(e)},0)},Je=n(826),Ye=n(909);function Qe(e,t,n){var r=function(e,t,n){var r=n&&n.locksInfo.get(t)?n.locksInfo.get(t).lockedDateRange:null;if(null!=r&&Object(u.c)(r,e,!0)){var a=k(e,n.events);if(Object(D.d)("debugEventsCache")){var i=a?a.length:"no";E({lockId:t,updateMessage:"Returning "+i+" items from cache for date range: "+e.start+" - "+e.end})}return a}return null}(n,e,K(t));return(r||[]).filter(function(e){return!Object(xe.H)(e.CalendarItemType)})}var Xe=n(1319),$e=n(131),et=n(271);function tt(e,t,n,a){if(a=a||Object($e.e)(),!n){var i=M(t);i&&i.length>0&&(n=i.sort(function(e,t){var n=Object(u.l)(e),r=Object(u.l)(t);return n>r?-1:n<r?1:0})[0])}var o=Object(Xe.a)(),c=function(e,t){var n=Object(y.jc)(e),r=nt(n,Object(y.Bb)(t.start));return Object(u.r)(t,r)?r:nt(n,Object(y.Bb)(t.end))}(e.Birthday,n),s=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},o),e),{Subject:e.Name,Start:c,End:Object(y.e)(c,1),IsAllDayEvent:!0,ParentFolderId:{Id:t,mailboxInfo:a},ItemId:{Id:e.Id.Id,mailboxInfo:a},PersonId:e.PersonId,EffectiveRights:{Delete:!0,Modify:!0,Read:!0},FreeBusyType:"Free",ReminderIsSet:e.PopupReminderSettings[0].IsReminderSet,ReminderMinutesBeforeStart:e.PopupReminderSettings[0].ReminderMinutesBeforeStart,InboxReminders:e.EmailReminderSettings});return s||null}function nt(e,t){var n=Object(y.wb)(e),r=Object(y.lb)(e),a=Object(et.a)(t,n),i=Math.min(r,a);return Object(y.jc)(t,n,i)}function rt(e,t,n){return function(r){if(!at(r)||r.ParentFolderId.Id!==e)return!1;var a=function(e,t){return function(n){return at(n)&&n.ParentFolderId.Id===e&&n.ItemId.Id===t}}(r.ParentFolderId.Id,r.ItemId.Id);return n?t.some(a):!t.some(a)}}function at(e){var t,n;return(null===(n=null===(t=e)||void 0===t?void 0:t.ItemId)||void 0===n?void 0:n.Id)&&e.ParentFolderId&&e.ParentFolderId.Id}var it=n(308),ot=n(1744),ct=n.n(ot),ut=n(1745),st=n.n(ut);function dt(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return a=st.a,i=[{Header:Object(ze.getJsonRequestHeader)(),Body:ct()({StartRange:Object(y.qb)(e),EndRange:Object(y.qb)(t)})}],[4,Object(Me.e)(n.mailboxInfo)];case 1:return[4,a.apply(void 0,i.concat([r.sent()]))];case 2:return[2,r.sent().Body]}})})}var lt=n(1687);function ft(e,t,n,a){return void 0===a&&(a=0),Object(r.__awaiter)(this,void 0,void 0,function(){var i,o,c,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(i=Object(De.o)())&&i.addCustomData({outOfCacheRange:!0}),o=Object(we.t)(t),n(o,"Loading"),Object(we.D)(t)?3!=(c=Object(we.n)(t)).CalendarFolderType?[3,2]:[4,_t(e,o,t,n,a)]:[3,5];case 1:return[2,r.sent()];case 2:return[4,pt(e,o,t,n,o.mailboxInfo.type==$e.a.GroupMailbox?o.mailboxInfo.primarySmtpAddress:null,a)];case 3:return[2,r.sent()];case 4:return[3,8];case 5:return c=Object(we.k)({id:o}),Object(we.F)(c)?(u=Object(we.o)({id:{id:c.ItemId.Id,mailboxInfo:o.mailboxInfo}}),[4,vt(t,u,c,e,o,n,a)]):[3,7];case 6:return[2,r.sent()];case 7:return n(o,"Failed"),[2,null];case 8:return[2]}})})}function vt(e,t,n,a,i,o,c){return void 0===c&&(c=0),Object(r.__awaiter)(this,void 0,void 0,function(){var u,s,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(!t&&null==n.SharedFolderId||n.hasOwnProperty("OwnerEmailAddress")&&!n.IsGroupMailboxCalendar&&t&&!t.EffectiveRights||t&&(!t.EffectiveRights||!t.EffectiveRights.Read)&&n.IsGeneralScheduleCalendar))return[3,7];r.label=1;case 1:if(!(c>=0))return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Object(it.b)(a.start,a.end,[n.OwnerEmailAddress],"DetailedMerged",null,i.mailboxInfo)];case 3:return"NoError"==(u=r.sent()).ResponseCode?(o(i,"Loaded"),function(e,t){var n=K(e);if(n){var r=B(n.events,[t]).eventsOverlapping;te(e,rt(e,r,!0))}}(e,a),function(e){var t=K(e),n=t?t.events:[];ye(rt(e,n,!1))}(e),[2,u.Responses[0].CalendarView.Items.map(function(e){return Object(Le.a)(e,i.mailboxInfo)})]):(c--,[3,5]);case 4:return s=r.sent(),S.d.warn("[loadCalendarEventsInDateRange:loadCalendarEventsUsingFolderId: Exception occured: "+s),s.message&&(s.message.indexOf("ErrorApiQuarantined")>=0||s.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(o(i,"Throttled"),[2,null]):(c--,[3,5]);case 5:return[3,1];case 6:return o(i,"Failed"),[2,null];case 7:return d=t?t.FolderId.Id:n.SharedFolderId.Id,[4,pt(a,i,d,o,n.OwnerEmailAddress,c)];case 8:return[2,r.sent()]}})})}function pt(e,t,n,a,i,o){return void 0===o&&(o=0),Object(r.__awaiter)(this,void 0,void 0,function(){var c,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(o>=0))return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(lt.a)(e.start,e.end,n,t,i,Object(j.f)("cal-surface-declinedMeetings"))];case 2:return"NoError"==(c=r.sent()).ResponseCode?(a(t,"Loaded"),[2,c.Items.map(function(e){return Object(Le.a)(e,t.mailboxInfo)})]):(o--,[3,4]);case 3:return u=r.sent(),S.d.warn("[loadCalendarEventsInDateRange:getCalendarView: Exception occured: "+u),u.message&&(u.message.indexOf("ErrorApiQuarantined")>=0||u.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(a(t,"Throttled"),[2,null]):(o--,[3,4]);case 4:return[3,0];case 5:return a(t,"Failed"),[2,null]}})})}function _t(e,t,n,a,i){return void 0===i&&(i=0),Object(r.__awaiter)(this,void 0,void 0,function(){var o,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(i>=0))return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,dt(e.start,e.end,t)];case 2:return"NoError"==(o=r.sent()).ResponseCode?(a(t,"Loaded"),[2,o.BirthdayEvents.map(function(r){return tt(r,n,e,t.mailboxInfo)})]):(i--,[3,4]);case 3:return c=r.sent(),S.d.warn("[loadCalendarEventsInDateRange:getBirthdayCalendarView: Exception occured: "+c),c.message&&(c.message.indexOf("ErrorApiQuarantined")>=0||c.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(a(t,"Throttled"),[2,null]):(i--,[3,4]);case 4:return[3,0];case 5:return a(t,"Failed"),[2,null]}})})}var bt=3,It=1,mt={};function yt(e){mt[e]||(mt[e]=[])}function Ot(e,t){yt(e);for(var n=mt[e],r=0;r<n.length;r++)if(Object(u.c)(n[r].dateRange,t,!0))return{index:r,info:n[r]};return{index:-1,info:null}}function gt(e,t,n){var a=function(e,t){var n=c().calendarFolderEvents.get(t);return n?n.locksInfo.get(e):null}(e,t);if(a&&a.lockedDateRange&&Object(u.c)(a.lockedDateRange,n,!0)){var i=Object(we.t)(t);he(e,i,"Loaded");var o=Qe(e,t,n);return{fetchPromise:Promise.resolve(o),events:o}}var s=function(e,t){var n=M(e),a=K(e);return n.some(function(e){return Object(u.c)(e,t,!0)})&&a?k(t,a.events).map(function(e){return Object(r.__assign)({},e)}):null}(t,n);if(s){var d=ht(e,t,n,Promise.resolve(s),"existing");return d.then(function(n){var r=Object(we.t)(t);he(e,r,"Loaded")}),{fetchPromise:d,events:s}}var l=Ot(t,n).info;if(l)return l.lockIds.push(e),{fetchPromise:ht(e,t,n,l.requestPromise.then(function(e){return e?e.filter(function(e){var t=e.Start,r=e.End;return 0==Object(u.j)(n,{start:t,end:r},!0)}):[]}),"new"),events:null};!function(e,t,n){yt(t),mt[t].push({dateRange:n,requestPromise:null,lockIds:[e]})}(e,t,n);var f=function(e,t,n){var a=this;return Object(r.__awaiter)(a,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,,2,3]),[4,ft(t,e,n,It)];case 1:return[2,r.sent()];case 2:return function(e,t){var n=Ot(e,t).index;-1!==n&&mt[e].splice(n,1)}(e,t),[7];case 3:return[2]}})})}(t,n,function(e,t){return function(n,r){var a=Ot(e,t),i=a.index,o=a.info;-1!==i&&o.lockIds.forEach(function(e){he(e,n,r)})}}(t,n));return function(e,t,n){var r=Ot(e,t);r&&(r.info.requestPromise=n)}(t,n,f),{fetchPromise:ht(e,t,n,f,"new"),events:null}}function ht(e,t,n,a,i){return Object(r.__awaiter)(this,void 0,void 0,function(){var o,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,a];case 1:return o=r.sent(),c=o?o.length:"no",E({lockId:e,updateMessage:"Fetched "+c+" "+i+" items for date range: "+n.start+" - "+n.end}),o&&oe(e,t,n,o),[2,o]}})})}function jt(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i;return Object(r.__generator)(this,function(o){switch(o.label){case 0:return n=function(e){var t=function(e){return yt(e),mt[e].map(function(e){return e.dateRange})}(e),n=M(e);return Ce(Object(r.__spread)(t,n))}(e),a=n.map(function(t){return ft(t,e,function(e,t){return function(n,r){U(e,t).forEach(function(e){he(e,n,r)})}}(e,t),It)}),[4,Promise.all(a)];case 1:return(i=o.sent())?(i.forEach(function(n){n&&(ie(e,n,t),n.forEach(function(e){return G(e)}))}),[2,i.reduce(function(e,t){return t&&e.push.apply(e,Object(r.__spread)(t)),e},[])]):[2,null]}})})}function Et(e,t,n,a){void 0===a&&(a=!1);var i=e.ParentFolderId.Id,o=!1,c=function(e,t,n){var a,i,o=null;if(n)o=Fe(t.ItemId.Id,e);else{a=Object(r.__read)(Se(e,function(e){return e.InstanceKey==t.InstanceKey}),1),o=a[0]}if(!o){var c=t.ClientSeriesId;if(c){i=Object(r.__read)(Se(e,function(e){return e.ClientSeriesId==c}),1),o=i[0]}}return o}(i,e,t);c?c.IsRecurring&&!t?a?be([c]):o=!0:be([c]):S.d.info("[SharedCacheFunctions] addOrModifyItemInCache: Skipping removal of old item from cache as no old item was found"),!c&&n||(o||X(i,[e]),a?G(e):Z(e))}function Rt(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,jt(e,t)];case 1:return n.sent(),[2]}})})}function Tt(){var e;(e=c(),Object(r.__spread)(e.calendarFolderEvents.keys())).map(function(e){return jt(e)})}var At=Object(a.action)("CALENDAR_EVENTS_CLEAR_ALL_FULL_CALENDAR_EVENTS",function(){return{}});function Ct(){At(),Tt()}var St=n(1655),Ft=864e5;var Nt,Pt={RowAdded:"RowAdded",RowModified:"RowModified",RowDeleted:"RowDeleted",Reload:"Reload"},kt=2e3,Dt={},wt={},xt=[],Lt=!0,Mt=!0;function Ut(e,t){if(Mt&&(Object(St.b)(Ct,"RELOAD_CALENDAR_SUBSCRIPTIONS",Ft),Mt=!1),Dt[e])return Dt[e].locks[t]=!0,void Ze({message:"Already subscribed to calendar item notifications for folder",folderId:e});var n=Object(we.n)(e);if(n){var a=function(e){if(e.IsGroupMailboxCalendar)return Object(j.f)("cal-groupNotifications")?{MailboxId:e.OwnerEmailAddress}:null;var t=e.CalendarFolderId;if(t){var n=e.id.mailboxInfo.primarySmtpAddress;return Object(Te.t)(n)?{FolderId:t.Id}:Object(Ae.g)(n)?{FolderId:t.Id,MailboxId:n,MailboxType:Object(Ae.h)(n)?2:3}:null}return null}(n);if(a){var i=Object(j.f)("cal-surface-declinedMeetings");Ye.b.import().then(function(n){var o,c=Object(r.__assign)(Object(r.__assign)({},a),{ChannelId:n(),NotificationType:"CalendarItemNotification",IncludeDeclinedMeetings:i}),u={subscriptionId:""+c.NotificationType+e+(i?"declinedMeetings":""),requiresExplicitSubscribe:!0,subscriptionParameters:c},s={folderId:e,subscription:u,locks:(o={},o[t]=!0,o)};Ze({message:"Subscribing to calendar item notifications for folder with includeDeclinedMeetings = "+i,folderId:e}),Ye.g.importAndExecute(u,Kt),Dt[e]=s})}}else Ze({message:"Calendar entry not found to subscribe to notifications for folder",folderId:e})}function Kt(e){Vt(e,!0),function(e){if(xt.some(function(e){return Ht(e.NotificationPayload)}))Ze({message:"A reload notification is in the queue. No additional notifications will be added",notificationPayload:e.NotificationPayload});else if(Ht(e.NotificationPayload))Ze({message:"A reload notification will be enqueued. All existing notifications will be discarded.",notificationPayload:e.NotificationPayload}),(xt=[])[0]=e;else{for(var t=xt.length-1;t>=0;t--){var n=xt[t].NotificationPayload.Item,r=void 0,a=void 0,i=void 0;if(null!=e.NotificationPayload.Item.InstanceKey?(a=e.NotificationPayload.Item.InstanceKey,r=n.InstanceKey,i="InstanceKey"):(a=e.NotificationPayload.Item.ItemId.Id,r=n.ItemId.Id,i="ItemId"),a===r){Ze({message:"Found an existing notification in the queue for the same "+i+". Old notification will be removed.",notificationPayload:e.NotificationPayload}),xt[t].InstanceKeyToDelete&&(e.InstanceKeyToDelete=xt[t].InstanceKeyToDelete),xt.splice(t,1);break}}var o=!1;if(null!=e.NotificationPayload.Item.InstanceKey)if(e.NotificationPayload.EventType==Pt.RowModified&&Object(xe.H)(e.NotificationPayload.Item.CalendarItemType)&&null!=e.NotificationPayload.Item.UID&&(wt[e.NotificationPayload.Item.InstanceKey]=e.NotificationPayload.Item.UID),e.NotificationPayload.EventType===Pt.RowAdded||e.NotificationPayload.EventType===Pt.RowModified){for(var t=xt.length-1;t>=0;t--)if(xt[t].NotificationPayload.EventType===Pt.RowDeleted&&xt[t].OriginalUID==e.NotificationPayload.Item.UID){Ze({message:"Found an existing RowDeleted notification in the queue for the same UID, which will be removed from the queue.",notificationPayload:e.NotificationPayload}),e.InstanceKeyToDelete=xt[t].NotificationPayload.Item.InstanceKey,xt.splice(t,1);break}}else if(e.NotificationPayload.EventType===Pt.RowDeleted){var c=wt[e.NotificationPayload.Item.InstanceKey];if(delete wt[e.NotificationPayload.Item.InstanceKey],c){e.OriginalUID=c;for(var t=xt.length-1;t>=0;t--){var u=xt[t].NotificationPayload.Item.UID;if((xt[t].NotificationPayload.EventType===Pt.RowAdded||xt[t].NotificationPayload.EventType===Pt.RowModified)&&u==c){Ze({message:"Found an existing RowAdded or RowModified notification in the queue for the same UID, which will be merged with the RowDelete.",notificationPayload:e.NotificationPayload}),xt[t].InstanceKeyToDelete=e.NotificationPayload.Item.InstanceKey,o=!0;break}}}}o?Ze({message:"RowDeleted notification was merged with a RowAdded notification for the same UID and will not be enqueued",notificationPayload:e.NotificationPayload}):(Ze({message:"Notification will be enqueued",notificationPayload:e.NotificationPayload}),xt.push(e))}Ze({message:"Notification queue length is "+xt.length})}({NotificationPayload:e,InstanceKeyToDelete:null,OriginalUID:null}),Lt?(Nt&&(Ze({message:"Notification processing timer was already started. It will be cancelled and restarted."}),clearTimeout(Nt)),Nt=setTimeout(Bt,kt),Ze({message:"Timer to drain queue has started"})):Ze({message:"The notification was received while notification processing was suspended"})}function qt(e){if(Vt(e.NotificationPayload,!1),Ht(e.NotificationPayload))zt();else{var t=e.NotificationPayload.FolderId,n=q(t),a=M(t),i=function(e){var t=K(e);return t?Object(r.__spread)(t.locksInfo.entries()).reduce(p(),{}):{}}(t),o=Object(we.n)(t),c=Object(we.y)(t);o&&3==o.CalendarFolderType?zt(t,!0):n&&(a.length>0||Object.keys(i).length>0)?e.NotificationPayload.EventType==Pt.RowDeleted?function(e,t){var n=t.Item.InstanceKey;$(e,n)}(t,e.NotificationPayload):Object(xe.H)(e.NotificationPayload.Item.CalendarItemType)?function(e,t,n){var r=Object(Le.a)(n.NotificationPayload.Item,t);if(r.UID){var a=M(e),i=Ce(a);i.forEach(function(a){var i=We(r.ItemId,a);i.then(function(o){o&&"Success"==o.ResponseClass?function(e,t,n,r,a,i,o){Ze({message:"Action to expand series completed successfully. Retrieved "+(a?a.length:0)+" items.",folderId:r,notificationItem:e}),M(r).some(function(e){return Object(u.b)(n,e)})?(Gt(a,n,e.ItemId.Id,e.InstanceKey,o,r),G(i),X(r,a),a.forEach(function(e){G(e)})):Rt(r)}(r,0,a,e,o.Occurrences.map(function(e){return Object(Le.a)(e,t)}),Object(Le.a)(o.RecurrenceMaster,t),n.InstanceKeyToDelete):Wt(r,i,a,e,n.InstanceKeyToDelete,o)}).catch(function(t){Wt(r,i,a,e,n.InstanceKeyToDelete,null,t.message)})})}}(t,c,e):function(e,t,n){var r=Object(Le.a)(n.Item,t),a=!1;switch(n.EventType){case Pt.RowAdded:a=!0;break;case Pt.RowModified:a=null==r.InstanceKey||Object(xe.E)(r.CalendarItemType)||Object(xe.y)(r.CalendarItemType)}Et(r,a,!1,!0)}(0,c,e.NotificationPayload):Ze({message:n?"Events cache was empty for folder":"Events cache has not been loaded for folder yet",folderId:e.NotificationPayload.FolderId,notificationPayload:e.NotificationPayload})}}function Bt(){var e=xt.length;if(e>=8||xt.some(function(e){return Ht(e.NotificationPayload)}))zt();else for(var t=0;t<e;t++){qt(xt[t])}xt=[],wt={},clearTimeout(Nt)}function Vt(e,t){var n,r=(null===(n=e.Item)||void 0===n?void 0:n.ItemId)?e.Item.ItemId.Id:"<null>";if(Ze({message:(t?"Got calendar notification":"Processing calendar notification")+" for event type "+e.EventType,folderId:e.FolderId,notificationPayload:e}),t){var a=e.Item?e.Item.CalendarItemType:"<null>";Object(De.m)("IncomingNotification",{NotificationType:e.EventType,ItemType:a,ItemId:r},{isCosmosDatapoint:!0})}}function Ht(e){return e.EventType==Pt.Reload||e.Reload}function zt(e,t){var n,a;void 0===t&&(t=!1);var i=e?[e]:Object.keys(Dt);try{for(var o=Object(r.__values)(i),c=o.next();!c.done;c=o.next()){Rt(c.value,t)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}}function Wt(e,t,n,r,a,i,o){if(void 0===o&&(o=null),i&&"ErrorItemNotFound"==i.ResponseCode)Ze({message:"Action to expand recurring series failed with item not found because item is not on the server. Removing series.",folderId:r,notificationItem:e}),Gt(void 0,n,e.ItemId.Id,e.InstanceKey,a,r);else{var c=i?i.ResponseCode+": "+i.MessageText:o;Ze({message:"Action to expand recurring series failed for unknown reason, reloading cache",folderId:r,notificationItem:e,errorMessage:c}),Rt(r)}}function Gt(e,t,n,r,a,i){var o=e?e.map(function(e){return e.UID}):void 0,c=function(e){var i={start:e.Start,end:e.End};return 0==Object(u.j)(t,i,!0)&&(e.InstanceKey==r||a&&e.InstanceKey==a||Object(Je.c)(e)||e.SeriesMasterItemId.Id===n||o.includes(e.UID))};te(i,c);var s=Se(i,c);be(s)}function Zt(){Lt&&(clearTimeout(Nt),Ze({message:"Processing of notifications will be suspended"}),Lt=!1)}function Jt(){Lt||(Lt=!0,Ze({message:"Processing of notifications will be resumed"}),Nt=setTimeout(Bt,kt))}Object(a.orchestrator)(Oe,function(e){var t=e.previousEvents,n=e.reloadedEvents;n&&(t&&be(t),Ie(n))}),Object(a.orchestrator)(te,function(e){var t=e.folderId,n=e.predicate,r=null;ne(t,n,function(e){r=e}),r&&(r.forEach(function(e){return J(t,e.Key)}),be(r))}),Object(a.orchestrator)($,function(e){var t=e.folderId,n=e.instanceKey,r=null;ee(t,n,function(e){r=e}),r&&(r.forEach(function(e){return J(t,e.Key)}),be(r))}),Object(a.orchestrator)(oe,function(e){var t=e.lockId,n=e.folderId,r=e.dateRange,a=e.calendarEvents;ce(t,n,r,a),a&&Ie(a)}),Object(a.orchestrator)(X,function(e){var t=e.folderId,n=B(e.calendarEvents,M(t)).eventsOverlapping;n.length>0&&(Q(t,n),Ie(n))}),Object(a.orchestrator)(ie,function(e){var t=e.folderId,n=e.eventsReloaded,a=e.forceReload,i=function(e){var t=K(e);return t?Object(r.__spread)(t.events):[]}(t);Q(t,n,a),Oe(i,n)}),Object(a.orchestrator)(ge,function(e){var t=e.folderId;!function(e){var t=Dt[e];t?(Ze({message:"Unsubscribing from calendar item notifications for folder",folderId:e}),Ye.h.importAndExecute(t.subscription,Kt),delete Dt[e]):Ze({message:"Could not unsubscribe calendar item notifications for folder due to subscription data not found",folderId:e})}(t),Y(t),ue(t)});var Yt=n(1662),Qt=n(1004),Xt=n(192);function $t(e,t){var n=function(e){return Object(Qt.d)(e)?en:Object(Qt.h)(e)?tn:Object(Qt.e)(e)?nn:(Object(Qt.i)(e),null)}(e.Recurrence);if(!n)return[Object(r.__assign)({},e)];var a=Ce(t),i=[],o=e.Recurrence.RecurrencePattern.Interval;a.forEach(function(t){var a=function(e,t){var n=Object(y.Vb)(e.Start),r=Object(Yt.a)(n.tz,e.Recurrence),a={start:n,end:r};return i=a,o=t,i.start=Object(y.p)(i.start,o.start)>0?i.start:o.start,i.end=null!=i.end&&Object(y.p)(i.end,o.end)<0?i.end:o.end,a;var i,o}(e,t),c=n(e,a,o);i.push.apply(i,Object(r.__spread)(c))});var c=Object(y.x)(e.Start,Object(y.Vb)(e.Start)),u=Object(y.x)(e.End,Object(y.Vb)(e.Start));return function(e,t,n,r){var a=[];return r.forEach(function(r){var i={};Xt(i,e),i.Start=Object(y.h)(r,t),i.End=Object(y.h)(r,n),i.CalendarItemType="Occurrence",a.push(i)}),a}(e,c,u,i)}function en(e,t,n){for(var r=[],a=Object(y.s)(t.end,t.start),i=0;i<=a;i+=n){var o=Object(y.e)(t.start,i);r.push(o)}return r}function tn(e,t,n){for(var r=[],a=e.Recurrence.RecurrencePattern,i=a.DaysOfWeek.split(" ").map(function(e){return rn(e)}),o=Math.max(rn(a.FirstDayOfWeek),0),c=t.start;Object(y.p)(c,t.end)<=0;){for(var s=c,d=Object(y.C)(s,o);Object(y.p)(s,d)<=0;)i.includes(Object(y.nb)(s))&&Object(u.r)(t,s)&&r.push(s),s=Object(y.e)(s,1);c=Object(y.Zb)(Object(y.e)(c,7*n),o)}return r}function nn(e,t,n){var r=[];if(Object(Qt.b)(e.Recurrence))for(var a=(s=e.Recurrence.RecurrencePattern).DayOfMonth,i=t.start;Object(y.p)(i,t.end)<=0;){for(var o=i,c=Object(y.B)(o);Object(y.p)(o,c)<=0;)Object(y.lb)(o)==a&&Object(u.r)(t,o)&&r.push(o),o=Object(y.e)(o,1);i=Object(y.Yb)(Object(y.i)(i,n))}else{var s,d=rn((s=e.Recurrence.RecurrencePattern).DaysOfWeek),l=-1;switch(s.DayOfWeekIndex){case"First":l=1;break;case"Second":l=2;break;case"Third":l=3;break;case"Fourth":l=4}for(i=t.start;Object(y.p)(i,t.end)<=0;){var f=void 0;f=l>0?an(d,l,i):on(d,i),Object(u.r)(t,f)&&r.push(f),i=Object(y.Yb)(Object(y.i)(i,n))}}return r}function rn(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(e)}function an(e,t,n){var r=Object(y.Yb)(n),a=(e-Object(y.nb)(r)+7)%7+7*(t-1);return Object(y.e)(r,a)}function on(e,t){var n=an(e,5,t);return Object(y.wb)(n)==Object(y.wb)(t)?n:an(e,4,t)}function cn(e,t){if(t){var n=e.ParentFolderId.Id;e.Recurrence?te(n,function(t){return t.InstanceKey==e.InstanceKey}):te(n,function(t){return t.ItemId.Id===e.ItemId.Id})}}Object(a.orchestrator)(je,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,i,o,c,u,s,d,l,f,v;return Object(r.__generator)(this,function(p){switch(p.label){case 0:t=e.eventToCreate,n=e.actionToExecute,a=e.actionSource,i=e.onEventCreatedFailed,o=e.onEventCreatedSuccess,c=e.errorMessage,u=e.onEventCreatedLocally,s=q(t.ParentFolderId.Id),function(e,t,n,a){if(t){var i=e.ParentFolderId.Id;if(e.Recurrence){var o=M(i),c=$t(e,o);Object(Je.a)(c.concat(e));var u=c.map(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{CalendarItemType:"Occurrence"})});return void X(i,u)}Object(Je.b)(e),X(i,[e])}n(a)}(t,s,u,a),d=function(){return je(t,n,function(){return i(c,null,a)},o,a,c)},l=null,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,n(t)];case 2:return l=p.sent(),[3,4];case 3:throw f=p.sent(),cn(t,s),i(f,d,a),f;case 4:if(v=null,!l.isSuccessful)throw cn(t,s),i(c,d,a),c;return v=l.createdItem,function(e,t,n){t.ParentFolderId||(t.ParentFolderId=Object(r.__assign)({},e.ParentFolderId));if(n){if(t.Recurrence)return;var a=t.ParentFolderId.Id;te(a,function(t){return t.ItemId.Id===e.ItemId.Id}),Et(t,!0,!1)}}(t,v,s),o(v),[2]}})})});var un=n(192);function sn(e,t){var n={Key:e,Start:t.Start,End:t.End};return un(t,n),t}function dn(){return pn.get()}function ln(e){return dn()[e]||null}function fn(e,t){var n=c().fullItemsMruMap.get(e);return n&&Object(r.__read)(n.eventInfos.filter(function(e){return e.eventKey===t}),1)[0]||null}function vn(e){var t=ln(e);return t?t.loadState:null}var pn=Object(i.computed)(function(){var e=c();return Object(r.__spread)(e.fullItemsMruMap.keys()).reduce(function(t,n){return e.fullItemsMruMap.get(n).eventInfos.forEach(function(e){return t[e.eventKey]=e}),t},{})});var _n=n(15),bn=n(192);function In(e){if(e){var t=c();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,L())}}Object(a.mutator)(re,function(e){var t=e.lockId,n=c();Object(r.__spread)(n.calendarFolderEvents.keys()).forEach(function(e){n.calendarFolderEvents.get(e).locksInfo.get(t)&&function(e,t){m(b.All,e,t),t.locksInfo.delete(e)}(t,n.calendarFolderEvents.get(e))}),n.fullItemsMruMap.delete(t)}),Object(a.mutator)(W,function(e){var t=e.folderId,n=e.eventKey,r=e.event,a=Ne(n,t);a&&g(a,r,!0)}),Object(a.mutator)(Z,function(e){var t,n=e.partialCalendarEvent;if((t=n).Key&&void 0!==t.Start&&void 0!==t.End){n.Key;n=Object(r.__rest)(n,["Key"])}var a=Ne(Object(xe.H)(n.CalendarItemType)?n.InstanceKey:n.ItemId.Id,n.ParentFolderId.Id);a&&g(a,n)}),Object(a.mutator)(ce,function(e){var t=e.lockId,n=e.folderId,r=e.dateRange,a=e.calendarEvents;In(n);var i=K(n),o=dn();F(r,a.filter(function(e){return!Object(xe.H)(e.CalendarItemType)}).map(function(e){return sn(e.ItemId.Id,e)}).filter(function(e){return!o[e.Key]}),t,i);var c=i.locksInfo.get(t).lockedDateRange,u=Object(y.s)(c.end,c.start),s=Object(_n.e)()?42:110;u>s&&N(function(e,t,n){var r=Object(y.s)(t.end,t.start);if(r===n)return t;if(r>n)return{start:t.start,end:Object(y.e)(t.start,n)};var a=n-r,i=Math.abs(Object(y.s)(t.end,e.end)),o=Math.abs(Object(y.s)(e.start,t.start)),c=t.start,u=t.end;if(i>0){var s=Math.min(a,i);u=Object(y.e)(u,s),a-=s}if(a>0&&o>0){var d=Math.min(a,o);c=Object(y.e)(c,-1*d)}return{start:c,end:u}}(c,r,s),t,i)}),Object(a.mutator)(ee,function(e){var t=e.folderId,n=e.instanceKey,r=e.onEventsRemoved;In(t),r(P(function(e){return e.InstanceKey===n},K(t)))}),Object(a.mutator)(ne,function(e){var t=e.folderId,n=e.predicate,r=e.onEventsRemoved;In(t),r(P(n,K(t)))}),Object(a.mutator)(ue,function(e){var t=e.folderId;c().calendarFolderEvents.delete(t)}),Object(a.mutator)(Q,function(e){var t=e.folderId,n=e.calendarEvents,a=e.forceReplace;In(t);var i,o,c,u,s=n.map(function(e){return sn(e.ItemId.Id,e)}),d=K(t);a?(i=s,u=(o=d).events.length,(c=o.events).splice.apply(c,Object(r.__spread)([0,o.events.length],i)),E({lockId:"",updateMessage:"Replaced "+u+" items from cache with "+i.length+" items"})):R(s,d.events)}),Object(a.mutator)(de,function(e){bn(e.existingItem,e.updatedItem)});var mn=5;function yn(e,t,n,a){gn(t,n);var i=e.eventKey,o=n.get(t),c=o.eventInfos,u=Object(r.__read)(c.filter(function(e){return e.eventKey===i}),1)[0];u?hn(o.eventInfos.indexOf(u),e,o):(c.push(e),function(e,t){!function(e,t,n){for(;e.eventInfos.length>t&&0<e.eventInfos.length;)jn(0,e,n)}(e,mn,t)}(o,a))}function On(e,t,n,a){void 0===a&&(a=function(){}),gn(t,n);var i=n.get(t),o=Object(r.__read)(i.eventInfos.filter(function(t){return t.eventKey===e}),1)[0],c=i.eventInfos.indexOf(o);return-1!==c&&jn(c,i,a),-1!==c}function gn(e,t){t.get(e)||t.set(e,{eventInfos:[]})}function hn(e,t,n){if(-1===e)throw new Error("Item with eventKey "+t.eventKey+" does not exist in the MRU");n.eventInfos.splice(e,1),n.eventInfos.push(t)}function jn(e,t,n){if(e<0||e>=t.eventInfos.length)throw new Error("Invalid index to remove "+e);var r=t.eventInfos[e];t.eventInfos.splice(e,1),n(r.eventKey)}function En(e){if(e){var t=c();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,L())}}function Rn(e,t){return function(n){!function(e,t,n){if(0===e.length)return[];v(t,n);var a=n.locksInfo.get(t);e=e.filter(function(e){return a.lockedEvents[e]});var i=Object(r.__spread)(n.locksInfo.entries()).reduce(_(),[]),o=Object(r.__spread)(n.locksInfo.entries()).reduce(p(I(t)),{}),c=l(e,n.events,{dateRangesToRetain:i,eventsToRetain:o});e.forEach(function(e){delete a.lockedEvents[e]})}([n],e,c().calendarFolderEvents.get(t))}}Object(a.mutator)(V,function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,a=e.partialCalendarEvent;En(n);var i=c();a&&C(sn(t,a),r,i.calendarFolderEvents.get(n));yn({eventKey:t,folderId:n,loadState:0},r,i.fullItemsMruMap,Rn(r,n))}),Object(a.mutator)(H,function(e){var t=e.eventKey,n=e.folderId,r=e.lockId;En(n),yn({eventKey:t,folderId:n,loadState:2},r,c().fullItemsMruMap,Rn(r,n))}),Object(a.mutator)(z,function(e){var t=e.lockId,n=e.eventKey,r=e.folderId,a=e.event,i=e.eventScope,o=e.forceOverrideAllPropertiesForEventIfAvailable;En(r);var u=c(),s=3===i;C(sn(n,a),t,u.calendarFolderEvents.get(r),s,o),yn({eventKey:n,folderId:r,loadState:1},t,u.fullItemsMruMap,Rn(t,r))}),Object(a.mutator)(J,function(e){var t=e.folderId,n=e.eventKey,a=c();a.calendarFolderEvents.get(t)&&Object(r.__spread)(a.fullItemsMruMap.keys()).forEach(function(e){On(n,e,a.fullItemsMruMap)})}),Object(a.mutator)(Y,function(e){var t=e.folderId,n=c(),a=n.calendarFolderEvents.get(t);if(a){var i=Object(r.__spread)(a.locksInfo.entries()).reduce(p(),{}),o=Object.keys(i);Object(r.__spread)(n.fullItemsMruMap.keys()).forEach(function(e){o.forEach(function(t){return On(t,e,n.fullItemsMruMap)})})}}),Object(a.mutator)(At,function(){var e=c();Object(r.__spread)(e.fullItemsMruMap.keys()).forEach(function(t){!function(e,t){gn(e,t),t.get(e).eventInfos=[]}(t,e.fullItemsMruMap)})}),Object(a.mutator)(se,function(e){var t=c(),n=e.lockId;!function(e,t,n){gn(t,n);var a=n.get(t),i=a.eventInfos,o=Object(r.__read)(i.filter(function(t){return t.eventKey===e}),1)[0];o&&hn(a.eventInfos.indexOf(o),o,a)}(e.eventKey,n,t.fullItemsMruMap)});var Tn=n(1164),An=n.n(Tn);function Cn(e,t){var n,r;if(3==t){var a=Fe(e);r=(null===(n=a)||void 0===n?void 0:n.SeriesMasterItemId)?Be()({Id:a.SeriesMasterItemId.Id}):r=An()({OccurrenceId:e})}else r=Be()({Id:e});return r}function Sn(e,t){t&&Rt(e.ParentFolderId.Id)}Object(a.orchestrator)(Re,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,i,o,c,u,s,d,l,f,v,p,_,b;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.eventId,n=e.eventScope,a=e.dataPoint,i=e.actionToExecute,o=e.onEventDeleteSuccess,c=e.onEventDeleteFailed,u=e.responseSent,s=e.actionSource,d=e.errorMessage,l=e.asyncUndoAction,f=Fe(t.Id),v=(I=f)&&q(I.ParentFolderId.Id),function(e,t,n){if(n){var r=e.ParentFolderId.Id;if(3==t||2==t){var a=e.Start;te(r,function(n){return n.InstanceKey==e.InstanceKey&&(3==t||2==t&&!Object(y.Fb)(n.Start,a))})}else te(r,function(t){return t.ItemId.Id===e.ItemId.Id})}}(f,n,v),a&&a.markUserPerceivedTime(),p=Cn(t.Id,n),null,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,l(f,u,s)];case 2:return r.sent()?(Sn(f,v),[2]):[4,i(p)];case 3:if(!r.sent().isSuccessful)throw d;return[3,5];case 4:throw _=r.sent(),Sn(f,v),b=function(){return Re(t,n,null,i,o,function(){return c(_,null,s)},s,d,u)},c(_,b,s),_;case 5:return o(),[2]}var I})})});var Fn=n(1575),Nn=n.n(Fn),Pn=n(1576),kn=n.n(Pn),Dn=n(357),wn=n(789),xn=n(780);function Ln(e,t,n,a){var i;return void 0===n&&(n=0),void 0===a&&(a=void 0),Object(r.__awaiter)(this,void 0,void 0,function(){var o,c,u,s,d,l,f,v;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return o=e.Id,c=e.mailboxInfo,u=3==n||2==n,s=null,d=null,[4,Object(Me.e)(c)];case 1:(l=r.sent()||{}).datapoint={customData:{itemId:o,fetchingMasterItem:u},jsonCustomData:function(e){var t=e.Body.ResponseMessages.Items[0];return{responseClass:t.ResponseClass,responseCode:t.ResponseCode}}},r.label=2;case 2:return r.trys.push([2,,4,5]),[4,kn()({Header:Object(ze.getJsonRequestHeader)(),Body:Nn()({EventIds:[u?a?Be()({Id:a.Id}):An()({OccurrenceId:o}):Be()({Id:o})],ItemShape:t,IncludeDeclinedMeetings:Object(j.f)("cal-surface-declinedMeetings")})},l)];case 3:return s=r.sent(),null!=(f=s.Body.ResponseMessages.Items[0])&&"Success"==f.ResponseClass&&null!=(v=f.Items[0])&&(!function(e){e.Locations?e.Locations=e.Locations.filter(function(e){return e}):e.Locations=[],e.Resources&&e.Resources.map(function(t){Object(wn.c)(e.Locations,t.Mailbox.EmailAddress)||(e.Locations=e.Locations.filter(function(e){return e.DisplayName!==t.Mailbox.Name||Object(xn.p)(e.PostalAddress)}),e.Locations.push(Object(xn.e)(t.Mailbox.Name,t.Mailbox.EmailAddress)))})}(v),d=Object(Le.a)(v,e.mailboxInfo)),[3,5];case 4:return Object(j.f)("cal-mf-diagnostics")&&Object(Dn.a)({action:"GetCalendarEvent",status:"Error",response:null===(i=s)||void 0===i?void 0:i.Body}),[7];case 5:return[2,d]}})})}var Mn=n(1746),Un=n.n(Mn),Kn=n(1747),qn=n.n(Kn);var Bn=n(1008);function Vn(e,t,n,a){void 0===n&&(n=0),void 0===a&&(a=void 0);var i=Object(we.n)(t);return i&&3==i.CalendarFolderType?function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=e.Id,a=e.mailboxInfo,[4,Object(Me.e)(a)];case 1:return(i=r.sent()||{}).datapoint={customData:{itemId:n},jsonCustomData:function(e){var t,n,r,a;return{responseClass:null===(n=null===(t=e)||void 0===t?void 0:t.Body)||void 0===n?void 0:n.ResponseClass,responseCode:null===(a=null===(r=e)||void 0===r?void 0:r.Body)||void 0===a?void 0:a.ResponseCode}}},[4,qn()({Header:Object(ze.getJsonRequestHeader)(),Body:Un()({CalendarItemId:Be()({Id:n})})},i)];case 2:return null!=(o=r.sent()).Body&&"Success"==o.Body.ResponseClass&&null!=(c=o.Body.BirthdayEvent)?[2,tt(c,t,void 0,e.mailboxInfo)]:[2,null]}})})}(e,t):Ln(e,{BaseShape:"IdOnly",MaximumBodySize:0,BodyType:"HTML",InlineImageCustomDataTemplate:Bn.e,InlineImageUrlTemplate:Bn.f,AddBlankTargetToLinks:!0},n,a)}Object(a.orchestrator)(G,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=e.partialCalendarEvent,n=Object(xe.H)(t.CalendarItemType)?t.InstanceKey:t.ItemId.Id,a=t.ParentFolderId.Id,null===vn(t.ItemId.Id)?[3,2]:[4,Vn(t.ItemId,a)];case 1:(i=r.sent())&&W(a,n,i),r.label=2;case 2:return[2]}})})});Object(a.orchestrator)(Ee,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,i,o,c,u,s,d,l,f,v,p,_,b;return Object(r.__generator)(this,function(I){switch(I.label){case 0:t=e.eventId,n=e.eventChanges,a=e.errorMessage,i=e.actionToExecute,o=e.onEventUpdateFailed,c=e.onEventUpdateSuccess,u=e.onEventUpdatedLocally,s=e.actionSource,d=e.eventScope,l=Fe(t.Id),f=Cn(t.Id,e.eventScope),l&&Object(xe.H)(l.CalendarItemType)&&(d=3),(v=function(e,t){if(!e)return!1;var n=e.ParentFolderId.Id;if(!q(n))return!1;var r=t.ParentFolderId;if(r&&r.Id!=n)return!1;return!0}(l,n))&&function(e,t,n,a,i){var o,c,u=e.ParentFolderId.Id,s=Object(r.__assign)(Object(r.__assign)({},e),t);if(3==n||2==n)if(t.Recurrence||t.Start||t.StartTimeZoneId||t.End||t.EndTimeZoneId||2==n){var d=e.Start;if(te(u,function(t){return Object(xe.E)(t.CalendarItemType)&&t.InstanceKey==e.InstanceKey&&(3==n||2==n&&!Object(y.Fb)(t.Start,d))}),3==n){var l=M(u),f=$t(s,l);Object(Je.a)(f.concat(s));var v=f.map(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{CalendarItemType:"Occurrence"})});X(s.ParentFolderId.Id,v)}}else{var p=Se(u,function(t){return t.InstanceKey==e.InstanceKey&&Object(xe.E)(t.CalendarItemType)});try{for(var _=Object(r.__values)(p),b=_.next();!b.done;b=_.next()){var I=b.value,m=I;de(m,t),me(m)}}catch(e){o={error:e}}finally{try{b&&!b.done&&(c=_.return)&&c.call(_)}finally{if(o)throw o.error}}}if(!Object(xe.y)(e.CalendarItemType)||3!=n){var O=null==e.InstanceKey||Object(xe.E)(e.CalendarItemType)||Object(xe.y)(e.CalendarItemType);Et(s,O,!0)}a(s,i)}(l,n,d,u,s),p=function(){return Ee(t,n,d,i,c,function(){return o(a,null,s)},s,a)},_=null,I.label=1;case 1:return I.trys.push([1,3,,4]),[4,i(f)];case 2:return _=I.sent(),[3,4];case 3:throw b=I.sent(),v&&Rt(l.ParentFolderId.Id),o(b,p,s),b;case 4:if(!_.isSuccessful)throw v&&Rt(l.ParentFolderId.Id),o(a,p,s),a;return c(),[2]}})})});var Hn=n(98);Object(a.orchestrator)(Hn.k,Ct);function zn(e){var t=Object(we.t)(e),n=t&&Object(we.o)({id:t});return n?n.CharmId:null}function Wn(e){var t;return(null===(t=e)||void 0===t?void 0:t.CharmId)||zn(e.ParentFolderId.Id)}function Gn(e,t){return t||Object(xe.H)(e.CalendarItemType)?e.InstanceKey:e.ItemId.Id}function Zn(e,t,n){return{FreeBusyType:"Decline"===n?"Free":"Free"===e&&"Decline"!==t?"Free":"Accept"===n?"Busy":"Tentative",AppointmentReplyTime:Object(y.Ob)(),ResponseType:n}}var Jn=n(160),Yn={};function Qn(e){return Yn[e]||null}function Xn(e,t,n,a,i){var o,c,u,s;void 0===n&&(n=null),void 0===a&&(a=function(){return null}),void 0===i&&(i=0);var d,l=3===i,f=function(e,t){return function(n){var r,a=Fe(n.Id,e);return a||(null===(r=t)||void 0===r?void 0:r(n))}}(n,a),v=ln(t.Id);if(v)d=function(e,t,n,a,i){var o=i(t),c=3==a;if(o&&c)return $n(e,o);if(!o&&c)return null;switch(n.loadState){case 1:return{event:o,fullEventPromise:Promise.resolve(o),promiseSource:2};case 0:return{event:o,fullEventPromise:Qn(t.Id),promiseSource:0};case 2:var u=er(o,t.Id,t,a,e);return Object(r.__assign)({event:o},u);default:return Object(Jn.a)(n.loadState)}}(n=n||v.folderId,t,v,i,f);else{var p=f(t);if(p&&l)d=$n(n=n||p.ParentFolderId.Id,p);else{if(!p&&l)return null;var _=er(p,t.Id,t,i,n||(null===(c=null===(o=p)||void 0===o?void 0:o.ParentFolderId)||void 0===c?void 0:c.Id)||null);d=Object(r.__assign)({event:p},_)}}if(d){var b=l||d.event&&Object(xe.H)(d.event.CalendarItemType)?d.event.InstanceKey:t.Id;n=n||(null===(s=null===(u=d.event)||void 0===u?void 0:u.ParentFolderId)||void 0===s?void 0:s.Id)||null,d=Object(r.__assign)(Object(r.__assign)({},d),{fullEventPromise:tr(d.fullEventPromise,d.promiseSource,d.event,e,n,b,i)})}return d}function $n(e,t){var n=t.InstanceKey,a=ln(n);if(a&&1===a.loadState){var i=Ne(n,e);return{event:i,fullEventPromise:Promise.resolve(i),promiseSource:2}}return a&&0===a.loadState?{event:Ne(n,e)||t,fullEventPromise:Qn(n),promiseSource:0}:{event:Object(r.__assign)({},t),fullEventPromise:nr(n,t.ItemId,3,t.ParentFolderId.Id,t.SeriesMasterItemId),promiseSource:0}}function er(e,t,n,r,a){var i;return e&&e.EffectiveRights&&!Object(xe.u)(e)?{fullEventPromise:Promise.resolve(e),promiseSource:1}:{fullEventPromise:nr(t,n,r,a,null===(i=e)||void 0===i?void 0:i.SeriesMasterItemId),promiseSource:0}}function tr(e,t,n,a,i,o,c){return Object(r.__awaiter)(this,void 0,void 0,function(){var u,s,d,l,f,v;return Object(r.__generator)(this,function(r){switch(r.label){case 0:u=fn(a,o),r.label=1;case 1:return r.trys.push([1,5,,6]),S.d.info("[fetchFullCalendarEvent] Handling loading full calendar event Key: "+o+", Lock: "+a),!i||u&&1===u.loadState||(S.d.info("[fetchFullCalendarEvent] Loading full calendar event Key: "+o+", Lock: "+a),V(a,i,o,n)),2!=t?[3,2]:(s=n,[3,4]);case 2:return[4,e];case 3:s=r.sent(),r.label=4;case 4:if(!s)throw new Error("[fetchFullCalendarEvent] Unable to fetch full calendar event for event Key: "+o);return d=i||s.ParentFolderId.Id,v=u,u=fn(a,o),!d||u&&1===u.loadState?(S.d.info('[fetchFullCalendarEvent] Full calendar event already loaded. EventKey: "'+o+'", Lock: "'+a+'", FolderId: "'+d+'"'),se(a,o)):(S.d.info('[fetchFullCalendarEvent] Loaded full calendar event Key: "'+o+'", Lock: "'+a+'", FolderId: "'+d+'"'),Object(De.m)("FullCalendarEventLoaded",{eventKey:o,lockId:a,prevFullItemLoadState:v?v.loadState:null,fullItemLoadState:u?u.loadState:null,isFullItem:void 0!==s.RequiredAttendees,isSameAsExistingEvent:n===s}),z(a,d,o,s,c,0===t)),(l=Ne(o,i))&&me(l),[2,l];case 5:throw f=r.sent(),S.d.warn("[fetchFullCalendarEvent] Received error when fetching for "+o+" with error "+f),v=u,u=fn(a,o),Object(De.m)("FullCalendarEventLoaded",{eventKey:o,lockId:a,prevFullItemLoadState:v?v.loadState:null,fullItemLoadState:u?u.loadState:null,isFullItem:!1,isSameAsExistingEvent:!1}),i&&H(a,i,o),f;case 6:return[2]}})})}function nr(e,t,n,a,i){var o=this,c=Object(r.__awaiter)(o,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,,2,3]),[4,rr(bt,t,n,a,i)];case 1:return[2,r.sent()];case 2:return function(e){delete Yn[e]}(e),[7];case 3:return[2]}})});return function(e,t){Yn[e]=t}(e,c),c}function rr(e,t,n,a,i){return Object(r.__awaiter)(this,void 0,void 0,function(){var o,c,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:o=0,r.label=1;case 1:if(!(o<e))return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Vn(t,a,n,i)];case 3:return c=r.sent(),o++,c||o>=e?[2,c]:[3,5];case 4:if(u=r.sent(),S.d.warn('[fetchFullCalendarEvent] Received error when trying to load calendar event from server for "'+t.Id+'" with try '+o+": Error "+u.toString()),++o>=e)throw u;return[3,5];case 5:return[3,1];case 6:return[2,null]}})})}function ar(e){if(!e)throw new Error("The lock id should be provided");return{fetchCalendarEventsForDateRange:function(t,n){return gt(e,t,n)},subscribeNotifications:function(t){return Ut(t,e)},fetchFullCalendarEvent:function(t,n,r,a){return Xn(e,t,n,r,a)},getLockId:function(){return e},release:function(){return ae(e)}}}function ir(){return ar(function(){var e="events_cache_lock_"+x;return x++,e}())}function or(e){return{getCalendarEventsForDateRange:function(t,n){return Qe(e,t,n)},getFullCalendarEvent:function(t,n){return Pe(t,n,e)}}}n.d(t,"j",function(){return Fe}),n.d(t,"c",function(){return be}),n.d(t,"b",function(){return Ie}),n.d(t,"a",function(){return me}),n.d(t,"d",function(){return ye}),n.d(t,"f",function(){return ge}),n.d(t,"v",function(){return he}),n.d(t,"r",function(){return je}),n.d(t,"t",function(){return Ee}),n.d(t,"s",function(){return Re}),n.d(t,"w",function(){return Jt}),n.d(t,"x",function(){return Zt}),n.d(t,"h",function(){return zn}),n.d(t,"l",function(){return Wn}),n.d(t,"o",function(){return Cn}),n.d(t,"k",function(){return B}),n.d(t,"n",function(){return vn}),n.d(t,"m",function(){return Gn}),n.d(t,"i",function(){return Zn}),n.d(t,"g",function(){return We}),n.d(t,"u",function(){return Vn}),n.d(t,"e",function(){return ir}),n.d(t,"q",function(){return ar}),n.d(t,"p",function(){return or})},780:function(e,t,n){"use strict";var r=n(789);n(1051);function a(e){var t=[];return e&&"string"!=typeof e&&t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress}),t}var i=/\(([^)]*)\)/gi,o=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,c=/\s+/gi;function u(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(i,"")).replace(o,"")).replace(c," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!=n.length&&(t+=n[0].charAt(0).toUpperCase()),t}var s=n(1396),d=Object.keys(s.a).length/2;function l(e){if(!e)return null;for(var t=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),a=n%8;t^=(r<<a)+(r>>8-a)}return t%d}function f(e){return{personaId:e,displayName:e,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:u(e),textBoyColor:l(e),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:e}}var v=n(852),p=n(104);function _(e){var t;if(e){var n=function(e){return e?null!=e.HomeAddressesArray&&e.HomeAddressesArray.length>0?e.HomeAddressesArray[0].Value:null!=e.BusinessAddressesArray&&e.BusinessAddressesArray.length>0?e.BusinessAddressesArray[0].Value:null!=e.OtherAddressesArray&&e.OtherAddressesArray.length>0?e.OtherAddressesArray[0].Value:null:null}(e),r=Object(v.c)(e.DisplayName,n);return"Room"==e.PersonaTypeString&&(n.LocationUri=e.EmailAddress.EmailAddress),{personaId:null===(t=e.PersonaId)||void 0===t?void 0:t.Id,feedbackId:e.FeedbackId,displayName:r,postalAddress:n,emailAddress:e.EmailAddress,displayAddress:Object(v.a)(n),initials:u(r),textBoyColor:l(r),selectionSource:"LocationWell",personaType:Object(p.b)(e.PersonaTypeString)?"Unknown":e.PersonaTypeString,personaControlId:null==e.PersonaId?e.FeedbackId:e.PersonaId.Id,availability:e.Availability,numberOfAvailableTimeSlots:e.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:e.TotalNumberOfTimeSlots,isPartialAvailability:e.IsPartialAvailability,capacity:e.Capacity,entityType:e.EntityType,audioDeviceName:e.AudioDeviceName,displayDeviceName:e.DisplayDeviceName,videoDeviceName:e.VideoDeviceName,isWheelChairAccessible:e.IsWheelChairAccessible}}return null}var b=n(871);function I(e){var t;if((null===(t=e)||void 0===t?void 0:t.DisplayName)&&e.PostalAddress){var n=Object(v.c)(e.DisplayName,e.PostalAddress),r=Object(b.a)(e.PostalAddress)&&!Object(p.b)(e.PostalAddress.LocationUri)?{EmailAddress:e.PostalAddress.LocationUri}:null;return{personaId:e.Id,displayName:e.DisplayName,postalAddress:e.PostalAddress,emailAddress:r,displayAddress:Object(v.a)(e.PostalAddress),initials:u(n),textBoyColor:l(n),personaType:Object(b.a)(e.PostalAddress)?"Room":"Unknown",personaControlId:e.DisplayName}}return null}var m=n(0),y=n(1),O=n(5),g=n(40),h=n(112),j=n(121),E=290,R=135;function T(e,t,n,r,a,i){a=a||E,i=i||R;var o=Object(g.a)();if((!Object(p.b)(n)||e&&t)&&o.PolicySettings.PlacesEnabled){var c=Object(O.b)("/OWS/beta/Location/locationmap?Latitude={0}&Longitude={1}&Address={2}&Culture={3}&Width={4}&Height={5}",e&&e.toString(),t&&t.toString(),encodeURIComponent(n),o.SessionSettings.UserCulture,a,i);Object(h.b)(c,void 0,!0).then(function(e){Object(j.a)(e.status)?e.json().then(function(e){r("data:image/png;base64,"+e.ib)}):r("")})}else r("")}var A=n(103),C=n(14307),S=n(62),F=n(192),N=function(e){function t(t){var n=e.call(this,t)||this;return n.onCompleteDownload=function(e){n.setState({blobUrl:e}),e?n.requestStatus="success":(n.requestStatus="failed",S.d.warn("getLocationPhoto.downloadLocationPhoto failed"))},n.state={blobUrl:null},n}return Object(m.__extends)(t,e),t.prototype.componentDidMount=function(){this.fetchPersonaPhoto(this.props)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.fetchPersonaPhoto(e)},t.prototype.fetchPersonaPhoto=function(e){var t;(null===(t=e.locationPersona.postalAddress)||void 0===t?void 0:t.Latitude)&&e.locationPersona.postalAddress.Longitude&&!Object(p.b)(e.locationPersona.displayName)&&!this.state.blobUrl&&"pending"!=this.requestStatus&&"failed"!=this.requestStatus&&(this.requestStatus="pending",T(e.locationPersona.postalAddress.Latitude,e.locationPersona.postalAddress.Longitude,null,this.onCompleteDownload,64,64))},t.prototype.render=function(){var e=this.props,t=e.locationPersona,n=e.className,r=e.size,a=e.showPersonaDetails;if(t){var i={};return Object(p.b)(this.state.blobUrl)?F(i,{imageInitials:t.initials,initialsColor:t.textBoyColor}):F(i,{imageUrl:this.state.blobUrl,imageShouldFadeIn:!1}),y.createElement(C.a,Object(m.__assign)({className:n,presence:s.b.none,hidePersonaDetails:!a,size:r,text:t.displayName,secondaryText:t.displayAddress},i))}return null},t=Object(m.__decorate)([A.observer],t)}(y.Component),P="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}",k="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}";function D(e,t,n,r){return e&&t?Object(O.b)(P,e.toString(),t.toString(),n,r):n?Object(O.b)(k,n,r):null}var w=n(935),x=n(94),L=n(219);function M(e){var t,n,r=(null===(n=null===(t=e)||void 0===t?void 0:t.accessibleText)||void 0===n?void 0:n.msColorWhiteBackground)||Object(x.g)().themePrimary,a=e?e.calDarker:Object(x.g)().themeDarker;return Object(L.b)({color:r,cursor:"pointer",selectors:{"&:hover":{color:a},"&:focus":{color:a}}})}var U=n(52);function K(e,t){return{Id:t,DisplayName:e,PostalAddress:{LocationSource:"Resource",LocationUri:t,Type:"Business"}}}function q(e){return{EmailAddress:e.PostalAddress.LocationUri,Name:e.DisplayName}}function B(e){return{Id:e,DisplayName:e,PostalAddress:{Type:"Business",LocationSource:"None"}}}function V(e,t,n,r){return e?{PostalAddress:{LocationUri:n,LocationSource:r,Type:t,Street:e.streetAddress,City:e.addressLocality,State:e.addressRegion,Country:e.addressCountry,PostalCode:e.postalCode,PostOfficeBox:e.postOfficeBoxNumber,Longitude:e.longitude,Latitude:e.latitude}}:null}function H(e){return!Object(w.a)(e.PostalAddress)&&/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&//=]*)/i.test(e.DisplayName)}function z(e){return function(){var t=/^http*/i.test(e)?e:"//"+e;window.open(t,"_blank")}}n.d(t,"s",function(){return G}),n.d(t,"k",function(){return f}),n.d(t,"j",function(){return _}),n.d(t,"i",function(){return I}),n.d(t,"a",function(){return N}),n.d(t,"l",function(){return D}),n.d(t,"m",function(){return T}),n.d(t,"p",function(){return w.a}),n.d(t,"q",function(){return b.a}),n.d(t,"n",function(){return M}),n.d(t,"e",function(){return K}),n.d(t,"b",function(){return r.a}),n.d(t,"c",function(){return r.b}),n.d(t,"d",function(){return r.c}),n.d(t,"o",function(){return q}),n.d(t,"f",function(){return B}),n.d(t,"h",function(){return a}),n.d(t,"g",function(){return V}),n.d(t,"t",function(){return z}),n.d(t,"r",function(){return H});var W=new U.c(function(){return n.e(985).then(n.bind(null,14377))}),G=new U.b(W,function(e){return e.createTxpPostalAddressFromLocationPersona})},785:function(e,t,n){"use strict";var r;!function(e){e[e.EventReservation=0]="EventReservation",e[e.FlightReservation=1]="FlightReservation",e[e.FoodReservation=2]="FoodReservation",e[e.Invoice=3]="Invoice",e[e.LodgingReservation=4]="LodgingReservation",e[e.ParcelDelivery=5]="ParcelDelivery",e[e.RentalCarReservation=6]="RentalCarReservation",e[e.ServiceReservation=7]="ServiceReservation",e[e.UnsuccessfulFlightReservation=8]="UnsuccessfulFlightReservation",e[e.UnsuccessfulLodgingReservation=9]="UnsuccessfulLodgingReservation",e[e.UnsuccessfulRentalCarReservation=10]="UnsuccessfulRentalCarReservation"}(r||(r={})),t.a=r},787:function(e,t,n){"use strict";t.a={EventReservation:"EventReservation",FlightReservation:"FlightReservation",FoodReservation:"FoodEstablishmentReservation",Invoice:"Invoice",LodgingReservation:"LodgingReservation",ParcelDelivery:"ParcelDelivery",RentalCarReservation:"RentalCarReservation",ServiceReservation:"ServiceReservation",UnsuccessfulFlightReservation:"UnsuccessfulFlightReservation",UnsuccessfulLodgingReservation:"UnsuccessfulLodgingReservation",UnsuccessfulRentalCarReservation:"UnsuccessfulRentalCarReservation"}},789:function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return u});var r=n(871);function a(e,t){if(null==e&&null!=t||null!=e&&null==t)return!1;if(null==e&&null==t)return!0;if(0==e.length&&0==t.length)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;){if(!i(e[n],t[n]))return!1;n++}return!0}function i(e,t){return!(!e&&t||e&&!t)&&(e.Id===t.Id||Object(r.a)(e.PostalAddress)&&Object(r.a)(t.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.PostalAddress.LocationUri.toLowerCase())}function o(e,t){return e&&Object(r.a)(t.PostalAddress)?c(e,t.PostalAddress.LocationUri):u(e,t.Id)}function c(e,t){return e&&e.some(function(e){return Object(r.a)(e.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.toLowerCase()})}function u(e,t){return e&&e.some(function(e){return e.Id===t})}},826:function(e,t,n){"use strict";function r(e){var t,n;if(null===(n=null===(t=e)||void 0===t?void 0:t.ItemId)||void 0===n?void 0:n.Id){var r=e.ClientSeriesId;return r&&(e.IsRecurring?r==e.InstanceKey:r==e.ItemId.Id)}return!0}var a=n(0),i=n(745),o=n.n(i),c=n(319);function u(e){var t=Object(c.a)();e.forEach(function(e){var n=Object(c.a)();d(e,t,n),e.IsRecurring=!0,e.InstanceKey=e.InstanceKey?e.InstanceKey:t})}function s(e){var t=Object(c.a)();d(e,t,t)}function d(e,t,n){e.ItemId=Object(a.__assign)(Object(a.__assign)({},o()({Id:n})),{mailboxInfo:e.ParentFolderId.mailboxInfo}),e.ClientSeriesId||(e.ClientSeriesId=t),e.EffectiveRights={Read:!0,Modify:!0,Delete:!0,ViewPrivateItems:!0},e.IsOrganizer=!0}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return s})},852:function(e,t,n){"use strict";var r=n(40),a=n(104),i="en-us",o={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","sw-ke":"a_c_pc_pr_ctry","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};var c=", ";function u(e,t,n,r,i,o){var c=[];Object(a.b)(e)||(c[c.length]=e);var u="";return Object(a.b)(t)||(u=t),Object(a.b)(n)||(u=Object(a.b)(u)?n:u+o+n),Object(a.b)(r)||(u=Object(a.b)(u)?r:u+o+r),Object(a.b)(u)||(c[c.length]=u),Object(a.b)(i)||(c[c.length]=i),c}function s(e,t,n,s,d){var l=function(){var e,t=Object(r.a)(),n="";(null===(e=t)||void 0===e?void 0:e.SessionSettings)&&!Object(a.b)(t.SessionSettings.UserCulture)&&(n=t.SessionSettings.UserCulture.toLowerCase());var c=o[n];return null==c&&(c=o[i]),c}(),f=[],v=c;switch(l){case"a_c_pc_pr_ctry":f=u(e,t,n,s,d,v);break;case"a_c_pr_ctry_pc":f=u(e,t,s,d,n,v);break;case"a_c_pr_pc_ctry":f=u(e,t,s,n,d,v);break;case"a_ctry_c_pr_pc":f=u(e,d,t,s,n,v);break;case"a_pc_c_pr_ctry":f=u(e,n,t,s,d,v);break;case"a_pc_pr_c_ctry":f=u(e,n,s,t,d,v);break;case"c_a_pc_pr_ctry":f=u(t,e,n,s,d,v);break;case"ctry_pc_pr_c_a":f=u(d,n,s,t,e,v);break;case"ctry_pr_c_pc_a":f=u(d,s,t,n,e,v);break;case"pc_ctry_pr_c_a":f=u(n,d,s,t,e,v);break;case"pc_pr_c_a_ctry":f=u(n,s,t,e,d,v)}return f.join(v)}function d(e){return e?s(e.Street,e.City,e.PostalCode,e.State,e.Country):""}function l(e,t){return Object(a.b)(e)?d(t):e}var f=n(5);function v(e,t,n){var r=d(t);return Object(a.b)(e)?r:""==r||n?e:Object(f.b)("{0} ({1})",e,r)}n.d(t,"a",function(){return d}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return v})},855:function(e,t,n){"use strict";var r=n(0),a=n(131),i=n(7),o=n(98),c=n(65),u=n(120),s=n(1653),d=n(1283);var l=n(1319),f=255,v=175,p="_____";function _(e){if(!e)return null;if(Object(c.f)("cal-mf-removeTeamsBlobFromPeekPreview")){var t=e.indexOf(p);-1!=t&&(e=e.substring(0,t))}var n=Object(c.f)("cal-mf-joinButton")?v:f;if((e=e.trim()).length<n)return e;var r=e.substr(0,n).trim();return r.length>0?r.concat("..."):null}n.d(t,"a",function(){return I}),n.d(t,"b",function(){return y});var b=Object(l.a)();function I(e,t){return t=t||Object(a.e)(),Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},b),e),{ItemId:e.ItemId?Object(r.__assign)(Object(r.__assign)({},e.ItemId),{mailboxInfo:t}):e.ItemId,ParentFolderId:e.ParentFolderId?Object(r.__assign)(Object(r.__assign)({},e.ParentFolderId),{mailboxInfo:t}):e.ParentFolderId,Start:m(e.Start),End:m(e.End),StartTimeZoneId:Object(o.b)(e.StartTimeZoneId),EndTimeZoneId:Object(o.b)(e.EndTimeZoneId),LastModifiedTime:m(e.LastModifiedTime),FreeBusyType:e.FreeBusyType,ResponseType:e.ResponseType,AppointmentReplyTime:m(e.AppointmentReplyTime),ExperienceType:e.ExperienceType?e.ExperienceType:"Unspecified",TxpObject:e.TailoredXpEntities?(n=e.TailoredXpEntities,i=e.EntityNamesMap,c=Object(d.a)(i),Object(s.a)(n,c)):void 0,SeriesMasterItemId:e.SeriesMasterItemId?Object(r.__assign)(Object(r.__assign)({},e.SeriesMasterItemId),{mailboxInfo:t}):null,Sensitivity:t.type==a.a.GroupMailbox&&"Private"==e.Sensitivity?"Normal":e.Sensitivity,Preview:_(e.Preview)});var n,i,c}function m(e){if(e){if(Object(c.f)("cal-assumeTzOffsetFromCalendarItem")){var t=Object(u.getConfig)().timezone,n=!!t;return Object(i.Qb)(t,e,n)}return Object(i.pb)(e)}}function y(e){return Object(r.__assign)(Object(r.__assign)({__type:"CalendarItem:#Exchange"},e),{Start:e.Start&&Object(i.qb)(e.Start),End:e.End&&Object(i.qb)(e.End),LastModifiedTime:e.LastModifiedTime&&Object(i.qb)(e.LastModifiedTime),AppointmentReplyTime:e.AppointmentReplyTime&&Object(i.qb)(e.AppointmentReplyTime),FreeBusyType:e.FreeBusyType,CharmId:e.CharmId,IsDraft:e.IsDraft,IsRoomRequested:e.IsRoomRequested,SkypeTeamsProperties:e.SkypeTeamsProperties&&JSON.stringify(e.SkypeTeamsProperties)})}},871:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(935);function a(e){return Object(r.a)(e)&&"Resource"===e.LocationSource}},935:function(e,t,n){"use strict";function r(e){return!!e&&(!!e.LocationUri||!(!e.Latitude||!e.Longitude))}n.d(t,"a",function(){return r})},949:function(e,t,n){"use strict";n.d(t,"y",function(){return r}),n.d(t,"n",function(){return a}),n.d(t,"A",function(){return i}),n.d(t,"B",function(){return o}),n.d(t,"z",function(){return c}),n.d(t,"m",function(){return u}),n.d(t,"x",function(){return s}),n.d(t,"g",function(){return d}),n.d(t,"o",function(){return l}),n.d(t,"q",function(){return f}),n.d(t,"e",function(){return v}),n.d(t,"C",function(){return p}),n.d(t,"t",function(){return _}),n.d(t,"a",function(){return b}),n.d(t,"v",function(){return I}),n.d(t,"c",function(){return m}),n.d(t,"h",function(){return y}),n.d(t,"f",function(){return O}),n.d(t,"D",function(){return g}),n.d(t,"u",function(){return h}),n.d(t,"b",function(){return j}),n.d(t,"w",function(){return E}),n.d(t,"d",function(){return R}),n.d(t,"p",function(){return T}),n.d(t,"r",function(){return A}),n.d(t,"l",function(){return C}),n.d(t,"i",function(){return S}),n.d(t,"j",function(){return F}),n.d(t,"k",function(){return N}),n.d(t,"s",function(){return P});var r="Sunday",a="Monday",i="Tuesday",o="Wednesday",c="Thursday",u="Friday",s="Saturday",d=[r,a,i,o,c,u,s],l=["January","February","March","April","May","June","July","August","September","October","November","December"],f="None",v="DailyRecurrence",p="WeeklyRecurrence",_="RelativeMonthlyRecurrence",b="AbsoluteMonthlyRecurrence",I="RelativeYearlyRecurrence",m="AbsoluteYearlyRecurrence",y=["None","First","Second","Third","Fourth","Last"],O="DailyRecurrence:#Exchange",g="WeeklyRecurrence:#Exchange",h="RelativeMonthlyRecurrence:#Exchange",j="AbsoluteMonthlyRecurrence:#Exchange",E="RelativeYearlyRecurrence:#Exchange",R="AbsoluteYearlyRecurrence:#Exchange",T="NoEndRecurrence:#Exchange",A="NumberedRecurrence:#Exchange",C="EndDateRecurrence:#Exchange",S=3,F=25,N=1,P=[1,2,3,4,5,6,7,8,9,10]}}]);
//# sourceMappingURL=owa.58.js.map
self.scriptsLoaded['owa.58.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.58.js'] = (new Date()).getTime();